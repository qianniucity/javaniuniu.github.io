<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.1.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="en" /><updated>2020-06-21T18:50:42+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">JAVA ç‰›ç‰›</title><subtitle>ä¸»è¦æ˜¯æƒ³çœ‹ä¸‹è‡ªå·±è¿˜èƒ½åœ¨å¤šåšäº›ä»€ä¹ˆ
</subtitle><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><entry><title type="html">Spring ä¸­çš„bean æ˜¯çº¿ç¨‹å®‰å…¨çš„å—</title><link href="http://localhost:4000/spring/thread/security" rel="alternate" type="text/html" title="Spring ä¸­çš„bean æ˜¯çº¿ç¨‹å®‰å…¨çš„å—" /><published>2020-06-21T00:00:00+08:00</published><updated>2020-06-21T00:00:00+08:00</updated><id>http://localhost:4000/spring/thread/Spring%20%E4%B8%AD%E7%9A%84bean%20%E6%98%AF%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%E5%90%97</id><content type="html" xml:base="http://localhost:4000/spring/thread/security">&lt;h3 id=&quot;ç»“è®º-ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„&quot;&gt;&lt;strong&gt;ç»“è®ºï¼š ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„&lt;/strong&gt;&lt;/h3&gt;
&lt;h3 id=&quot;æ¦‚è¦&quot;&gt;æ¦‚è¦&lt;/h3&gt;
&lt;p&gt;Springå®¹å™¨ä¸­çš„Beanæ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Œå®¹å™¨æœ¬èº«å¹¶æ²¡æœ‰æä¾›Beançš„çº¿ç¨‹å®‰å…¨ç­–ç•¥ï¼Œå› æ­¤å¯ä»¥è¯´ &lt;strong&gt;Springå®¹å™¨ä¸­çš„Beanæœ¬èº«ä¸å…·å¤‡çº¿ç¨‹å®‰å…¨çš„ç‰¹æ€§ï¼Œä½†æ˜¯å…·ä½“è¿˜æ˜¯è¦ç»“åˆå…·ä½“scopeçš„Beanå»ç ”ç©¶&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h5 id=&quot;spring-çš„-bean-ä½œç”¨åŸŸscopeç±»å‹&quot;&gt;Spring çš„ bean ä½œç”¨åŸŸï¼ˆscopeï¼‰ç±»å‹&lt;/h5&gt;
&lt;ol&gt;
  &lt;li&gt;singleton:å•ä¾‹ï¼Œé»˜è®¤ä½œç”¨åŸŸã€‚&lt;/li&gt;
  &lt;li&gt;prototype:åŸå‹ï¼Œæ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚&lt;/li&gt;
  &lt;li&gt;request:è¯·æ±‚ï¼Œæ¯æ¬¡Httpè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œé€‚ç”¨äºWebApplicationContextç¯å¢ƒä¸‹ã€‚&lt;/li&gt;
  &lt;li&gt;session:ä¼šè¯ï¼ŒåŒä¸€ä¸ªä¼šè¯å…±äº«ä¸€ä¸ªå®ä¾‹ï¼Œä¸åŒä¼šè¯ä½¿ç”¨ä¸ç”¨çš„å®ä¾‹ã€‚&lt;/li&gt;
  &lt;li&gt;global-session:å…¨å±€ä¼šè¯ï¼Œæ‰€æœ‰ä¼šè¯å…±äº«ä¸€ä¸ªå®ä¾‹ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;çº¿ç¨‹å®‰å…¨è¿™ä¸ªé—®é¢˜ï¼Œè¦ä»å•ä¾‹ä¸åŸå‹Beanåˆ†åˆ«è¿›è¡Œè¯´æ˜ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id=&quot;åŸå‹bean&quot;&gt;åŸå‹Bean&lt;/h4&gt;
&lt;p&gt;å¯¹äºåŸå‹Bean,æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ä¹‹é—´å¹¶ä¸å­˜åœ¨Beanå…±äº«ï¼Œè‡ªç„¶æ˜¯ä¸ä¼šæœ‰çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;h4 id=&quot;å•ä¾‹bean&quot;&gt;å•ä¾‹Bean&lt;/h4&gt;
&lt;p&gt;å¯¹äºå•ä¾‹Bean,æ‰€æœ‰çº¿ç¨‹éƒ½å…±äº«ä¸€ä¸ªå•ä¾‹å®ä¾‹Bean,å› æ­¤æ˜¯å­˜åœ¨èµ„æºçš„ç«äº‰ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœå•ä¾‹Bean,æ˜¯ä¸€ä¸ª &lt;strong&gt;æ— çŠ¶æ€Bean&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ä¸­çš„æ“ä½œä¸ä¼šå¯¹Beançš„æˆå‘˜æ‰§è¡Œ &lt;strong&gt;æŸ¥è¯¢&lt;/strong&gt; ä»¥å¤–çš„æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªå•ä¾‹Beanæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ¯”å¦‚Spring mvc çš„ Controllerã€Serviceã€Daoç­‰ï¼Œè¿™äº›Beanå¤§å¤šæ˜¯æ— çŠ¶æ€çš„ï¼Œåªå…³æ³¨äºæ–¹æ³•æœ¬èº«ã€‚&lt;/p&gt;

&lt;h3 id=&quot;springå•ä¾‹ä¸ºä»€ä¹ˆcontrollerserviceå’Œdaoç¡®èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨&quot;&gt;springå•ä¾‹ï¼Œä¸ºä»€ä¹ˆcontrollerã€serviceå’Œdaoç¡®èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Springä¸­çš„Beané»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼çš„ï¼Œæ¡†æ¶å¹¶æ²¡æœ‰å¯¹beanè¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚&lt;/li&gt;
  &lt;li&gt;å®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶é—´Beanæ˜¯æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚Daoï¼‰ æ‰€ä»¥è¯´åœ¨æŸç§ç¨‹åº¦ä¸Šæ¥è¯´Beanå…¶å®æ˜¯å®‰å…¨çš„ã€‚&lt;/li&gt;
  &lt;li&gt;ä½†æ˜¯ &lt;em&gt;å¦‚æœBeanæ˜¯æœ‰çŠ¶æ€çš„ é‚£å°±éœ€è¦å¼€å‘äººå‘˜è‡ªå·±æ¥è¿›è¡Œçº¿ç¨‹å®‰å…¨çš„ä¿è¯&lt;/em&gt; ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯æ”¹å˜beançš„ä½œç”¨åŸŸ æŠŠ â€œsingletonâ€æ”¹ä¸ºâ€™â€˜protopyteâ€™ è¿™æ ·æ¯æ¬¡è¯·æ±‚Beanå°±ç›¸å½“äºæ˜¯ new Bean() è¿™æ ·å°±å¯ä»¥ä¿è¯çº¿ç¨‹çš„å®‰å…¨äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;æœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½&lt;/strong&gt;&lt;br /&gt;
&lt;strong&gt;æ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;controllerã€serviceå’Œdaoå±‚æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªæ˜¯å¦‚æœåªæ˜¯è°ƒç”¨é‡Œé¢çš„æ–¹æ³•ï¼Œè€Œä¸”å¤šçº¿ç¨‹è°ƒç”¨ä¸€ä¸ªå®ä¾‹çš„æ–¹æ³•ï¼Œä¼šåœ¨å†…å­˜ä¸­å¤åˆ¶å˜é‡ï¼Œè¿™æ˜¯è‡ªå·±çš„çº¿ç¨‹çš„å·¥ä½œå†…å­˜ï¼Œæ˜¯å®‰å…¨çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æƒ³ç†è§£åŸç†å¯ä»¥çœ‹çœ‹ã€Šæ·±å…¥ç†è§£JVMè™šæ‹Ÿæœºã€‹ï¼Œ2.2.2èŠ‚ï¼š&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Javaè™šæ‹Ÿæœºæ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒã€‚è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ç¬¬3.2.2èŠ‚ï¼š&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å±€éƒ¨å˜é‡çš„å›ºæœ‰å±æ€§ä¹‹ä¸€å°±æ˜¯å°é—­åœ¨æ‰§è¡Œçº¿ç¨‹ä¸­ã€‚
å®ƒä»¬ä½äºæ‰§è¡Œçº¿ç¨‹çš„æ ˆä¸­ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®è¿™ä¸ªæ ˆã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;æ‰€ä»¥å…¶å®ä»»ä½•æ— çŠ¶æ€å•ä¾‹éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚&lt;/strong&gt; &lt;br /&gt;
Springçš„æ ¹æœ¬å°±æ˜¯é€šè¿‡å¤§é‡è¿™ç§å•ä¾‹æ„å»ºèµ·ç³»ç»Ÿï¼Œä»¥äº‹åŠ¡è„šæœ¬çš„æ–¹å¼æä¾›æœåŠ¡&lt;/p&gt;

&lt;h3 id=&quot;å…³äºspringçš„controller-serviceç­‰çš„çº¿ç¨‹å®‰å…¨é—®é¢˜&quot;&gt;å…³äºSpringçš„@Controller @Serviceç­‰çš„çº¿ç¨‹å®‰å…¨é—®é¢˜&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆé—®@Controller @Serviceæ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ&lt;/p&gt;

&lt;p&gt;ç­”ï¼šé»˜è®¤é…ç½®ä¸‹ä¸æ˜¯çš„ã€‚ä¸ºå•¥å‘¢ï¼Ÿå› ä¸ºé»˜è®¤æƒ…å†µä¸‹@Controlleræ²¡æœ‰åŠ ä¸Š@Scopeï¼Œæ²¡æœ‰åŠ @Scopeå°±æ˜¯é»˜è®¤å€¼singletonï¼Œå•ä¾‹çš„ã€‚æ„æ€å°±æ˜¯ç³»ç»Ÿåªä¼šåˆå§‹åŒ–ä¸€æ¬¡Controllerå®¹å™¨ï¼Œæ‰€ä»¥æ¯æ¬¡è¯·æ±‚çš„éƒ½æ˜¯åŒä¸€ä¸ªControllerå®¹å™¨ï¼Œå½“ç„¶æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ä¸¾ä¸ªæ —å­ï¼š&lt;/p&gt;

&lt;h4 id=&quot;é»˜è®¤å•ä¾‹æ¨¡å¼-çº¿ç¨‹ä¸å®‰å…¨&quot;&gt;é»˜è®¤å•ä¾‹æ¨¡å¼ (çº¿ç¨‹ä¸å®‰å…¨)&lt;/h4&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/test_var&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;åœ¨postmané‡Œé¢å‘ä¸‰æ¬¡è¯·æ±‚ï¼Œç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;æ™®é€šå˜é‡var:1
æ™®é€šå˜é‡var:2
æ™®é€šå˜é‡var:3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;è¯´æ˜ä»–ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿå¯ä»¥ç»™ä»–åŠ ä¸Šä¸Šé¢è¯´çš„@Scopeæ³¨è§£ï¼Œå¦‚ä¸‹ï¼šã€€ã€€&lt;/p&gt;

&lt;h4 id=&quot;ä½¿ç”¨scopeæ³¨è§£-ä½¿ç”¨å¤šä¾‹æ¨¡å¼çº¿ç¨‹å®‰å…¨&quot;&gt;ä½¿ç”¨@Scopeæ³¨è§£ ä½¿ç”¨å¤šä¾‹æ¨¡å¼ï¼Œ(çº¿ç¨‹å®‰å…¨)&lt;/h4&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Scope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;prototype&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// åŠ ä¸Š@Scopeæ³¨è§£ï¼Œä»–æœ‰2ä¸ªå–å€¼ï¼šå•ä¾‹-singleton å¤šå®ä¾‹-prototype&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/test_var&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½å•ç‹¬åˆ›å»ºä¸€ä¸ªControllerå®¹å™¨ï¼Œæ‰€ä»¥å„ä¸ªè¯·æ±‚ä¹‹é—´æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸‰æ¬¡è¯·æ±‚ç»“æœï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;æ™®é€šå˜é‡var:1
æ™®é€šå˜é‡var:1
æ™®é€šå˜é‡var:1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åŠ äº†@Scopeæ³¨è§£å¤šçš„å®ä¾‹prototypeæ˜¯ä¸æ˜¯ä¸€å®šå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„å‘¢ï¼Ÿã€€ã€€&lt;/p&gt;

&lt;h4 id=&quot;scopeæ³¨è§£ä¹Ÿä¸ä¸€å®šèƒ½ä¿è¯controller-100çš„çº¿ç¨‹å®‰å…¨æœ‰staticé™æ€å˜é‡&quot;&gt;Scopeæ³¨è§£ä¹Ÿä¸ä¸€å®šèƒ½ä¿è¯Controller 100%çš„çº¿ç¨‹å®‰å…¨(æœ‰staticé™æ€å˜é‡)&lt;/h4&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Scope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;prototype&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// åŠ ä¸Š@Scopeæ³¨è§£ï¼Œä»–æœ‰2ä¸ªå–å€¼ï¼šå•ä¾‹-singleton å¤šå®ä¾‹-prototype&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticVar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/test_var&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;---é™æ€å˜é‡staticVar:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;staticVar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;é™æ€å˜é‡staticVar:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticVar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;çœ‹ä¸‰æ¬¡è¯·æ±‚ç»“æœï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;æ™®é€šå˜é‡var:1---é™æ€å˜é‡staticVar:1
æ™®é€šå˜é‡var:1---é™æ€å˜é‡staticVar:2
æ™®é€šå˜é‡var:1---é™æ€å˜é‡staticVar:3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è™½ç„¶æ¯æ¬¡éƒ½æ˜¯å•ç‹¬åˆ›å»ºä¸€ä¸ªControllerä½†æ˜¯æ‰›ä¸ä½ä»–å˜é‡æœ¬èº«æ˜¯staticçš„å‘€ï¼Œæ‰€ä»¥è¯´å‘¢ï¼Œå³ä¾¿æ˜¯åŠ ä¸Š@Scopeæ³¨è§£ä¹Ÿä¸ä¸€å®šèƒ½ä¿è¯Controller 100%çš„çº¿ç¨‹å®‰å…¨ã€‚&lt;strong&gt;æ‰€ä»¥æ˜¯å¦çº¿ç¨‹å®‰å…¨åœ¨äºæ€æ ·å»å®šä¹‰å˜é‡ä»¥åŠControllerçš„é…ç½®&lt;/strong&gt;ã€‚æ‰€ä»¥æ¥ä¸ªå…¨ä¹ä¸€ç‚¹çš„å®éªŒï¼Œä»£ç å¦‚ä¸‹ï¼šã€€ã€€&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Scope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;singleton&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// prototype singleton&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// å®šä¹‰ä¸€ä¸ªæ™®é€šå˜é‡&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticVar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// å®šä¹‰ä¸€ä¸ªé™æ€å˜é‡&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;${test-int}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;testInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–å˜é‡&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ThreadLocal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ç”¨ThreadLocalæ¥å°è£…å˜é‡&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// æ³¨å…¥ä¸€ä¸ªå¯¹è±¡æ¥å°è£…å˜é‡&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/test_var&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAge&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;===å†å–ä¸€ä¸‹hashCode:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hashCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAge&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;===é™æ€å˜é‡staticVar:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;staticVar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;===é…ç½®å˜é‡testInt:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;===ThreadLocalå˜é‡tl:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;===æ³¨å…¥å˜é‡user:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAge&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æ™®é€šå˜é‡var:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;,é™æ€å˜é‡staticVar:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticVar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;,é…ç½®è¯»å–å˜é‡testInt:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;testInt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;,ThreadLocalå˜é‡tl:&quot;&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;æ³¨å…¥å˜é‡user:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAge&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¡¥å……Controllerä»¥å¤–çš„ä»£ç ï¼š
configé‡Œé¢è‡ªå·±å®šä¹‰çš„Bean:User&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyConfig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;æˆ‘æš‚æ—¶èƒ½æƒ³åˆ°çš„å®šä¹‰å˜é‡çš„æ–¹æ³•å°±è¿™ä¹ˆå¤šäº†ï¼Œä¸‰æ¬¡httpè¯·æ±‚ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:241165852
æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:1===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:241165852
æ™®é€šå˜é‡var:2===é™æ€å˜é‡staticVar:2===é…ç½®å˜é‡testInt:2===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:241165852
æ™®é€šå˜é‡var:3===é™æ€å˜é‡staticVar:3===é…ç½®å˜é‡testInt:3===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸‹Controllerä¸­åªæœ‰ç”¨ThreadLocalå°è£…çš„å˜é‡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸ºä»€ä¹ˆè¿™æ ·è¯´å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ°3æ¬¡è¯·æ±‚ç»“æœé‡Œé¢åªæœ‰ThreadLocalå˜é‡å€¼æ¯æ¬¡éƒ½æ˜¯ä»0+1=1çš„ï¼Œå…¶ä»–çš„å‡ ä¸ªéƒ½æ˜¯ç´¯åŠ çš„ï¼Œè€Œuserå¯¹è±¡å‘¢ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œç¬¬äºŒäº¤å–å€¼çš„æ—¶å€™å°±å·²ç»æ˜¯1äº†ï¼Œå…³é”®ä»–çš„hashCodeæ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜æ¯æ¬¡è¯·æ±‚è°ƒç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªuserå¯¹è±¡ã€‚
ä¸‹é¢å°†TestController ä¸Šçš„@Scopeæ³¨è§£çš„å±æ€§æ”¹ä¸€ä¸‹æ”¹æˆå¤šå®ä¾‹çš„ï¼š@Scope(value = â€œprototypeâ€)ï¼Œå…¶ä»–éƒ½ä¸å˜ï¼Œå†æ¬¡è¯·æ±‚ï¼Œç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:853315860
æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:1===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:853315860
æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:2===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:853315860
æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:3===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ†æè¿™ä¸ªç»“æœå‘ç°ï¼Œå¤šå®ä¾‹æ¨¡å¼ä¸‹æ™®é€šå˜é‡ï¼Œå–é…ç½®çš„å˜é‡è¿˜æœ‰ThreadLocalå˜é‡éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œé™æ€å˜é‡å’Œuserï¼ˆçœ‹ä»–çš„hashCodeéƒ½æ˜¯ä¸€æ ·çš„ï¼‰å¯¹è±¡ä¸­çš„å˜é‡éƒ½æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å°½ç®¡TestController æ˜¯æ¯æ¬¡è¯·æ±‚çš„æ—¶å€™éƒ½åˆå§‹åŒ–äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯é™æ€å˜é‡å§‹ç»ˆæ˜¯åªæœ‰ä¸€ä»½çš„ï¼Œè€Œä¸”è¿™ä¸ªæ³¨å…¥çš„userå¯¹è±¡ä¹Ÿæ˜¯åªæœ‰ä¸€ä»½çš„ã€‚é™æ€å˜é‡åªæœ‰ä¸€ä»½è¿™æ˜¯å½“ç„¶çš„å’¯ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è®©userå¯¹è±¡å¯ä»¥æ¯æ¬¡éƒ½newä¸€ä¸ªæ–°çš„å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyConfig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Scope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;prototype&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;    
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨configé‡Œé¢ç»™è¿™ä¸ªæ³¨å…¥çš„BeanåŠ ä¸Šä¸€ä¸ªç›¸åŒçš„æ³¨è§£@Scope(value = â€œprototypeâ€)å°±å¯ä»¥äº†ï¼Œå†æ¥è¯·æ±‚ä¸€ä¸‹çœ‹çœ‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:1612967699
æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:1===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:985418837
æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:2===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:1958952789
æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:3===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°æ¯æ¬¡è¯·æ±‚çš„userå¯¹è±¡çš„hashCodeéƒ½ä¸æ˜¯ä¸€æ ·çš„ï¼Œæ¯æ¬¡èµ‹å€¼å‰å–userä¸­çš„å˜é‡å€¼ä¹Ÿéƒ½æ˜¯é»˜è®¤å€¼0ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;åœ¨@Controller/@Serviceç­‰å®¹å™¨ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œscopeå€¼æ˜¯å•ä¾‹-singletonçš„ï¼Œä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚&lt;/li&gt;
  &lt;li&gt;å°½é‡ä¸è¦åœ¨@Controller/@Serviceç­‰å®¹å™¨ä¸­å®šä¹‰é™æ€å˜é‡ï¼Œä¸è®ºæ˜¯å•ä¾‹(singleton)è¿˜æ˜¯å¤šå®ä¾‹(prototype)ä»–éƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚&lt;/li&gt;
  &lt;li&gt;é»˜è®¤æ³¨å…¥çš„Beanå¯¹è±¡ï¼Œåœ¨ä¸è®¾ç½®scopeçš„æ—¶å€™ä»–ä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚&lt;/li&gt;
  &lt;li&gt;ä¸€å®šè¦å®šä¹‰å˜é‡çš„è¯ï¼Œç”¨ThreadLocalæ¥å°è£…ï¼Œè¿™ä¸ªæ˜¯çº¿ç¨‹å®‰å…¨çš„&lt;/li&gt;
&lt;/ol&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="spring" /><category term="ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ" /><summary type="html">ç»“è®ºï¼š ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ æ¦‚è¦ Springå®¹å™¨ä¸­çš„Beanæ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Œå®¹å™¨æœ¬èº«å¹¶æ²¡æœ‰æä¾›Beançš„çº¿ç¨‹å®‰å…¨ç­–ç•¥ï¼Œå› æ­¤å¯ä»¥è¯´ Springå®¹å™¨ä¸­çš„Beanæœ¬èº«ä¸å…·å¤‡çº¿ç¨‹å®‰å…¨çš„ç‰¹æ€§ï¼Œä½†æ˜¯å…·ä½“è¿˜æ˜¯è¦ç»“åˆå…·ä½“scopeçš„Beanå»ç ”ç©¶ã€‚ Spring çš„ bean ä½œç”¨åŸŸï¼ˆscopeï¼‰ç±»å‹ singleton:å•ä¾‹ï¼Œé»˜è®¤ä½œç”¨åŸŸã€‚ prototype:åŸå‹ï¼Œæ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚ request:è¯·æ±‚ï¼Œæ¯æ¬¡Httpè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œé€‚ç”¨äºWebApplicationContextç¯å¢ƒä¸‹ã€‚ session:ä¼šè¯ï¼ŒåŒä¸€ä¸ªä¼šè¯å…±äº«ä¸€ä¸ªå®ä¾‹ï¼Œä¸åŒä¼šè¯ä½¿ç”¨ä¸ç”¨çš„å®ä¾‹ã€‚ global-session:å…¨å±€ä¼šè¯ï¼Œæ‰€æœ‰ä¼šè¯å…±äº«ä¸€ä¸ªå®ä¾‹ã€‚ çº¿ç¨‹å®‰å…¨è¿™ä¸ªé—®é¢˜ï¼Œè¦ä»å•ä¾‹ä¸åŸå‹Beanåˆ†åˆ«è¿›è¡Œè¯´æ˜ã€‚ åŸå‹Bean å¯¹äºåŸå‹Bean,æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ä¹‹é—´å¹¶ä¸å­˜åœ¨Beanå…±äº«ï¼Œè‡ªç„¶æ˜¯ä¸ä¼šæœ‰çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ã€‚ å•ä¾‹Bean å¯¹äºå•ä¾‹Bean,æ‰€æœ‰çº¿ç¨‹éƒ½å…±äº«ä¸€ä¸ªå•ä¾‹å®ä¾‹Bean,å› æ­¤æ˜¯å­˜åœ¨èµ„æºçš„ç«äº‰ã€‚ å¦‚æœå•ä¾‹Bean,æ˜¯ä¸€ä¸ª æ— çŠ¶æ€Beanï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ä¸­çš„æ“ä½œä¸ä¼šå¯¹Beançš„æˆå‘˜æ‰§è¡Œ æŸ¥è¯¢ ä»¥å¤–çš„æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªå•ä¾‹Beanæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ¯”å¦‚Spring mvc çš„ Controllerã€Serviceã€Daoç­‰ï¼Œè¿™äº›Beanå¤§å¤šæ˜¯æ— çŠ¶æ€çš„ï¼Œåªå…³æ³¨äºæ–¹æ³•æœ¬èº«ã€‚ springå•ä¾‹ï¼Œä¸ºä»€ä¹ˆcontrollerã€serviceå’Œdaoç¡®èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿ Springä¸­çš„Beané»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼çš„ï¼Œæ¡†æ¶å¹¶æ²¡æœ‰å¯¹beanè¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚ å®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶é—´Beanæ˜¯æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚Daoï¼‰ æ‰€ä»¥è¯´åœ¨æŸç§ç¨‹åº¦ä¸Šæ¥è¯´Beanå…¶å®æ˜¯å®‰å…¨çš„ã€‚ ä½†æ˜¯ å¦‚æœBeanæ˜¯æœ‰çŠ¶æ€çš„ é‚£å°±éœ€è¦å¼€å‘äººå‘˜è‡ªå·±æ¥è¿›è¡Œçº¿ç¨‹å®‰å…¨çš„ä¿è¯ ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯æ”¹å˜beançš„ä½œç”¨åŸŸ æŠŠ â€œsingletonâ€æ”¹ä¸ºâ€™â€˜protopyteâ€™ è¿™æ ·æ¯æ¬¡è¯·æ±‚Beanå°±ç›¸å½“äºæ˜¯ new Bean() è¿™æ ·å°±å¯ä»¥ä¿è¯çº¿ç¨‹çš„å®‰å…¨äº†ã€‚ æœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½ æ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ® controllerã€serviceå’Œdaoå±‚æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªæ˜¯å¦‚æœåªæ˜¯è°ƒç”¨é‡Œé¢çš„æ–¹æ³•ï¼Œè€Œä¸”å¤šçº¿ç¨‹è°ƒç”¨ä¸€ä¸ªå®ä¾‹çš„æ–¹æ³•ï¼Œä¼šåœ¨å†…å­˜ä¸­å¤åˆ¶å˜é‡ï¼Œè¿™æ˜¯è‡ªå·±çš„çº¿ç¨‹çš„å·¥ä½œå†…å­˜ï¼Œæ˜¯å®‰å…¨çš„ã€‚ æƒ³ç†è§£åŸç†å¯ä»¥çœ‹çœ‹ã€Šæ·±å…¥ç†è§£JVMè™šæ‹Ÿæœºã€‹ï¼Œ2.2.2èŠ‚ï¼š Javaè™šæ‹Ÿæœºæ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒã€‚è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ç¬¬3.2.2èŠ‚ï¼š å±€éƒ¨å˜é‡çš„å›ºæœ‰å±æ€§ä¹‹ä¸€å°±æ˜¯å°é—­åœ¨æ‰§è¡Œçº¿ç¨‹ä¸­ã€‚ å®ƒä»¬ä½äºæ‰§è¡Œçº¿ç¨‹çš„æ ˆä¸­ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®è¿™ä¸ªæ ˆã€‚ æ‰€ä»¥å…¶å®ä»»ä½•æ— çŠ¶æ€å•ä¾‹éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ Springçš„æ ¹æœ¬å°±æ˜¯é€šè¿‡å¤§é‡è¿™ç§å•ä¾‹æ„å»ºèµ·ç³»ç»Ÿï¼Œä»¥äº‹åŠ¡è„šæœ¬çš„æ–¹å¼æä¾›æœåŠ¡ å…³äºSpringçš„@Controller @Serviceç­‰çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ é¦–å…ˆé—®@Controller @Serviceæ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ ç­”ï¼šé»˜è®¤é…ç½®ä¸‹ä¸æ˜¯çš„ã€‚ä¸ºå•¥å‘¢ï¼Ÿå› ä¸ºé»˜è®¤æƒ…å†µä¸‹@Controlleræ²¡æœ‰åŠ ä¸Š@Scopeï¼Œæ²¡æœ‰åŠ @Scopeå°±æ˜¯é»˜è®¤å€¼singletonï¼Œå•ä¾‹çš„ã€‚æ„æ€å°±æ˜¯ç³»ç»Ÿåªä¼šåˆå§‹åŒ–ä¸€æ¬¡Controllerå®¹å™¨ï¼Œæ‰€ä»¥æ¯æ¬¡è¯·æ±‚çš„éƒ½æ˜¯åŒä¸€ä¸ªControllerå®¹å™¨ï¼Œå½“ç„¶æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ä¸¾ä¸ªæ —å­ï¼š é»˜è®¤å•ä¾‹æ¨¡å¼ (çº¿ç¨‹ä¸å®‰å…¨) @RestController public class TestController { private int var = 0; @GetMapping(value = &quot;/test_var&quot;) public String test() { System.out.println(&quot;æ™®é€šå˜é‡var:&quot; + (++var)); return &quot;æ™®é€šå˜é‡var:&quot; + var ; } } åœ¨postmané‡Œé¢å‘ä¸‰æ¬¡è¯·æ±‚ï¼Œç»“æœå¦‚ä¸‹ï¼š æ™®é€šå˜é‡var:1 æ™®é€šå˜é‡var:2 æ™®é€šå˜é‡var:3 è¯´æ˜ä»–ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿå¯ä»¥ç»™ä»–åŠ ä¸Šä¸Šé¢è¯´çš„@Scopeæ³¨è§£ï¼Œå¦‚ä¸‹ï¼šã€€ã€€ ä½¿ç”¨@Scopeæ³¨è§£ ä½¿ç”¨å¤šä¾‹æ¨¡å¼ï¼Œ(çº¿ç¨‹å®‰å…¨) @RestController @Scope(value = &quot;prototype&quot;) // åŠ ä¸Š@Scopeæ³¨è§£ï¼Œä»–æœ‰2ä¸ªå–å€¼ï¼šå•ä¾‹-singleton å¤šå®ä¾‹-prototype public class TestController { private int var = 0; @GetMapping(value = &quot;/test_var&quot;) public String test() { System.out.println(&quot;æ™®é€šå˜é‡var:&quot; + (++var)); return &quot;æ™®é€šå˜é‡var:&quot; + var ; } } è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½å•ç‹¬åˆ›å»ºä¸€ä¸ªControllerå®¹å™¨ï¼Œæ‰€ä»¥å„ä¸ªè¯·æ±‚ä¹‹é—´æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸‰æ¬¡è¯·æ±‚ç»“æœï¼š æ™®é€šå˜é‡var:1 æ™®é€šå˜é‡var:1 æ™®é€šå˜é‡var:1 åŠ äº†@Scopeæ³¨è§£å¤šçš„å®ä¾‹prototypeæ˜¯ä¸æ˜¯ä¸€å®šå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„å‘¢ï¼Ÿã€€ã€€ Scopeæ³¨è§£ä¹Ÿä¸ä¸€å®šèƒ½ä¿è¯Controller 100%çš„çº¿ç¨‹å®‰å…¨(æœ‰staticé™æ€å˜é‡) @RestController @Scope(value = &quot;prototype&quot;) // åŠ ä¸Š@Scopeæ³¨è§£ï¼Œä»–æœ‰2ä¸ªå–å€¼ï¼šå•ä¾‹-singleton å¤šå®ä¾‹-prototype public class TestController { private int var = 0; private static int staticVar = 0; @GetMapping(value = &quot;/test_var&quot;) public String test() { System.out.println(&quot;æ™®é€šå˜é‡var:&quot; + (++var)+ &quot;---é™æ€å˜é‡staticVar:&quot; + (++staticVar)); return &quot;æ™®é€šå˜é‡var:&quot; + var + &quot;é™æ€å˜é‡staticVar:&quot; + staticVar; } } çœ‹ä¸‰æ¬¡è¯·æ±‚ç»“æœï¼š æ™®é€šå˜é‡var:1---é™æ€å˜é‡staticVar:1 æ™®é€šå˜é‡var:1---é™æ€å˜é‡staticVar:2 æ™®é€šå˜é‡var:1---é™æ€å˜é‡staticVar:3 è™½ç„¶æ¯æ¬¡éƒ½æ˜¯å•ç‹¬åˆ›å»ºä¸€ä¸ªControllerä½†æ˜¯æ‰›ä¸ä½ä»–å˜é‡æœ¬èº«æ˜¯staticçš„å‘€ï¼Œæ‰€ä»¥è¯´å‘¢ï¼Œå³ä¾¿æ˜¯åŠ ä¸Š@Scopeæ³¨è§£ä¹Ÿä¸ä¸€å®šèƒ½ä¿è¯Controller 100%çš„çº¿ç¨‹å®‰å…¨ã€‚æ‰€ä»¥æ˜¯å¦çº¿ç¨‹å®‰å…¨åœ¨äºæ€æ ·å»å®šä¹‰å˜é‡ä»¥åŠControllerçš„é…ç½®ã€‚æ‰€ä»¥æ¥ä¸ªå…¨ä¹ä¸€ç‚¹çš„å®éªŒï¼Œä»£ç å¦‚ä¸‹ï¼šã€€ã€€ @RestController @Scope(value = &quot;singleton&quot;) // prototype singleton public class TestController { private int var = 0; // å®šä¹‰ä¸€ä¸ªæ™®é€šå˜é‡ private static int staticVar = 0; // å®šä¹‰ä¸€ä¸ªé™æ€å˜é‡ @Value(&quot;${test-int}&quot;) private int testInt; // ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–å˜é‡ ThreadLocal&amp;lt;Integer&amp;gt; tl = new ThreadLocal&amp;lt;&amp;gt;(); // ç”¨ThreadLocalæ¥å°è£…å˜é‡ @Autowired private User user; // æ³¨å…¥ä¸€ä¸ªå¯¹è±¡æ¥å°è£…å˜é‡ @GetMapping(value = &quot;/test_var&quot;) public String test() { tl.set(1); System.out.println(&quot;å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š&quot;+user.getAge()+&quot;===å†å–ä¸€ä¸‹hashCode:&quot;+user.hashCode()); user.setAge(1); System.out.println(&quot;æ™®é€šå˜é‡var:&quot; + (++var) + &quot;===é™æ€å˜é‡staticVar:&quot; + (++staticVar) + &quot;===é…ç½®å˜é‡testInt:&quot; + (++testInt) + &quot;===ThreadLocalå˜é‡tl:&quot; + tl.get()+&quot;===æ³¨å…¥å˜é‡user:&quot; + user.getAge()); return &quot;æ™®é€šå˜é‡var:&quot; + var + &quot;,é™æ€å˜é‡staticVar:&quot; + staticVar + &quot;,é…ç½®è¯»å–å˜é‡testInt:&quot; + testInt + &quot;,ThreadLocalå˜é‡tl:&quot; + tl.get() + &quot;æ³¨å…¥å˜é‡user:&quot; + user.getAge(); } } è¡¥å……Controllerä»¥å¤–çš„ä»£ç ï¼š configé‡Œé¢è‡ªå·±å®šä¹‰çš„Bean:User @Configuration public class MyConfig { @Bean public User user(){ return new User(); } } æˆ‘æš‚æ—¶èƒ½æƒ³åˆ°çš„å®šä¹‰å˜é‡çš„æ–¹æ³•å°±è¿™ä¹ˆå¤šäº†ï¼Œä¸‰æ¬¡httpè¯·æ±‚ç»“æœå¦‚ä¸‹ï¼š å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:241165852 æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:1===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:241165852 æ™®é€šå˜é‡var:2===é™æ€å˜é‡staticVar:2===é…ç½®å˜é‡testInt:2===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:241165852 æ™®é€šå˜é‡var:3===é™æ€å˜é‡staticVar:3===é…ç½®å˜é‡testInt:3===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸‹Controllerä¸­åªæœ‰ç”¨ThreadLocalå°è£…çš„å˜é‡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸ºä»€ä¹ˆè¿™æ ·è¯´å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ°3æ¬¡è¯·æ±‚ç»“æœé‡Œé¢åªæœ‰ThreadLocalå˜é‡å€¼æ¯æ¬¡éƒ½æ˜¯ä»0+1=1çš„ï¼Œå…¶ä»–çš„å‡ ä¸ªéƒ½æ˜¯ç´¯åŠ çš„ï¼Œè€Œuserå¯¹è±¡å‘¢ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œç¬¬äºŒäº¤å–å€¼çš„æ—¶å€™å°±å·²ç»æ˜¯1äº†ï¼Œå…³é”®ä»–çš„hashCodeæ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜æ¯æ¬¡è¯·æ±‚è°ƒç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªuserå¯¹è±¡ã€‚ ä¸‹é¢å°†TestController ä¸Šçš„@Scopeæ³¨è§£çš„å±æ€§æ”¹ä¸€ä¸‹æ”¹æˆå¤šå®ä¾‹çš„ï¼š@Scope(value = â€œprototypeâ€)ï¼Œå…¶ä»–éƒ½ä¸å˜ï¼Œå†æ¬¡è¯·æ±‚ï¼Œç»“æœå¦‚ä¸‹ï¼š å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:853315860 æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:1===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:853315860 æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:2===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š1===å†å–ä¸€ä¸‹hashCode:853315860 æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:3===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 åˆ†æè¿™ä¸ªç»“æœå‘ç°ï¼Œå¤šå®ä¾‹æ¨¡å¼ä¸‹æ™®é€šå˜é‡ï¼Œå–é…ç½®çš„å˜é‡è¿˜æœ‰ThreadLocalå˜é‡éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œé™æ€å˜é‡å’Œuserï¼ˆçœ‹ä»–çš„hashCodeéƒ½æ˜¯ä¸€æ ·çš„ï¼‰å¯¹è±¡ä¸­çš„å˜é‡éƒ½æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å°½ç®¡TestController æ˜¯æ¯æ¬¡è¯·æ±‚çš„æ—¶å€™éƒ½åˆå§‹åŒ–äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯é™æ€å˜é‡å§‹ç»ˆæ˜¯åªæœ‰ä¸€ä»½çš„ï¼Œè€Œä¸”è¿™ä¸ªæ³¨å…¥çš„userå¯¹è±¡ä¹Ÿæ˜¯åªæœ‰ä¸€ä»½çš„ã€‚é™æ€å˜é‡åªæœ‰ä¸€ä»½è¿™æ˜¯å½“ç„¶çš„å’¯ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è®©userå¯¹è±¡å¯ä»¥æ¯æ¬¡éƒ½newä¸€ä¸ªæ–°çš„å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ï¼š public class MyConfig { @Bean @Scope(value = &quot;prototype&quot;) public User user(){ return new User(); } } åœ¨configé‡Œé¢ç»™è¿™ä¸ªæ³¨å…¥çš„BeanåŠ ä¸Šä¸€ä¸ªç›¸åŒçš„æ³¨è§£@Scope(value = â€œprototypeâ€)å°±å¯ä»¥äº†ï¼Œå†æ¥è¯·æ±‚ä¸€ä¸‹çœ‹çœ‹ï¼š å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:1612967699 æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:1===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:985418837 æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:2===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å…ˆå–ä¸€ä¸‹userå¯¹è±¡ä¸­çš„å€¼ï¼š0===å†å–ä¸€ä¸‹hashCode:1958952789 æ™®é€šå˜é‡var:1===é™æ€å˜é‡staticVar:3===é…ç½®å˜é‡testInt:1===ThreadLocalå˜é‡tl:1===æ³¨å…¥å˜é‡user:1 å¯ä»¥çœ‹åˆ°æ¯æ¬¡è¯·æ±‚çš„userå¯¹è±¡çš„hashCodeéƒ½ä¸æ˜¯ä¸€æ ·çš„ï¼Œæ¯æ¬¡èµ‹å€¼å‰å–userä¸­çš„å˜é‡å€¼ä¹Ÿéƒ½æ˜¯é»˜è®¤å€¼0ã€‚ æ€»ç»“ åœ¨@Controller/@Serviceç­‰å®¹å™¨ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œscopeå€¼æ˜¯å•ä¾‹-singletonçš„ï¼Œä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ å°½é‡ä¸è¦åœ¨@Controller/@Serviceç­‰å®¹å™¨ä¸­å®šä¹‰é™æ€å˜é‡ï¼Œä¸è®ºæ˜¯å•ä¾‹(singleton)è¿˜æ˜¯å¤šå®ä¾‹(prototype)ä»–éƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ é»˜è®¤æ³¨å…¥çš„Beanå¯¹è±¡ï¼Œåœ¨ä¸è®¾ç½®scopeçš„æ—¶å€™ä»–ä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ ä¸€å®šè¦å®šä¹‰å˜é‡çš„è¯ï¼Œç”¨ThreadLocalæ¥å°è£…ï¼Œè¿™ä¸ªæ˜¯çº¿ç¨‹å®‰å…¨çš„</summary></entry><entry><title type="html">Mysql åˆ†åŒºè¡¨-åˆ†åŒºæ“ä½œ</title><link href="http://localhost:4000/mysql/partition" rel="alternate" type="text/html" title="Mysql åˆ†åŒºè¡¨-åˆ†åŒºæ“ä½œ" /><published>2020-06-20T00:00:00+08:00</published><updated>2020-06-20T00:00:00+08:00</updated><id>http://localhost:4000/mysql/Mysql%20%E5%88%86%E5%8C%BA%E8%A1%A8-%E5%88%86%E5%8C%BA%E6%93%8D%E4%BD%9C</id><content type="html" xml:base="http://localhost:4000/mysql/partition">&lt;h3 id=&quot;è§†é¢‘å‚è€ƒé“¾æ¥&quot;&gt;è§†é¢‘å‚è€ƒé“¾æ¥&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1E7411q7Nx?p=1&quot;&gt;MySQLåˆ†åŒº&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¸€æŸ¥çœ‹mysqlæ˜¯å¦æ”¯æŒåˆ†åŒº&quot;&gt;ä¸€ã€æŸ¥çœ‹MySQLæ˜¯å¦æ”¯æŒåˆ†åŒº&lt;/h3&gt;
&lt;h4 id=&quot;1mysql56ä»¥åŠä¹‹å‰ç‰ˆæœ¬&quot;&gt;1ã€MySQL5.6ä»¥åŠä¹‹å‰ç‰ˆæœ¬&lt;/h4&gt;

&lt;p&gt;show variables like â€˜%partition%â€™;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/mysql/0620/1530782-20181221101618516-1766491003.png&quot; alt=&quot;1&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;2mysql57&quot;&gt;2ã€MySQL5.7&lt;/h4&gt;

&lt;p&gt;show plugins;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/mysql/0620/1530782-20181221101735004-398510033.png&quot; alt=&quot;2&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;äºŒåˆ†åŒºè¡¨çš„åˆ†ç±»ä¸é™åˆ¶&quot;&gt;äºŒã€åˆ†åŒºè¡¨çš„åˆ†ç±»ä¸é™åˆ¶&lt;/h3&gt;
&lt;h4 id=&quot;1åˆ†åŒºè¡¨åˆ†ç±»&quot;&gt;1ã€åˆ†åŒºè¡¨åˆ†ç±»&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;RANGEåˆ†åŒº&lt;/strong&gt;ï¼šåŸºäºå±äºä¸€ä¸ªç»™å®šè¿ç»­åŒºé—´çš„åˆ—å€¼ï¼ŒæŠŠå¤šè¡Œåˆ†é…ç»™åˆ†åŒºã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;LISTåˆ†åŒº&lt;/strong&gt;ï¼šç±»ä¼¼äºæŒ‰RANGEåˆ†åŒºï¼ŒåŒºåˆ«åœ¨äºLISTåˆ†åŒºæ˜¯åŸºäºåˆ—å€¼åŒ¹é…ä¸€ä¸ªç¦»æ•£å€¼é›†åˆä¸­çš„æŸä¸ªå€¼æ¥è¿›è¡Œé€‰æ‹©ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HASHåˆ†åŒº&lt;/strong&gt;ï¼šåŸºäºç”¨æˆ·å®šä¹‰çš„è¡¨è¾¾å¼çš„è¿”å›å€¼æ¥è¿›è¡Œé€‰æ‹©çš„åˆ†åŒºï¼Œè¯¥è¡¨è¾¾å¼ä½¿ç”¨å°†è¦æ’å…¥åˆ°è¡¨ä¸­çš„è¿™äº›è¡Œçš„åˆ—å€¼è¿›è¡Œè®¡ç®—ã€‚è¿™ä¸ªå‡½æ•°å¯ä»¥åŒ…å«MySQL ä¸­æœ‰æ•ˆçš„ã€äº§ç”Ÿéè´Ÿæ•´æ•°å€¼çš„ä»»ä½•è¡¨è¾¾å¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;KEYåˆ†åŒº&lt;/strong&gt;ï¼šç±»ä¼¼äºæŒ‰HASHåˆ†åŒºï¼ŒåŒºåˆ«åœ¨äºKEYåˆ†åŒºåªæ”¯æŒè®¡ç®—ä¸€åˆ—æˆ–å¤šåˆ—ï¼Œä¸”MySQLæœåŠ¡å™¨æä¾›å…¶è‡ªèº«çš„å“ˆå¸Œå‡½æ•°ã€‚å¿…é¡»æœ‰ä¸€åˆ—æˆ–å¤šåˆ—åŒ…å«æ•´æ•°å€¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¤åˆåˆ†åŒº&lt;/strong&gt;ï¼šåœ¨MySQL 5.6ç‰ˆæœ¬ä¸­ï¼Œåªæ”¯æŒRANGEå’ŒLISTçš„å­åˆ†åŒºï¼Œä¸”å­åˆ†åŒºçš„ç±»å‹åªèƒ½ä¸ºHASHå’ŒKEYã€‚&lt;/p&gt;

&lt;h4 id=&quot;2åˆ†åŒºè¡¨é™åˆ¶&quot;&gt;2ã€åˆ†åŒºè¡¨é™åˆ¶&lt;/h4&gt;

&lt;p&gt;1ï¼‰åˆ†åŒºé”®å¿…é¡»åŒ…å«åœ¨è¡¨çš„æ‰€æœ‰ä¸»é”®ã€å”¯ä¸€é”®ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;2ï¼‰MYSQLåªèƒ½åœ¨ä½¿ç”¨åˆ†åŒºå‡½æ•°çš„åˆ—æœ¬èº«è¿›è¡Œæ¯”è¾ƒæ—¶æ‰èƒ½è¿‡æ»¤åˆ†åŒºï¼Œè€Œä¸èƒ½æ ¹æ®è¡¨è¾¾å¼çš„å€¼å»è¿‡æ»¤åˆ†åŒºï¼Œå³ä½¿è¿™ä¸ªè¡¨è¾¾å¼å°±æ˜¯åˆ†åŒºå‡½æ•°ä¹Ÿä¸è¡Œã€‚&lt;/p&gt;

&lt;p&gt;3ï¼‰æœ€å¤§åˆ†åŒºæ•°ï¼š ä¸ä½¿ç”¨NDBå­˜å‚¨å¼•æ“çš„ç»™å®šè¡¨çš„æœ€å¤§å¯èƒ½åˆ†åŒºæ•°ä¸º8192ï¼ˆåŒ…æ‹¬å­åˆ†åŒºï¼‰ã€‚å¦‚æœå½“åˆ†åŒºæ•°å¾ˆå¤§ï¼Œä½†æ˜¯æœªè¾¾åˆ°8192æ—¶æç¤º Got error â€¦ from storage engine: Out of resources when opening file,å¯ä»¥é€šè¿‡å¢åŠ open_files_limitç³»ç»Ÿå˜é‡çš„å€¼æ¥è§£å†³é—®é¢˜ï¼Œå½“ç„¶åŒæ—¶æ‰“å¼€æ–‡ä»¶çš„æ•°é‡ä¹Ÿå¯èƒ½ç”±æ“ä½œç³»ç»Ÿé™åˆ¶ã€‚&lt;/p&gt;

&lt;p&gt;4ï¼‰ä¸æ”¯æŒæŸ¥è¯¢ç¼“å­˜ï¼š åˆ†åŒºè¡¨ä¸æ”¯æŒæŸ¥è¯¢ç¼“å­˜ï¼Œå¯¹äºæ¶‰åŠåˆ†åŒºè¡¨çš„æŸ¥è¯¢ï¼Œå®ƒè‡ªåŠ¨ç¦ç”¨ã€‚ æŸ¥è¯¢ç¼“å­˜æ— æ³•å¯ç”¨æ­¤ç±»æŸ¥è¯¢ã€‚&lt;/p&gt;

&lt;p&gt;5ï¼‰åˆ†åŒºçš„innodbè¡¨ä¸æ”¯æŒå¤–é”®ã€‚&lt;/p&gt;

&lt;p&gt;6ï¼‰æœåŠ¡å™¨SQL_modeå½±å“åˆ†åŒºè¡¨çš„åŒæ­¥å¤åˆ¶ã€‚ ä¸»æœºå’Œä»æœºä¸Šçš„ä¸åŒSQL_modeå¯èƒ½ä¼šå¯¼è‡´sqlè¯­å¥; è¿™å¯èƒ½å¯¼è‡´åˆ†åŒºä¹‹é—´çš„æ•°æ®åˆ†é…ç»™å®šä¸»ä»ä½ç½®ä¸åŒï¼Œç”šè‡³å¯èƒ½å¯¼è‡´æ’å…¥ä¸»æœºä¸ŠæˆåŠŸçš„åˆ†åŒºè¡¨åœ¨ä»åº“ä¸Šå¤±è´¥ã€‚ ä¸ºäº†è·å¾—æœ€ä½³æ•ˆæœï¼Œæ‚¨åº”è¯¥å§‹ç»ˆåœ¨ä¸»æœºå’Œä»æœºä¸Šä½¿ç”¨ç›¸åŒçš„æœåŠ¡å™¨SQLæ¨¡å¼ã€‚&lt;/p&gt;

&lt;p&gt;7ï¼‰ALTER TABLE â€¦ ORDER BYï¼š å¯¹åˆ†åŒºè¡¨è¿è¡Œçš„ALTER TABLE â€¦ ORDER BYåˆ—è¯­å¥åªä¼šå¯¼è‡´æ¯ä¸ªåˆ†åŒºä¸­çš„è¡Œæ’åºã€‚&lt;/p&gt;

&lt;p&gt;8ï¼‰å…¨æ–‡ç´¢å¼•ã€‚ åˆ†åŒºè¡¨ä¸æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œå³ä½¿æ˜¯ä½¿ç”¨InnoDBæˆ–MyISAMå­˜å‚¨å¼•æ“çš„åˆ†åŒºè¡¨ã€‚  &lt;br /&gt;
9ï¼‰åˆ†åŒºè¡¨æ— æ³•ä½¿ç”¨å¤–é”®çº¦æŸã€‚  &lt;br /&gt;
10ï¼‰Spatial columnsï¼š å…·æœ‰ç©ºé—´æ•°æ®ç±»å‹ï¼ˆå¦‚POINTæˆ–GEOMETRYï¼‰çš„åˆ—ä¸èƒ½åœ¨åˆ†åŒºè¡¨ä¸­ä½¿ç”¨ã€‚ &lt;br /&gt;
11ï¼‰ä¸´æ—¶è¡¨ï¼š ä¸´æ—¶è¡¨ä¸èƒ½åˆ†åŒºã€‚  &lt;br /&gt;
12ï¼‰subpartitioné—®é¢˜ï¼š subpartitionå¿…é¡»ä½¿ç”¨HASHæˆ–KEYåˆ†åŒºã€‚ åªæœ‰RANGEå’ŒLISTåˆ†åŒºå¯èƒ½è¢«åˆ†åŒº; HASHå’ŒKEYåˆ†åŒºä¸èƒ½è¢«å­åˆ†åŒºã€‚ &lt;br /&gt;
13ï¼‰åˆ†åŒºè¡¨ä¸æ”¯æŒmysqlcheckï¼Œmyisamchkå’Œmyisampackã€‚&lt;/p&gt;

&lt;h3 id=&quot;ä¸‰åˆ›å»ºåˆ†åŒºè¡¨&quot;&gt;ä¸‰ã€åˆ›å»ºåˆ†åŒºè¡¨&lt;/h3&gt;
&lt;h4 id=&quot;1rangeåˆ†åŒº&quot;&gt;1ã€rangeåˆ†åŒº&lt;/h4&gt;

&lt;p&gt;1ï¼‰è¡Œæ•°æ®åŸºäºä¸€ä¸ªç»™å®šçš„è¿ç»­åŒºé—´çš„åˆ—å€¼æ”¾å…¥åˆ†åŒºã€‚&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;`test_11`&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`id`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`t`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;`id`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;`t`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHARSET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utf8&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RANGE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_days&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p20170801&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;736907&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p20170901&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;736938&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pmax&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;maxvalue&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123456789&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ï¼‰ç„¶åæ’å…¥4æ¡æ•°æ®ï¼š&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;into&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_11&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;20170722&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;20170822&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;20170823&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;20170824&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;3ï¼‰ç„¶åæŸ¥çœ‹informationä¸‹partitionså¯¹åˆ†åŒºåˆ«ä¿¡æ¯çš„ç»Ÿè®¡ï¼š&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION_NAME&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;åˆ†åŒº&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TABLE_ROWS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;è¡Œæ•°&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information_schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partitions&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;table_schema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;mysql_test&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;test_11&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+-----------+--------+
| åˆ†åŒº      | è¡Œæ•°   |
+-----------+--------+
| p20170801 |      1 |
| p20170901 |      3 |
+-----------+--------+
2 rows in set (0.00 sec)12345678
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºåˆ†åŒºp20170801æ’å…¥1è¡Œæ•°æ®ï¼Œp20170901æ’å…¥çš„3è¡Œæ•°æ®ã€‚
å¯ä»¥æ˜¯ç”¨yearã€to_daysã€unix_timestampç­‰å‡½æ•°å¯¹ç›¸åº”çš„æ—¶é—´å­—æ®µè¿›è¡Œè½¬æ¢ï¼Œç„¶ååˆ†åŒºã€‚&lt;/p&gt;
&lt;h3 id=&quot;2liståˆ†åŒº&quot;&gt;2ã€liståˆ†åŒº&lt;/h3&gt;

&lt;p&gt;å’Œrangeåˆ†åŒºä¸€æ ·ï¼Œåªæ˜¯liståˆ†åŒºé¢å‘çš„æ˜¯ç¦»æ•£çš„å€¼&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;c2&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;IN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;IN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123456789&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä¸RANGEåˆ†åŒºçš„æƒ…å†µä¸åŒï¼Œæ²¡æœ‰â€œcatch-allâ€ï¼Œå¦‚MAXVALUE; åˆ†åŒºè¡¨è¾¾å¼çš„æ‰€æœ‰é¢„æœŸå€¼åº”åœ¨PARTITION â€¦ VALUES INï¼ˆâ€¦ï¼‰å­å¥ä¸­æ¶µç›–ã€‚ åŒ…å«ä¸åŒ¹é…çš„åˆ†åŒºåˆ—å€¼çš„INSERTè¯­å¥å¤±è´¥å¹¶æ˜¾ç¤ºé”™è¯¯ï¼Œå¦‚æ­¤ç¤ºä¾‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ERROR&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1525&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HY000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;has&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;no&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;312&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;3hashåˆ†åŒº&quot;&gt;3ã€hashåˆ†åŒº&lt;/h4&gt;

&lt;p&gt;æ ¹æ®ç”¨æˆ·è‡ªå®šä¹‰è¡¨è¾¾å¼çš„è¿”å›å€¼æ¥è¿›è¡Œåˆ†åŒºï¼Œè¿”å›å€¼ä¸èƒ½ä¸ºè´Ÿæ•°&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col2&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;CHAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col3&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HASH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;YEAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITIONS&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;å¦‚æœä½ æ’å…¥col3çš„æ•°å€¼ä¸ºâ€™2005-09-15â€™ï¼Œé‚£ä¹ˆæ ¹æ®ä»¥ä¸‹è®¡ç®—æ¥é€‰æ‹©æ’å…¥çš„åˆ†åŒºï¼š&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;MOD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;YEAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2005-09-01'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;MOD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;1123&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;4keyåˆ†åŒº&quot;&gt;4ã€keyåˆ†åŒº&lt;/h4&gt;

&lt;p&gt;æ ¹æ®MySQLæ•°æ®åº“æä¾›çš„æ•£åˆ—å‡½æ•°è¿›è¡Œåˆ†åŒº&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;UNIQUE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITIONS&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234567&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;KEYä»…åˆ—å‡ºé›¶ä¸ªæˆ–å¤šä¸ªåˆ—åç§°ã€‚ ç”¨ä½œåˆ†åŒºé”®çš„ä»»ä½•åˆ—å¿…é¡»åŒ…å«è¡¨çš„ä¸»é”®çš„ä¸€éƒ¨åˆ†æˆ–å…¨éƒ¨ï¼Œå¦‚æœè¯¥è¡¨å…·æœ‰ä¸€ä¸ªã€‚ å¦‚æœæ²¡æœ‰åˆ—åç§°ä½œä¸ºåˆ†åŒºé”®ï¼Œåˆ™ä½¿ç”¨è¡¨çš„ä¸»é”®ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚å¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå”¯ä¸€çš„é”®ï¼Œé‚£ä¹ˆå”¯ä¸€é”®ç”¨äºåˆ†åŒºé”®ã€‚ä½†æ˜¯ï¼Œå¦‚æœå”¯ä¸€é”®åˆ—æœªå®šä¹‰ä¸ºNOT NULLï¼Œåˆ™ä¸Šä¸€æ¡è¯­å¥å°†å¤±è´¥ã€‚
ä¸å…¶ä»–åˆ†åŒºç±»å‹ä¸åŒï¼ŒKEYä½¿ç”¨çš„åˆ†åŒºä¸é™äºæ•´æ•°æˆ–ç©ºå€¼ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹CREATE TABLEè¯­å¥æ˜¯æœ‰æ•ˆçš„ï¼š&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tm1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;CHAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITIONS&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12345&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;æ³¨æ„ï¼šå¯¹äºkeyåˆ†åŒºè¡¨ï¼Œä¸èƒ½æ‰§è¡ŒALTER TABLE DROP PRIMARY KEYï¼Œå› ä¸ºè¿™æ ·åšä¼šç”Ÿæˆé”™è¯¯ ERROR 1466 (HY000): Field in list of fields for partition function not found in table.&lt;/p&gt;
&lt;h4 id=&quot;5columnåˆ†åŒº&quot;&gt;5ã€Columnåˆ†åŒº&lt;/h4&gt;

&lt;p&gt;COLUMNåˆ†åŒºæ˜¯5.5å¼€å§‹å¼•å…¥çš„åˆ†åŒºåŠŸèƒ½ï¼Œåªæœ‰RANGE COLUMNå’ŒLIST COLUMNè¿™ä¸¤ç§åˆ†åŒºï¼›æ”¯æŒæ•´å½¢ã€æ—¥æœŸã€å­—ç¬¦ä¸²ï¼›RANGEå’ŒLISTçš„åˆ†åŒºæ–¹å¼éå¸¸çš„ç›¸ä¼¼ã€‚
COLUMNSå’ŒRANGEå’ŒLISTåˆ†åŒºçš„åŒºåˆ«
1ï¼‰é’ˆå¯¹æ—¥æœŸå­—æ®µçš„åˆ†åŒºå°±ä¸éœ€è¦å†ä½¿ç”¨å‡½æ•°è¿›è¡Œè½¬æ¢äº†ï¼Œä¾‹å¦‚é’ˆå¯¹dateå­—æ®µè¿›è¡Œåˆ†åŒºä¸éœ€è¦å†ä½¿ç”¨YEAR()è¡¨è¾¾å¼è¿›è¡Œè½¬æ¢ã€‚  &lt;br /&gt;
2ï¼‰COLUMNåˆ†åŒºæ”¯æŒå¤šä¸ªå­—æ®µä½œä¸ºåˆ†åŒºé”®ä½†æ˜¯ä¸æ”¯æŒè¡¨è¾¾å¼ä½œä¸ºåˆ†åŒºé”®ã€‚&lt;/p&gt;

&lt;h5 id=&quot;columnæ”¯æŒçš„æ•°æ®ç±»å‹&quot;&gt;columnæ”¯æŒçš„æ•°æ®ç±»å‹ï¼š&lt;/h5&gt;

&lt;p&gt;1ï¼‰æ‰€æœ‰çš„æ•´å‹ï¼Œfloatå’Œdecimalä¸æ”¯æŒ  &lt;br /&gt;
2ï¼‰æ—¥æœŸç±»å‹ï¼šdateå’Œdatetimeï¼Œå…¶ä»–ä¸æ”¯æŒ  &lt;br /&gt;
3ï¼‰å­—ç¬¦ç±»å‹ï¼šCHAR, VARCHAR, BINARYå’ŒVARBINARYï¼Œblobå’Œtextä¸æ”¯æŒ &lt;br /&gt;
å•åˆ—çš„column rangeåˆ†åŒºmysql&amp;gt; show create table list_c;&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;`list_c`&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c1`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c2`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHARSET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latin1&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*!50500 PARTITION BY RANGE  COLUMNS(c1)
(PARTITION p0 VALUES LESS THAN (5) ENGINE = InnoDB,
 PARTITION p1 VALUES LESS THAN (10) ENGINE = InnoDB) */&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;å¤šåˆ—çš„column rangeåˆ†åŒºmysql&amp;gt; show create table list_c;&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;`list_c`&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c1`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c2`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c3`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHARSET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latin1&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*!50500 PARTITION BY RANGE  COLUMNS(c1,c3)
(PARTITION p0 VALUES LESS THAN (5,'aaa') ENGINE = InnoDB,
 PARTITION p1 VALUES LESS THAN (10,'bbb') ENGINE = InnoDB) */&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;å•åˆ—çš„&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;column&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;åˆ†åŒº&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;`list_c`&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c1`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c2`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`c3`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHARSET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latin1&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*!50500 PARTITION BY LIST  COLUMNS(c3)
(PARTITION p0 VALUES IN ('aaa') ENGINE = InnoDB,
 PARTITION p1 VALUES IN ('bbb') ENGINE = InnoDB) */&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;6å­åˆ†åŒºç»„åˆåˆ†åŒº&quot;&gt;6ã€å­åˆ†åŒºï¼ˆç»„åˆåˆ†åŒºï¼‰&lt;/h4&gt;

&lt;p&gt;åœ¨åˆ†åŒºçš„åŸºç¡€ä¸Šå†è¿›ä¸€æ­¥åˆ†åŒºï¼Œæœ‰æ—¶æˆä¸ºå¤åˆåˆ†åŒº;
MySQLæ•°æ®åº“å…è®¸åœ¨rangeå’Œlistçš„åˆ†åŒºä¸Šè¿›è¡ŒHASHå’ŒKEYçš„å­åˆ†åŒºã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;purchased&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RANGE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;YEAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;purchased&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;SUBPARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HASH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DAYS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;purchased&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;SUBPARTITIONS&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1990&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;MAXVALUE&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[root@mycat-3 ~]# ll /data/mysql_data_3306/mysql_test/ts*
-rw-r----- 1 mysql mysql  8596 Aug  8 13:54 /data/mysql_data_3306/mysql_test/ts.frm
-rw-r----- 1 mysql mysql 98304 Aug  8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p0#SP#p0sp0.ibd
-rw-r----- 1 mysql mysql 98304 Aug  8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p0#SP#p0sp1.ibd
-rw-r----- 1 mysql mysql 98304 Aug  8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p1#SP#p1sp0.ibd
-rw-r----- 1 mysql mysql 98304 Aug  8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p1#SP#p1sp1.ibd
-rw-r----- 1 mysql mysql 98304 Aug  8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p2#SP#p2sp0.ibd
-rw-r----- 1 mysql mysql 98304 Aug  8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p2#SP#p2sp1.ibd
1234567891011121314151617
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;tsè¡¨æ ¹æ®purchasedè¿›è¡Œrangeåˆ†åŒºï¼Œç„¶ååˆè¿›è¡Œäº†ä¸€æ¬¡hashåˆ†åŒºï¼Œæœ€åå½¢æˆäº†3*2ä¸ªåˆ†åŒºï¼Œå¯ä»¥ä»ç‰©ç†æ–‡ä»¶è¯å®æ­¤åˆ†åŒºæ–¹å¼ã€‚å¯ä»¥é€šè¿‡subpartitionè¯­æ³•æ¥æ˜¾ç¤ºæŒ‡å®šå­åˆ†åŒºåç§°ã€‚
æ³¨æ„ï¼šæ¯ä¸ªå­åˆ†åŒºçš„æ•°é‡å¿…é¡»ç›¸åŒï¼›å¦‚æœä¸€ä¸ªåˆ†åŒºè¡¨çš„ä»»ä½•å­åˆ†åŒºå·²ç»ä½¿ç”¨subpartitionï¼Œé‚£ä¹ˆå¿…é¡»è¡¨æ˜æ‰€æœ‰çš„å­åˆ†åŒºåç§°ï¼›æ¯ä¸ªsubpartitionå­å¥å¿…é¡»åŒ…æ‹¬å­åˆ†åŒºçš„ä¸€ä¸ªåå­—ï¼›å­åˆ†åŒºçš„åå­—å¿…é¡»æ˜¯ä¸€è‡´çš„
å¦å¤–ï¼Œå¯¹äºMyISAMè¡¨å¯ä»¥ä½¿ç”¨index directoryå’Œdata direactoryæ¥æŒ‡å®šå„ä¸ªåˆ†åŒºçš„æ•°æ®å’Œç´¢å¼•ç›®å½•ï¼Œä½†æ˜¯å¯¹äºinnodbè¡¨æ¥è¯´ï¼Œå› ä¸ºè¯¥å­˜å‚¨å¼•æ“ä½¿ç”¨è¡¨ç©ºé—´è‡ªåŠ¨çš„è¿›è¡Œæ•°æ®å’Œç´¢å¼•çš„ç®¡ç†ï¼Œå› æ­¤ä¼šå¿½ç•¥æŒ‡å®šindexå’Œdataçš„è¯­æ³•ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å››æ™®é€šè¡¨è½¬æ¢ä¸ºåˆ†åŒºè¡¨&quot;&gt;å››ã€æ™®é€šè¡¨è½¬æ¢ä¸ºåˆ†åŒºè¡¨&lt;/h3&gt;
&lt;p&gt;1ã€ç”¨alter table table_name partition byå‘½ä»¤é‡å»ºåˆ†åŒºè¡¨&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jxfp_data_bak&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITIONS&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;äº”åˆ†åŒºè¡¨æ“ä½œ&quot;&gt;äº”ã€åˆ†åŒºè¡¨æ“ä½œ&lt;/h3&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;year_col&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RANGE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year_col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1991&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1995&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1999&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;1add-partition-æ–°å¢åˆ†åŒº&quot;&gt;1ã€ADD PARTITION ï¼ˆæ–°å¢åˆ†åŒºï¼‰&lt;/h4&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ADD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2002&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;2drop-partition-åˆ é™¤åˆ†åŒº&quot;&gt;2ã€DROP PARTITION ï¼ˆåˆ é™¤åˆ†åŒºï¼‰&lt;/h4&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;3truncate-partitionæˆªå–åˆ†åŒº&quot;&gt;3ã€TRUNCATE PARTITIONï¼ˆæˆªå–åˆ†åŒºï¼‰&lt;/h4&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TRUNCATE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TRUNCATE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;4coalesce-partitionåˆå¹¶åˆ†åŒº&quot;&gt;4ã€COALESCE PARTITIONï¼ˆåˆå¹¶åˆ†åŒºï¼‰&lt;/h4&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;VARCHAR&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;started&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;DATE&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HASH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;YEAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;started&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITIONS&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;COALESCE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;5reorganize-partitionæ‹†åˆ†é‡ç»„åˆ†åŒº&quot;&gt;5ã€REORGANIZE PARTITIONï¼ˆæ‹†åˆ†/é‡ç»„åˆ†åŒºï¼‰&lt;/h4&gt;

&lt;h5 id=&quot;1æ‹†åˆ†åˆ†åŒº&quot;&gt;1ï¼‰æ‹†åˆ†åˆ†åŒº&lt;/h5&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ALGORITHM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;INPLACE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REORGANIZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;employees&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ADD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p5&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p6&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;MAXVALUE&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h5 id=&quot;2é‡ç»„åˆ†åŒº&quot;&gt;2ï¼‰é‡ç»„åˆ†åŒº&lt;/h5&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;members&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REORGANIZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1970&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl_name&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;REORGANIZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partition_list&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partition_definitions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;members&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REORGANIZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1980&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tt&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ADD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;IN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tt&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REORGANIZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;IN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;6analyze-check-partitionåˆ†æä¸æ£€æŸ¥åˆ†åŒº&quot;&gt;6ã€ANALYZE ã€CHECK PARTITIONï¼ˆåˆ†æä¸æ£€æŸ¥åˆ†åŒºï¼‰&lt;/h4&gt;

&lt;p&gt;1ï¼‰ANALYZE è¯»å–å’Œå­˜å‚¨åˆ†åŒºä¸­å€¼çš„åˆ†å¸ƒæƒ…å†µ&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ANALYZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ANALYZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ANALYZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;2ï¼‰CHECK æ£€æŸ¥åˆ†åŒºæ˜¯å¦å­˜åœ¨é”™è¯¯&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ANALYZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;CHECK&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;7repairåˆ†åŒº&quot;&gt;7ã€REPAIRåˆ†åŒº&lt;/h4&gt;

&lt;p&gt;ä¿®å¤è¢«ç ´åçš„åˆ†åŒº&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REPAIR&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;8optimize&quot;&gt;8ã€OPTIMIZE&lt;/h4&gt;

&lt;p&gt;è¯¥å‘½ä»¤ä¸»è¦æ˜¯ç”¨äºå›æ”¶ç©ºé—²ç©ºé—´å’Œåˆ†åŒºçš„ç¢ç‰‡æ•´ç†ã€‚å¯¹åˆ†åŒºæ‰§è¡Œè¯¥å‘½ä»¤,ç›¸å½“äºä¾æ¬¡å¯¹åˆ†åŒºæ‰§è¡Œ CHECK PARTITION, ANALYZE PARTITION,REPAIR PARTITIONå‘½ä»¤ã€‚&lt;/p&gt;

&lt;p&gt;è­¬å¦‚:&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPTIMIZE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;9rebuildåˆ†åŒº&quot;&gt;9ã€REBUILDåˆ†åŒº&lt;/h4&gt;

&lt;p&gt;é‡å»ºåˆ†åŒº,å®ƒç›¸å½“äºå…ˆåˆ é™¤åˆ†åŒºä¸­çš„æ•°æ®,ç„¶åé‡æ–°æ’å…¥ã€‚è¿™ä¸ªä¸»è¦æ˜¯ç”¨äºåˆ†åŒºçš„ç¢ç‰‡æ•´ç†ã€‚&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REBUILD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;10exchange-partitionåˆ†åŒºäº¤æ¢&quot;&gt;10ã€EXCHANGE PARTITIONï¼ˆåˆ†åŒºäº¤æ¢ï¼‰&lt;/h4&gt;

&lt;p&gt;åˆ†åŒºäº¤æ¢çš„è¯­æ³•å¦‚ä¸‹:&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pt&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EXCHANGE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;å…¶ä¸­,ptæ˜¯åˆ†åŒºè¡¨,pæ˜¯ptçš„åˆ†åŒº(æ³¨:ä¹Ÿå¯ä»¥æ˜¯å­åˆ†åŒº),ntæ˜¯ç›®æ ‡è¡¨ã€‚&lt;/p&gt;

&lt;p&gt;å…¶å®,åˆ†åŒºäº¤æ¢çš„é™åˆ¶è¿˜æ˜¯è›®å¤šçš„:&lt;/p&gt;

&lt;p&gt;1ï¼‰ ntä¸èƒ½ä¸ºåˆ†åŒºè¡¨&lt;/p&gt;

&lt;p&gt;2ï¼‰ntä¸èƒ½ä¸ºä¸´æ—¶è¡¨&lt;/p&gt;

&lt;p&gt;3ï¼‰ntå’Œptçš„ç»“æ„å¿…é¡»ä¸€è‡´&lt;/p&gt;

&lt;p&gt;4ï¼‰ntä¸å­˜åœ¨ä»»ä½•å¤–é”®çº¦æŸ,å³æ—¢ä¸èƒ½æ˜¯ä¸»é”®,ä¹Ÿä¸èƒ½æ˜¯å¤–é”®ã€‚&lt;/p&gt;

&lt;p&gt;5ï¼‰ntä¸­çš„æ•°æ®ä¸èƒ½ä½äºpåˆ†åŒºçš„èŒƒå›´ä¹‹å¤–ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“å¯å‚è€ƒMySQLçš„å®˜æ–¹æ–‡æ¡£&lt;/p&gt;

&lt;h4 id=&quot;11è¿ç§»åˆ†åŒºdiscard-import-&quot;&gt;11ã€è¿ç§»åˆ†åŒºï¼ˆDISCARD ã€IMPORT ï¼‰&lt;/h4&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DISCARD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TABLESPACE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IMPORT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TABLESPACE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;å®éªŒç¯å¢ƒï¼šï¼ˆéƒ½æ˜¯mysql5.7ï¼‰
æºåº“ï¼š192.168.2.200      mysql5.7.16    zhangdbä¸‹çš„emp_2åˆ†åŒºè¡¨çš„
ç›®æ ‡åº“ï¼š192.168.2.100    mysql5.7.18    testä¸‹  ï¼ˆå°†zhangdbçš„empè¡¨ï¼Œå¯¼å…¥åˆ°ç›®æ ‡åº“çš„test schemaä¸‹ï¼‰
â€“ï¼šåœ¨æºæ•°æ®åº“ä¸­åˆ›å»ºæµ‹è¯•åˆ†åŒºè¡¨emp_2ï¼Œç„¶åå¯¼å…¥æ•°æ®&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zhangdb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;BIGINT&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RANGE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LESS&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;     
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ï¼ˆæ¥ç€åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ï¼Œå¯¼å…¥æµ‹è¯•æ•°æ®ï¼‰&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;DELIMITER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;PROCEDURE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;insert_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;DECLARE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SET&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;WHILE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DO&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;THEN&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COMMIT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REPEAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'X'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REPEAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Y'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SET&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WHILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COMMIT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;DELIMITER&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE_NAME&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PARTITION_NAME&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information_schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partitions&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;table_schema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'zhangdb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;------------+----------------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;------------+----------------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;------------+----------------+&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;      &lt;span class=&quot;mi&quot;&gt;999&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œemp_2åˆ†åŒºè¡¨å·²ç»åˆ›å»ºå®Œæˆï¼Œå¹¶ä¸”æœ‰3ä¸ªå­åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸€ç‚¹æ•°æ®ã€‚
â€“ï¼šåœ¨ç›®æ ‡æ•°æ®åº“ä¸­ï¼Œåˆ›å»ºemp_2è¡¨çš„ç»“æ„ï¼Œä¸è¦æ•°æ®ï¼ˆè¦åœ¨æºåº“ï¼Œä½¿ç”¨show create table emp_2\G çš„æ–¹æ³• æŸ¥çœ‹åˆ›å»ºè¯¥è¡¨çš„sqlï¼‰&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;`emp_2`&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`id`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bigint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`x`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;varchar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`y`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;varchar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;`id`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHARSET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utf8mb4&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*!50500 PARTITION BY RANGE  COLUMNS(id)
(PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB) */&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[root@localhost test]# ll
-rw-r----- 1 mysql mysql 98304 May 25 15:58 emp_2#P#p0.ibd
-rw-r----- 1 mysql mysql 98304 May 25 15:58 emp_2#P#p1.ibd
-rw-r----- 1 mysql mysql 98304 May 25 15:58 emp_2#P#p2.ibd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;æ³¨æ„ï¼š
â€»çº¦æŸæ¡ä»¶ã€å­—ç¬¦é›†ç­‰ç­‰ä¹Ÿå¿…é¡»ä¸€è‡´ï¼Œå»ºè®®ä½¿ç”¨show create table t1; æ¥è·å–åˆ›å»ºè¡¨çš„SQLï¼Œå¦åˆ™åœ¨æ–°æœåŠ¡å™¨ä¸Šå¯¼å…¥è¡¨ç©ºé—´çš„æ—¶å€™ä¼šæç¤º1808é”™è¯¯ã€‚
â€“ï¼šåœ¨ç›®æ ‡æ•°æ®åº“ä¸Šï¼Œä¸¢å¼ƒåˆ†åŒºè¡¨çš„è¡¨ç©ºé—´&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;discard&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tablespace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[root@localhost test]# ll    ---è¿™æ—¶å€™åœ¨çœ‹ï¼Œåˆšæ‰çš„3ä¸ªåˆ†åŒºçš„idbæ–‡ä»¶éƒ½æ²¡æœ‰äº†
-rw-r----- 1 mysql mysql  8604 May 25 04:14 emp_2.frm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;â€“ï¼šåœ¨æºæ•°æ®åº“ä¸Šè¿è¡ŒFLUSH TABLES â€¦ FOR EXPORT é”å®šè¡¨å¹¶ç”Ÿæˆ.cfgå…ƒæ•°æ®æ–‡ä»¶ï¼Œæœ€åå°†cfgå’Œibdæ–‡ä»¶ä¼ è¾“åˆ°ç›®æ ‡æ•°æ®åº“ä¸­&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tables&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;export&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[root@localhost zhangdb]# scp emp_2* root@192.168.2.100:/mysql/data/test/   --å°†æ–‡ä»¶cpåˆ°ç›®æ ‡æ•°æ®åº“
mysql&amp;gt; unlock tables;   ---æœ€åå°†è¡¨çš„é”æ˜¯å¦
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;â€“ï¼šåœ¨ç›®æ ‡æ•°æ®åº“ä¸­å¯¹æ–‡ä»¶æˆæƒï¼Œç„¶åå¯¼å…¥è¡¨ç©ºé—´æŸ¥çœ‹æ•°æ®æ˜¯å¦å®Œæ•´å¯ç”¨&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;localhost&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#*&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;alter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tablespace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;affected&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emp_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;2999&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;----------+&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä»ä¸Šé¢çš„æŸ¥çœ‹å¾—çŸ¥ï¼Œåˆ†åŒºè¡¨éƒ½å·²ç»å¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“ä¸­äº†ï¼Œ
å¦å¤–ï¼Œä¹Ÿå¯ä»¥å°†éƒ¨åˆ†å­åˆ†åŒºå¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“ä¸­ï¼Œï¼ˆå¾€å¾€æ•´ä¸ªåˆ†åŒºè¡¨ä¼šå¾ˆå¤§ï¼Œå¯ç”¨åªå°†éœ€è¦ç”¨åˆ°çš„å­åˆ†åŒºå¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“ä¸­ï¼‰ï¼Œ
å°†éƒ¨åˆ†å­åˆ†åŒºå¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“çš„æ–¹æ³•æ˜¯ï¼š
1ï¼‰åœ¨åˆ›å»ºç›®æ ‡è¡¨çš„æ—¶å€™ï¼Œåªéœ€è¦åˆ›å»ºè¦å¯¼å…¥çš„åˆ†åŒºå³å¯ï¼Œå¦‚ï¼š åªåˆ›å»ºäº†p2 p3ä¸¤ä¸ªåˆ†åŒº&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;`emp_2`&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`id`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bigint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`x`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;varchar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;`y`&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;varchar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;`id`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENGINE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHARSET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utf8mb4&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*!50500 PARTITION BY RANGE  COLUMNS(id)
(
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB) */&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;2ï¼‰ä»æºåº“cpåˆ°ç›®æ ‡åº“çš„æ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå°±æ˜¯è¿™ä¿©çš„ï¼Œå°±ä¸éœ€è¦å…¶ä»–åˆ†åŒºçš„äº†ï¼Œ
3ï¼‰å…¶ä»–çš„æ“ä½œæ–¹æ³•éƒ½ä¸€æ ·äº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å…­å¦‚ä½•è·å–åˆ†åŒºçš„ç›¸å…³ä¿¡æ¯&quot;&gt;å…­ã€å¦‚ä½•è·å–åˆ†åŒºçš„ç›¸å…³ä¿¡æ¯&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;é€šè¿‡ SHOW CREATE TABLE è¯­å¥æ¥æŸ¥çœ‹åˆ†åŒºè¡¨çš„åˆ†åŒºå­å¥&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è­¬å¦‚:mysql&amp;gt; show create table e/G&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;é€šè¿‡ SHOW TABLE STATUS è¯­å¥æ¥æŸ¥çœ‹è¡¨æ˜¯å¦åˆ†åŒºå¯¹åº”Create_optionså­—æ®µ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è­¬å¦‚:
mysql&amp;gt; show table status/G&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;* 1. row **&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;*****&lt;/p&gt;

&lt;p&gt;Name: e Engine: InnoDB Version: 10 Row_format: Compact Rows: 6 Avg_row_length: 10922 Data_length: 65536Max_data_length: 0 Index_length: 0 Data_free: 0 Auto_increment: NULL Create_time: 2015-12-07 22:26:06 Update_time: NULL Check_time: NULL Collation: latin1_swedish_ci Checksum: NULL Create_options: partitioned Comment:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;æŸ¥çœ‹ INFORMATION_SCHEMA.PARTITIONSè¡¨&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é€šè¿‡ EXPLAIN PARTITIONS SELECT è¯­å¥æŸ¥çœ‹å¯¹äºå…·ä½“çš„SELECTè¯­å¥,ä¼šè®¿é—®å“ªä¸ªåˆ†åŒºã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ä¸ƒmysql57å¯¹äºpartitionè¡¨çš„æ”¹è¿›&quot;&gt;ä¸ƒã€MySQL5.7å¯¹äºpartitionè¡¨çš„æ”¹è¿›&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;HANDLER statementsï¼šMySQL 5.7.1åˆ†åŒºè¡¨å¼€å§‹æ”¯æŒHANDLERè¯­å¥ï¼›&lt;/li&gt;
  &lt;li&gt;index condition pushdownï¼šMySQL5.7.3åˆ†åŒºè¡¨å¼€å§‹æ”¯æŒICPï¼›&lt;/li&gt;
  &lt;li&gt;load dataï¼šMySQL5.7å¼€å§‹ä½¿ç”¨ç¼“å­˜æ¥å®ç°æ€§èƒ½æå‡ï¼Œæ¯ä¸ªåˆ†åŒºä½¿ç”¨130KBç¼“å†²åŒºæ¥å®ç°è¿™ä¸€ç‚¹ï¼›&lt;/li&gt;
  &lt;li&gt;Per-partitionç´¢å¼•ç¼“å­˜ï¼šMySQL5.7å¼€å§‹æ”¯æŒä½¿ç”¨CACHE INDEXå’ŒLOAD INDEX INTO CACHEè¯­å¥å¯¹åˆ†åŒºçš„MyISAMè¡¨æ”¯æŒç´¢å¼•ç¼“å­˜ï¼›&lt;/li&gt;
  &lt;li&gt;FOR EXPORTé€‰é¡¹ï¼ˆFLUSH TABLESï¼‰:MySQL 5.7.4åˆ†åŒºçš„InnoDBè¡¨å¼€å§‹æ”¯æŒFLUSH TABLESè¯­å¥FOR EXPORTé€‰é¡¹ï¼›&lt;/li&gt;
  &lt;li&gt;ä»MySQL 5.7.2å¼€å§‹ï¼Œå­åˆ†åŒºæ”¯æŒANALYZEï¼ŒCHECKï¼ŒOPTIMIZEï¼ŒREPAIRå’ŒTRUNCATEæ“ä½œï¼›&lt;/li&gt;
&lt;/ul&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="mysql" /><summary type="html">è§†é¢‘å‚è€ƒé“¾æ¥ MySQLåˆ†åŒº ä¸€ã€æŸ¥çœ‹MySQLæ˜¯å¦æ”¯æŒåˆ†åŒº 1ã€MySQL5.6ä»¥åŠä¹‹å‰ç‰ˆæœ¬ show variables like â€˜%partition%â€™; 2ã€MySQL5.7 show plugins; äºŒã€åˆ†åŒºè¡¨çš„åˆ†ç±»ä¸é™åˆ¶ 1ã€åˆ†åŒºè¡¨åˆ†ç±» RANGEåˆ†åŒºï¼šåŸºäºå±äºä¸€ä¸ªç»™å®šè¿ç»­åŒºé—´çš„åˆ—å€¼ï¼ŒæŠŠå¤šè¡Œåˆ†é…ç»™åˆ†åŒºã€‚ LISTåˆ†åŒºï¼šç±»ä¼¼äºæŒ‰RANGEåˆ†åŒºï¼ŒåŒºåˆ«åœ¨äºLISTåˆ†åŒºæ˜¯åŸºäºåˆ—å€¼åŒ¹é…ä¸€ä¸ªç¦»æ•£å€¼é›†åˆä¸­çš„æŸä¸ªå€¼æ¥è¿›è¡Œé€‰æ‹©ã€‚ HASHåˆ†åŒºï¼šåŸºäºç”¨æˆ·å®šä¹‰çš„è¡¨è¾¾å¼çš„è¿”å›å€¼æ¥è¿›è¡Œé€‰æ‹©çš„åˆ†åŒºï¼Œè¯¥è¡¨è¾¾å¼ä½¿ç”¨å°†è¦æ’å…¥åˆ°è¡¨ä¸­çš„è¿™äº›è¡Œçš„åˆ—å€¼è¿›è¡Œè®¡ç®—ã€‚è¿™ä¸ªå‡½æ•°å¯ä»¥åŒ…å«MySQL ä¸­æœ‰æ•ˆçš„ã€äº§ç”Ÿéè´Ÿæ•´æ•°å€¼çš„ä»»ä½•è¡¨è¾¾å¼ã€‚ KEYåˆ†åŒºï¼šç±»ä¼¼äºæŒ‰HASHåˆ†åŒºï¼ŒåŒºåˆ«åœ¨äºKEYåˆ†åŒºåªæ”¯æŒè®¡ç®—ä¸€åˆ—æˆ–å¤šåˆ—ï¼Œä¸”MySQLæœåŠ¡å™¨æä¾›å…¶è‡ªèº«çš„å“ˆå¸Œå‡½æ•°ã€‚å¿…é¡»æœ‰ä¸€åˆ—æˆ–å¤šåˆ—åŒ…å«æ•´æ•°å€¼ã€‚ å¤åˆåˆ†åŒºï¼šåœ¨MySQL 5.6ç‰ˆæœ¬ä¸­ï¼Œåªæ”¯æŒRANGEå’ŒLISTçš„å­åˆ†åŒºï¼Œä¸”å­åˆ†åŒºçš„ç±»å‹åªèƒ½ä¸ºHASHå’ŒKEYã€‚ 2ã€åˆ†åŒºè¡¨é™åˆ¶ 1ï¼‰åˆ†åŒºé”®å¿…é¡»åŒ…å«åœ¨è¡¨çš„æ‰€æœ‰ä¸»é”®ã€å”¯ä¸€é”®ä¸­ã€‚ 2ï¼‰MYSQLåªèƒ½åœ¨ä½¿ç”¨åˆ†åŒºå‡½æ•°çš„åˆ—æœ¬èº«è¿›è¡Œæ¯”è¾ƒæ—¶æ‰èƒ½è¿‡æ»¤åˆ†åŒºï¼Œè€Œä¸èƒ½æ ¹æ®è¡¨è¾¾å¼çš„å€¼å»è¿‡æ»¤åˆ†åŒºï¼Œå³ä½¿è¿™ä¸ªè¡¨è¾¾å¼å°±æ˜¯åˆ†åŒºå‡½æ•°ä¹Ÿä¸è¡Œã€‚ 3ï¼‰æœ€å¤§åˆ†åŒºæ•°ï¼š ä¸ä½¿ç”¨NDBå­˜å‚¨å¼•æ“çš„ç»™å®šè¡¨çš„æœ€å¤§å¯èƒ½åˆ†åŒºæ•°ä¸º8192ï¼ˆåŒ…æ‹¬å­åˆ†åŒºï¼‰ã€‚å¦‚æœå½“åˆ†åŒºæ•°å¾ˆå¤§ï¼Œä½†æ˜¯æœªè¾¾åˆ°8192æ—¶æç¤º Got error â€¦ from storage engine: Out of resources when opening file,å¯ä»¥é€šè¿‡å¢åŠ open_files_limitç³»ç»Ÿå˜é‡çš„å€¼æ¥è§£å†³é—®é¢˜ï¼Œå½“ç„¶åŒæ—¶æ‰“å¼€æ–‡ä»¶çš„æ•°é‡ä¹Ÿå¯èƒ½ç”±æ“ä½œç³»ç»Ÿé™åˆ¶ã€‚ 4ï¼‰ä¸æ”¯æŒæŸ¥è¯¢ç¼“å­˜ï¼š åˆ†åŒºè¡¨ä¸æ”¯æŒæŸ¥è¯¢ç¼“å­˜ï¼Œå¯¹äºæ¶‰åŠåˆ†åŒºè¡¨çš„æŸ¥è¯¢ï¼Œå®ƒè‡ªåŠ¨ç¦ç”¨ã€‚ æŸ¥è¯¢ç¼“å­˜æ— æ³•å¯ç”¨æ­¤ç±»æŸ¥è¯¢ã€‚ 5ï¼‰åˆ†åŒºçš„innodbè¡¨ä¸æ”¯æŒå¤–é”®ã€‚ 6ï¼‰æœåŠ¡å™¨SQL_modeå½±å“åˆ†åŒºè¡¨çš„åŒæ­¥å¤åˆ¶ã€‚ ä¸»æœºå’Œä»æœºä¸Šçš„ä¸åŒSQL_modeå¯èƒ½ä¼šå¯¼è‡´sqlè¯­å¥; è¿™å¯èƒ½å¯¼è‡´åˆ†åŒºä¹‹é—´çš„æ•°æ®åˆ†é…ç»™å®šä¸»ä»ä½ç½®ä¸åŒï¼Œç”šè‡³å¯èƒ½å¯¼è‡´æ’å…¥ä¸»æœºä¸ŠæˆåŠŸçš„åˆ†åŒºè¡¨åœ¨ä»åº“ä¸Šå¤±è´¥ã€‚ ä¸ºäº†è·å¾—æœ€ä½³æ•ˆæœï¼Œæ‚¨åº”è¯¥å§‹ç»ˆåœ¨ä¸»æœºå’Œä»æœºä¸Šä½¿ç”¨ç›¸åŒçš„æœåŠ¡å™¨SQLæ¨¡å¼ã€‚ 7ï¼‰ALTER TABLE â€¦ ORDER BYï¼š å¯¹åˆ†åŒºè¡¨è¿è¡Œçš„ALTER TABLE â€¦ ORDER BYåˆ—è¯­å¥åªä¼šå¯¼è‡´æ¯ä¸ªåˆ†åŒºä¸­çš„è¡Œæ’åºã€‚ 8ï¼‰å…¨æ–‡ç´¢å¼•ã€‚ åˆ†åŒºè¡¨ä¸æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œå³ä½¿æ˜¯ä½¿ç”¨InnoDBæˆ–MyISAMå­˜å‚¨å¼•æ“çš„åˆ†åŒºè¡¨ã€‚ 9ï¼‰åˆ†åŒºè¡¨æ— æ³•ä½¿ç”¨å¤–é”®çº¦æŸã€‚ 10ï¼‰Spatial columnsï¼š å…·æœ‰ç©ºé—´æ•°æ®ç±»å‹ï¼ˆå¦‚POINTæˆ–GEOMETRYï¼‰çš„åˆ—ä¸èƒ½åœ¨åˆ†åŒºè¡¨ä¸­ä½¿ç”¨ã€‚ 11ï¼‰ä¸´æ—¶è¡¨ï¼š ä¸´æ—¶è¡¨ä¸èƒ½åˆ†åŒºã€‚ 12ï¼‰subpartitioné—®é¢˜ï¼š subpartitionå¿…é¡»ä½¿ç”¨HASHæˆ–KEYåˆ†åŒºã€‚ åªæœ‰RANGEå’ŒLISTåˆ†åŒºå¯èƒ½è¢«åˆ†åŒº; HASHå’ŒKEYåˆ†åŒºä¸èƒ½è¢«å­åˆ†åŒºã€‚ 13ï¼‰åˆ†åŒºè¡¨ä¸æ”¯æŒmysqlcheckï¼Œmyisamchkå’Œmyisampackã€‚ ä¸‰ã€åˆ›å»ºåˆ†åŒºè¡¨ 1ã€rangeåˆ†åŒº 1ï¼‰è¡Œæ•°æ®åŸºäºä¸€ä¸ªç»™å®šçš„è¿ç»­åŒºé—´çš„åˆ—å€¼æ”¾å…¥åˆ†åŒºã€‚ CREATE TABLE `test_11` ( `id` int(11) NOT NULL, `t` date NOT NULL, PRIMARY KEY (`id`,`t`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 PARTITION BY RANGE (to_days(t)) (PARTITION p20170801 VALUES LESS THAN (736907) ENGINE = InnoDB, PARTITION p20170901 VALUES LESS THAN (736938) ENGINE = InnoDB, PARTITION pmax VALUES LESS THAN maxvalue ENGINE = InnoDB);123456789 2ï¼‰ç„¶åæ’å…¥4æ¡æ•°æ®ï¼š insert into test_11 values (1,&quot;20170722&quot;),(2,&quot;20170822&quot;),(3,&quot;20170823&quot;),(4,&quot;20170824&quot;);1 3ï¼‰ç„¶åæŸ¥çœ‹informationä¸‹partitionså¯¹åˆ†åŒºåˆ«ä¿¡æ¯çš„ç»Ÿè®¡ï¼š select PARTITION_NAME as &quot;åˆ†åŒº&quot;,TABLE_ROWS as &quot;è¡Œæ•°&quot; from information_schema.partitions where table_schema=&quot;mysql_test&quot; and table_name=&quot;test_11&quot;; +-----------+--------+ | åˆ†åŒº | è¡Œæ•° | +-----------+--------+ | p20170801 | 1 | | p20170901 | 3 | +-----------+--------+ 2 rows in set (0.00 sec)12345678 å¯ä»¥çœ‹å‡ºåˆ†åŒºp20170801æ’å…¥1è¡Œæ•°æ®ï¼Œp20170901æ’å…¥çš„3è¡Œæ•°æ®ã€‚ å¯ä»¥æ˜¯ç”¨yearã€to_daysã€unix_timestampç­‰å‡½æ•°å¯¹ç›¸åº”çš„æ—¶é—´å­—æ®µè¿›è¡Œè½¬æ¢ï¼Œç„¶ååˆ†åŒºã€‚ 2ã€liståˆ†åŒº å’Œrangeåˆ†åŒºä¸€æ ·ï¼Œåªæ˜¯liståˆ†åŒºé¢å‘çš„æ˜¯ç¦»æ•£çš„å€¼ mysql&amp;gt; CREATE TABLE h2 ( -&amp;gt; c1 INT, -&amp;gt; c2 INT -&amp;gt; ) -&amp;gt; PARTITION BY LIST(c1) ( -&amp;gt; PARTITION p0 VALUES IN (1, 4, 7), -&amp;gt; PARTITION p1 VALUES IN (2, 5, 8) -&amp;gt; ); Query OK, 0 rows affected (0.11 sec)123456789 ä¸RANGEåˆ†åŒºçš„æƒ…å†µä¸åŒï¼Œæ²¡æœ‰â€œcatch-allâ€ï¼Œå¦‚MAXVALUE; åˆ†åŒºè¡¨è¾¾å¼çš„æ‰€æœ‰é¢„æœŸå€¼åº”åœ¨PARTITION â€¦ VALUES INï¼ˆâ€¦ï¼‰å­å¥ä¸­æ¶µç›–ã€‚ åŒ…å«ä¸åŒ¹é…çš„åˆ†åŒºåˆ—å€¼çš„INSERTè¯­å¥å¤±è´¥å¹¶æ˜¾ç¤ºé”™è¯¯ï¼Œå¦‚æ­¤ç¤ºä¾‹æ‰€ç¤ºï¼š mysql&amp;gt; INSERT INTO h2 VALUES (3, 5); ERROR 1525 (HY000): Table has no partition for value 312 3ã€hashåˆ†åŒº æ ¹æ®ç”¨æˆ·è‡ªå®šä¹‰è¡¨è¾¾å¼çš„è¿”å›å€¼æ¥è¿›è¡Œåˆ†åŒºï¼Œè¿”å›å€¼ä¸èƒ½ä¸ºè´Ÿæ•° CREATE TABLE t1 (col1 INT, col2 CHAR(5), col3 DATE) PARTITION BY HASH( YEAR(col3) ) PARTITIONS 4;123 å¦‚æœä½ æ’å…¥col3çš„æ•°å€¼ä¸ºâ€™2005-09-15â€™ï¼Œé‚£ä¹ˆæ ¹æ®ä»¥ä¸‹è®¡ç®—æ¥é€‰æ‹©æ’å…¥çš„åˆ†åŒºï¼š MOD(YEAR('2005-09-01'),4) = MOD(2005,4) = 1123 4ã€keyåˆ†åŒº æ ¹æ®MySQLæ•°æ®åº“æä¾›çš„æ•£åˆ—å‡½æ•°è¿›è¡Œåˆ†åŒº CREATE TABLE k1 ( id INT NOT NULL, name VARCHAR(20), UNIQUE KEY (id) ) PARTITION BY KEY() PARTITIONS 2;1234567 KEYä»…åˆ—å‡ºé›¶ä¸ªæˆ–å¤šä¸ªåˆ—åç§°ã€‚ ç”¨ä½œåˆ†åŒºé”®çš„ä»»ä½•åˆ—å¿…é¡»åŒ…å«è¡¨çš„ä¸»é”®çš„ä¸€éƒ¨åˆ†æˆ–å…¨éƒ¨ï¼Œå¦‚æœè¯¥è¡¨å…·æœ‰ä¸€ä¸ªã€‚ å¦‚æœæ²¡æœ‰åˆ—åç§°ä½œä¸ºåˆ†åŒºé”®ï¼Œåˆ™ä½¿ç”¨è¡¨çš„ä¸»é”®ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚å¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå”¯ä¸€çš„é”®ï¼Œé‚£ä¹ˆå”¯ä¸€é”®ç”¨äºåˆ†åŒºé”®ã€‚ä½†æ˜¯ï¼Œå¦‚æœå”¯ä¸€é”®åˆ—æœªå®šä¹‰ä¸ºNOT NULLï¼Œåˆ™ä¸Šä¸€æ¡è¯­å¥å°†å¤±è´¥ã€‚ ä¸å…¶ä»–åˆ†åŒºç±»å‹ä¸åŒï¼ŒKEYä½¿ç”¨çš„åˆ†åŒºä¸é™äºæ•´æ•°æˆ–ç©ºå€¼ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹CREATE TABLEè¯­å¥æ˜¯æœ‰æ•ˆçš„ï¼š CREATE TABLE tm1 ( s1 CHAR(32) PRIMARY KEY ) PARTITION BY KEY(s1) PARTITIONS 10;12345 æ³¨æ„ï¼šå¯¹äºkeyåˆ†åŒºè¡¨ï¼Œä¸èƒ½æ‰§è¡ŒALTER TABLE DROP PRIMARY KEYï¼Œå› ä¸ºè¿™æ ·åšä¼šç”Ÿæˆé”™è¯¯ ERROR 1466 (HY000): Field in list of fields for partition function not found in table. 5ã€Columnåˆ†åŒº COLUMNåˆ†åŒºæ˜¯5.5å¼€å§‹å¼•å…¥çš„åˆ†åŒºåŠŸèƒ½ï¼Œåªæœ‰RANGE COLUMNå’ŒLIST COLUMNè¿™ä¸¤ç§åˆ†åŒºï¼›æ”¯æŒæ•´å½¢ã€æ—¥æœŸã€å­—ç¬¦ä¸²ï¼›RANGEå’ŒLISTçš„åˆ†åŒºæ–¹å¼éå¸¸çš„ç›¸ä¼¼ã€‚ COLUMNSå’ŒRANGEå’ŒLISTåˆ†åŒºçš„åŒºåˆ« 1ï¼‰é’ˆå¯¹æ—¥æœŸå­—æ®µçš„åˆ†åŒºå°±ä¸éœ€è¦å†ä½¿ç”¨å‡½æ•°è¿›è¡Œè½¬æ¢äº†ï¼Œä¾‹å¦‚é’ˆå¯¹dateå­—æ®µè¿›è¡Œåˆ†åŒºä¸éœ€è¦å†ä½¿ç”¨YEAR()è¡¨è¾¾å¼è¿›è¡Œè½¬æ¢ã€‚ 2ï¼‰COLUMNåˆ†åŒºæ”¯æŒå¤šä¸ªå­—æ®µä½œä¸ºåˆ†åŒºé”®ä½†æ˜¯ä¸æ”¯æŒè¡¨è¾¾å¼ä½œä¸ºåˆ†åŒºé”®ã€‚ columnæ”¯æŒçš„æ•°æ®ç±»å‹ï¼š 1ï¼‰æ‰€æœ‰çš„æ•´å‹ï¼Œfloatå’Œdecimalä¸æ”¯æŒ 2ï¼‰æ—¥æœŸç±»å‹ï¼šdateå’Œdatetimeï¼Œå…¶ä»–ä¸æ”¯æŒ 3ï¼‰å­—ç¬¦ç±»å‹ï¼šCHAR, VARCHAR, BINARYå’ŒVARBINARYï¼Œblobå’Œtextä¸æ”¯æŒ å•åˆ—çš„column rangeåˆ†åŒºmysql&amp;gt; show create table list_c; CREATE TABLE `list_c` ( `c1` int(11) DEFAULT NULL, `c2` int(11) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=latin1 /*!50500 PARTITION BY RANGE COLUMNS(c1) (PARTITION p0 VALUES LESS THAN (5) ENGINE = InnoDB, PARTITION p1 VALUES LESS THAN (10) ENGINE = InnoDB) */ å¤šåˆ—çš„column rangeåˆ†åŒºmysql&amp;gt; show create table list_c; CREATE TABLE `list_c` ( `c1` int(11) DEFAULT NULL, `c2` int(11) DEFAULT NULL, `c3` char(20) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=latin1 /*!50500 PARTITION BY RANGE COLUMNS(c1,c3) (PARTITION p0 VALUES LESS THAN (5,'aaa') ENGINE = InnoDB, PARTITION p1 VALUES LESS THAN (10,'bbb') ENGINE = InnoDB) */ å•åˆ—çš„column liståˆ†åŒºmysql&amp;gt; show create table list_c; CREATE TABLE `list_c` ( `c1` int(11) DEFAULT NULL, `c2` int(11) DEFAULT NULL, `c3` char(20) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=latin1 /*!50500 PARTITION BY LIST COLUMNS(c3) (PARTITION p0 VALUES IN ('aaa') ENGINE = InnoDB, PARTITION p1 VALUES IN ('bbb') ENGINE = InnoDB) */ 6ã€å­åˆ†åŒºï¼ˆç»„åˆåˆ†åŒºï¼‰ åœ¨åˆ†åŒºçš„åŸºç¡€ä¸Šå†è¿›ä¸€æ­¥åˆ†åŒºï¼Œæœ‰æ—¶æˆä¸ºå¤åˆåˆ†åŒº; MySQLæ•°æ®åº“å…è®¸åœ¨rangeå’Œlistçš„åˆ†åŒºä¸Šè¿›è¡ŒHASHå’ŒKEYçš„å­åˆ†åŒºã€‚ä¾‹å¦‚ï¼š CREATE TABLE ts (id INT, purchased DATE) PARTITION BY RANGE( YEAR(purchased) ) SUBPARTITION BY HASH( TO_DAYS(purchased) ) SUBPARTITIONS 2 ( PARTITION p0 VALUES LESS THAN (1990), PARTITION p1 VALUES LESS THAN (2000), PARTITION p2 VALUES LESS THAN MAXVALUE ); [root@mycat-3 ~]# ll /data/mysql_data_3306/mysql_test/ts* -rw-r----- 1 mysql mysql 8596 Aug 8 13:54 /data/mysql_data_3306/mysql_test/ts.frm -rw-r----- 1 mysql mysql 98304 Aug 8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p0#SP#p0sp0.ibd -rw-r----- 1 mysql mysql 98304 Aug 8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p0#SP#p0sp1.ibd -rw-r----- 1 mysql mysql 98304 Aug 8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p1#SP#p1sp0.ibd -rw-r----- 1 mysql mysql 98304 Aug 8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p1#SP#p1sp1.ibd -rw-r----- 1 mysql mysql 98304 Aug 8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p2#SP#p2sp0.ibd -rw-r----- 1 mysql mysql 98304 Aug 8 13:54 /data/mysql_data_3306/mysql_test/ts#P#p2#SP#p2sp1.ibd 1234567891011121314151617 tsè¡¨æ ¹æ®purchasedè¿›è¡Œrangeåˆ†åŒºï¼Œç„¶ååˆè¿›è¡Œäº†ä¸€æ¬¡hashåˆ†åŒºï¼Œæœ€åå½¢æˆäº†3*2ä¸ªåˆ†åŒºï¼Œå¯ä»¥ä»ç‰©ç†æ–‡ä»¶è¯å®æ­¤åˆ†åŒºæ–¹å¼ã€‚å¯ä»¥é€šè¿‡subpartitionè¯­æ³•æ¥æ˜¾ç¤ºæŒ‡å®šå­åˆ†åŒºåç§°ã€‚ æ³¨æ„ï¼šæ¯ä¸ªå­åˆ†åŒºçš„æ•°é‡å¿…é¡»ç›¸åŒï¼›å¦‚æœä¸€ä¸ªåˆ†åŒºè¡¨çš„ä»»ä½•å­åˆ†åŒºå·²ç»ä½¿ç”¨subpartitionï¼Œé‚£ä¹ˆå¿…é¡»è¡¨æ˜æ‰€æœ‰çš„å­åˆ†åŒºåç§°ï¼›æ¯ä¸ªsubpartitionå­å¥å¿…é¡»åŒ…æ‹¬å­åˆ†åŒºçš„ä¸€ä¸ªåå­—ï¼›å­åˆ†åŒºçš„åå­—å¿…é¡»æ˜¯ä¸€è‡´çš„ å¦å¤–ï¼Œå¯¹äºMyISAMè¡¨å¯ä»¥ä½¿ç”¨index directoryå’Œdata direactoryæ¥æŒ‡å®šå„ä¸ªåˆ†åŒºçš„æ•°æ®å’Œç´¢å¼•ç›®å½•ï¼Œä½†æ˜¯å¯¹äºinnodbè¡¨æ¥è¯´ï¼Œå› ä¸ºè¯¥å­˜å‚¨å¼•æ“ä½¿ç”¨è¡¨ç©ºé—´è‡ªåŠ¨çš„è¿›è¡Œæ•°æ®å’Œç´¢å¼•çš„ç®¡ç†ï¼Œå› æ­¤ä¼šå¿½ç•¥æŒ‡å®šindexå’Œdataçš„è¯­æ³•ã€‚ å››ã€æ™®é€šè¡¨è½¬æ¢ä¸ºåˆ†åŒºè¡¨ 1ã€ç”¨alter table table_name partition byå‘½ä»¤é‡å»ºåˆ†åŒºè¡¨ alter table jxfp_data_bak PARTITION BY KEY(SH) PARTITIONS 8; äº”ã€åˆ†åŒºè¡¨æ“ä½œ CREATE TABLE t1 ( id INT, year_col INT ) PARTITION BY RANGE (year_col) ( PARTITION p0 VALUES LESS THAN (1991), PARTITION p1 VALUES LESS THAN (1995), PARTITION p2 VALUES LESS THAN (1999) ); 1ã€ADD PARTITION ï¼ˆæ–°å¢åˆ†åŒºï¼‰ ALTER TABLE t1 ADD PARTITION (PARTITION p3 VALUES LESS THAN (2002)); 2ã€DROP PARTITION ï¼ˆåˆ é™¤åˆ†åŒºï¼‰ ALTER TABLE t1 DROP PARTITION p0, p1; 3ã€TRUNCATE PARTITIONï¼ˆæˆªå–åˆ†åŒºï¼‰ ALTER TABLE t1 TRUNCATE PARTITION p0; ALTER TABLE t1 TRUNCATE PARTITION p1, p3; 4ã€COALESCE PARTITIONï¼ˆåˆå¹¶åˆ†åŒºï¼‰ CREATE TABLE t2 ( name VARCHAR (30), started DATE ) PARTITION BY HASH( YEAR(started) ) PARTITIONS 6; ALTER TABLE t2 COALESCE PARTITION 2; 5ã€REORGANIZE PARTITIONï¼ˆæ‹†åˆ†/é‡ç»„åˆ†åŒºï¼‰ 1ï¼‰æ‹†åˆ†åˆ†åŒº ALTER TABLE table ALGORITHM=INPLACE, REORGANIZE PARTITION; ALTER TABLE employees ADD PARTITION ( PARTITION p5 VALUES LESS THAN (2010), PARTITION p6 VALUES LESS THAN MAXVALUE ); 2ï¼‰é‡ç»„åˆ†åŒº ALTER TABLE members REORGANIZE PARTITION s0,s1 INTO ( PARTITION p0 VALUES LESS THAN (1970) ); ALTER TABLE tbl_name REORGANIZE PARTITION partition_list INTO (partition_definitions); ALTER TABLE members REORGANIZE PARTITION p0,p1,p2,p3 INTO ( PARTITION m0 VALUES LESS THAN (1980), PARTITION m1 VALUES LESS THAN (2000) ); ALTER TABLE tt ADD PARTITION (PARTITION np VALUES IN (4, 8)); ALTER TABLE tt REORGANIZE PARTITION p1,np INTO ( PARTITION p1 VALUES IN (6, 18), PARTITION np VALUES in (4, 8, 12) ); 6ã€ANALYZE ã€CHECK PARTITIONï¼ˆåˆ†æä¸æ£€æŸ¥åˆ†åŒºï¼‰ 1ï¼‰ANALYZE è¯»å–å’Œå­˜å‚¨åˆ†åŒºä¸­å€¼çš„åˆ†å¸ƒæƒ…å†µ ALTER TABLE t1 ANALYZE PARTITION p1, ANALYZE PARTITION p2; ALTER TABLE t1 ANALYZE PARTITION p1, p2; 2ï¼‰CHECK æ£€æŸ¥åˆ†åŒºæ˜¯å¦å­˜åœ¨é”™è¯¯ ALTER TABLE t1 ANALYZE PARTITION p1, CHECK PARTITION p2; 7ã€REPAIRåˆ†åŒº ä¿®å¤è¢«ç ´åçš„åˆ†åŒº ALTER TABLE t1 REPAIR PARTITION p0,p1; 8ã€OPTIMIZE è¯¥å‘½ä»¤ä¸»è¦æ˜¯ç”¨äºå›æ”¶ç©ºé—²ç©ºé—´å’Œåˆ†åŒºçš„ç¢ç‰‡æ•´ç†ã€‚å¯¹åˆ†åŒºæ‰§è¡Œè¯¥å‘½ä»¤,ç›¸å½“äºä¾æ¬¡å¯¹åˆ†åŒºæ‰§è¡Œ CHECK PARTITION, ANALYZE PARTITION,REPAIR PARTITIONå‘½ä»¤ã€‚ è­¬å¦‚: ALTER TABLE t1 OPTIMIZE PARTITION p0, p1; 9ã€REBUILDåˆ†åŒº é‡å»ºåˆ†åŒº,å®ƒç›¸å½“äºå…ˆåˆ é™¤åˆ†åŒºä¸­çš„æ•°æ®,ç„¶åé‡æ–°æ’å…¥ã€‚è¿™ä¸ªä¸»è¦æ˜¯ç”¨äºåˆ†åŒºçš„ç¢ç‰‡æ•´ç†ã€‚ ALTER TABLE t1 REBUILD PARTITION p0, p1; 10ã€EXCHANGE PARTITIONï¼ˆåˆ†åŒºäº¤æ¢ï¼‰ åˆ†åŒºäº¤æ¢çš„è¯­æ³•å¦‚ä¸‹: ALTER TABLE pt EXCHANGE PARTITION p WITH TABLE nt å…¶ä¸­,ptæ˜¯åˆ†åŒºè¡¨,pæ˜¯ptçš„åˆ†åŒº(æ³¨:ä¹Ÿå¯ä»¥æ˜¯å­åˆ†åŒº),ntæ˜¯ç›®æ ‡è¡¨ã€‚ å…¶å®,åˆ†åŒºäº¤æ¢çš„é™åˆ¶è¿˜æ˜¯è›®å¤šçš„: 1ï¼‰ ntä¸èƒ½ä¸ºåˆ†åŒºè¡¨ 2ï¼‰ntä¸èƒ½ä¸ºä¸´æ—¶è¡¨ 3ï¼‰ntå’Œptçš„ç»“æ„å¿…é¡»ä¸€è‡´ 4ï¼‰ntä¸å­˜åœ¨ä»»ä½•å¤–é”®çº¦æŸ,å³æ—¢ä¸èƒ½æ˜¯ä¸»é”®,ä¹Ÿä¸èƒ½æ˜¯å¤–é”®ã€‚ 5ï¼‰ntä¸­çš„æ•°æ®ä¸èƒ½ä½äºpåˆ†åŒºçš„èŒƒå›´ä¹‹å¤–ã€‚ å…·ä½“å¯å‚è€ƒMySQLçš„å®˜æ–¹æ–‡æ¡£ 11ã€è¿ç§»åˆ†åŒºï¼ˆDISCARD ã€IMPORT ï¼‰ ALTER TABLE t1 DISCARD PARTITION p2, p3 TABLESPACE; ALTER TABLE t1 IMPORT PARTITION p2, p3 TABLESPACE; å®éªŒç¯å¢ƒï¼šï¼ˆéƒ½æ˜¯mysql5.7ï¼‰ æºåº“ï¼š192.168.2.200 mysql5.7.16 zhangdbä¸‹çš„emp_2åˆ†åŒºè¡¨çš„ ç›®æ ‡åº“ï¼š192.168.2.100 mysql5.7.18 testä¸‹ ï¼ˆå°†zhangdbçš„empè¡¨ï¼Œå¯¼å…¥åˆ°ç›®æ ‡åº“çš„test schemaä¸‹ï¼‰ â€“ï¼šåœ¨æºæ•°æ®åº“ä¸­åˆ›å»ºæµ‹è¯•åˆ†åŒºè¡¨emp_2ï¼Œç„¶åå¯¼å…¥æ•°æ® MySQL [zhangdb]&amp;gt; CREATE TABLE emp_2( id BIGINT unsigned NOT NULL AUTO_INCREMENT, x VARCHAR(500) NOT NULL, y VARCHAR(500) NOT NULL, PRIMARY KEY(id) ) PARTITION BY RANGE COLUMNS(id) ( PARTITION p1 VALUES LESS THAN (1000), PARTITION p2 VALUES LESS THAN (2000), PARTITION p3 VALUES LESS THAN (3000) ); ï¼ˆæ¥ç€åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ï¼Œå¯¼å…¥æµ‹è¯•æ•°æ®ï¼‰ DELIMITER // CREATE PROCEDURE insert_batch() begin DECLARE num INT; SET num=1; WHILE num &amp;lt; 3000 DO IF (num%10000=0) THEN COMMIT; END IF; INSERT INTO emp_2 VALUES(NULL, REPEAT('X', 500), REPEAT('Y', 500)); SET num=num+1; END WHILE; COMMIT; END // DELIMITER ; mysql&amp;gt; select TABLE_NAME,PARTITION_NAME from information_schema.partitions where table_schema='zhangdb'; +------------+----------------+ | TABLE_NAME | PARTITION_NAME | +------------+----------------+ | emp | NULL | | emp_2 | p1 | | emp_2 | p2 | | emp_2 | p3 | +------------+----------------+ 4 rows in set (0.00 sec) mysql&amp;gt; select count(*) from emp_2 partition (p1); +----------+ | count(*) | +----------+ | 999 | +----------+ 1 row in set (0.00 sec) mysql&amp;gt; select count(*) from emp_2 partition (p2); +----------+ | count(*) | +----------+ | 1000 | +----------+ 1 row in set (0.00 sec) mysql&amp;gt; select count(*) from emp_2 partition (p3); +----------+ | count(*) | +----------+ | 1000 | +----------+ 1 row in set (0.00 sec) ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œemp_2åˆ†åŒºè¡¨å·²ç»åˆ›å»ºå®Œæˆï¼Œå¹¶ä¸”æœ‰3ä¸ªå­åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸€ç‚¹æ•°æ®ã€‚ â€“ï¼šåœ¨ç›®æ ‡æ•°æ®åº“ä¸­ï¼Œåˆ›å»ºemp_2è¡¨çš„ç»“æ„ï¼Œä¸è¦æ•°æ®ï¼ˆè¦åœ¨æºåº“ï¼Œä½¿ç”¨show create table emp_2\G çš„æ–¹æ³• æŸ¥çœ‹åˆ›å»ºè¯¥è¡¨çš„sqlï¼‰ MySQL [test]&amp;gt; CREATE TABLE `emp_2` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `x` varchar(500) NOT NULL, `y` varchar(500) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=3000 DEFAULT CHARSET=utf8mb4 /*!50500 PARTITION BY RANGE COLUMNS(id) (PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB, PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB, PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB) */ ; [root@localhost test]# ll -rw-r----- 1 mysql mysql 98304 May 25 15:58 emp_2#P#p0.ibd -rw-r----- 1 mysql mysql 98304 May 25 15:58 emp_2#P#p1.ibd -rw-r----- 1 mysql mysql 98304 May 25 15:58 emp_2#P#p2.ibd æ³¨æ„ï¼š â€»çº¦æŸæ¡ä»¶ã€å­—ç¬¦é›†ç­‰ç­‰ä¹Ÿå¿…é¡»ä¸€è‡´ï¼Œå»ºè®®ä½¿ç”¨show create table t1; æ¥è·å–åˆ›å»ºè¡¨çš„SQLï¼Œå¦åˆ™åœ¨æ–°æœåŠ¡å™¨ä¸Šå¯¼å…¥è¡¨ç©ºé—´çš„æ—¶å€™ä¼šæç¤º1808é”™è¯¯ã€‚ â€“ï¼šåœ¨ç›®æ ‡æ•°æ®åº“ä¸Šï¼Œä¸¢å¼ƒåˆ†åŒºè¡¨çš„è¡¨ç©ºé—´ MySQL [test]&amp;gt; alter table emp_2 discard tablespace; Query OK, 0 rows affected (0.12 sec) [root@localhost test]# ll ---è¿™æ—¶å€™åœ¨çœ‹ï¼Œåˆšæ‰çš„3ä¸ªåˆ†åŒºçš„idbæ–‡ä»¶éƒ½æ²¡æœ‰äº† -rw-r----- 1 mysql mysql 8604 May 25 04:14 emp_2.frm â€“ï¼šåœ¨æºæ•°æ®åº“ä¸Šè¿è¡ŒFLUSH TABLES â€¦ FOR EXPORT é”å®šè¡¨å¹¶ç”Ÿæˆ.cfgå…ƒæ•°æ®æ–‡ä»¶ï¼Œæœ€åå°†cfgå’Œibdæ–‡ä»¶ä¼ è¾“åˆ°ç›®æ ‡æ•°æ®åº“ä¸­ mysql&amp;gt; flush tables emp_2 for export; Query OK, 0 rows affected (0.00 sec) [root@localhost zhangdb]# scp emp_2* root@192.168.2.100:/mysql/data/test/ --å°†æ–‡ä»¶cpåˆ°ç›®æ ‡æ•°æ®åº“ mysql&amp;gt; unlock tables; ---æœ€åå°†è¡¨çš„é”æ˜¯å¦ â€“ï¼šåœ¨ç›®æ ‡æ•°æ®åº“ä¸­å¯¹æ–‡ä»¶æˆæƒï¼Œç„¶åå¯¼å…¥è¡¨ç©ºé—´æŸ¥çœ‹æ•°æ®æ˜¯å¦å®Œæ•´å¯ç”¨ [root@localhost test]# chown mysql.mysql emp_2#* MySQL [test]&amp;gt; alter table emp_2 import tablespace; Query OK, 0 rows affected (0.96 sec) MySQL [test]&amp;gt; select count(*) from emp_2; +----------+ | count(*) | +----------+ | 2999 | +----------+ 1 row in set (0.63 sec) ä»ä¸Šé¢çš„æŸ¥çœ‹å¾—çŸ¥ï¼Œåˆ†åŒºè¡¨éƒ½å·²ç»å¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“ä¸­äº†ï¼Œ å¦å¤–ï¼Œä¹Ÿå¯ä»¥å°†éƒ¨åˆ†å­åˆ†åŒºå¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“ä¸­ï¼Œï¼ˆå¾€å¾€æ•´ä¸ªåˆ†åŒºè¡¨ä¼šå¾ˆå¤§ï¼Œå¯ç”¨åªå°†éœ€è¦ç”¨åˆ°çš„å­åˆ†åŒºå¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“ä¸­ï¼‰ï¼Œ å°†éƒ¨åˆ†å­åˆ†åŒºå¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“çš„æ–¹æ³•æ˜¯ï¼š 1ï¼‰åœ¨åˆ›å»ºç›®æ ‡è¡¨çš„æ—¶å€™ï¼Œåªéœ€è¦åˆ›å»ºè¦å¯¼å…¥çš„åˆ†åŒºå³å¯ï¼Œå¦‚ï¼š åªåˆ›å»ºäº†p2 p3ä¸¤ä¸ªåˆ†åŒº CREATE TABLE `emp_2` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `x` varchar(500) NOT NULL, `y` varchar(500) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=3000 DEFAULT CHARSET=utf8mb4 /*!50500 PARTITION BY RANGE COLUMNS(id) ( PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB, PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB) */ 2ï¼‰ä»æºåº“cpåˆ°ç›®æ ‡åº“çš„æ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå°±æ˜¯è¿™ä¿©çš„ï¼Œå°±ä¸éœ€è¦å…¶ä»–åˆ†åŒºçš„äº†ï¼Œ 3ï¼‰å…¶ä»–çš„æ“ä½œæ–¹æ³•éƒ½ä¸€æ ·äº†ã€‚ å…­ã€å¦‚ä½•è·å–åˆ†åŒºçš„ç›¸å…³ä¿¡æ¯ é€šè¿‡ SHOW CREATE TABLE è¯­å¥æ¥æŸ¥çœ‹åˆ†åŒºè¡¨çš„åˆ†åŒºå­å¥ è­¬å¦‚:mysql&amp;gt; show create table e/G é€šè¿‡ SHOW TABLE STATUS è¯­å¥æ¥æŸ¥çœ‹è¡¨æ˜¯å¦åˆ†åŒºå¯¹åº”Create_optionså­—æ®µ è­¬å¦‚: mysql&amp;gt; show table status/G ********* 1. row ************* Name: e Engine: InnoDB Version: 10 Row_format: Compact Rows: 6 Avg_row_length: 10922 Data_length: 65536Max_data_length: 0 Index_length: 0 Data_free: 0 Auto_increment: NULL Create_time: 2015-12-07 22:26:06 Update_time: NULL Check_time: NULL Collation: latin1_swedish_ci Checksum: NULL Create_options: partitioned Comment: æŸ¥çœ‹ INFORMATION_SCHEMA.PARTITIONSè¡¨ é€šè¿‡ EXPLAIN PARTITIONS SELECT è¯­å¥æŸ¥çœ‹å¯¹äºå…·ä½“çš„SELECTè¯­å¥,ä¼šè®¿é—®å“ªä¸ªåˆ†åŒºã€‚ ä¸ƒã€MySQL5.7å¯¹äºpartitionè¡¨çš„æ”¹è¿› HANDLER statementsï¼šMySQL 5.7.1åˆ†åŒºè¡¨å¼€å§‹æ”¯æŒHANDLERè¯­å¥ï¼› index condition pushdownï¼šMySQL5.7.3åˆ†åŒºè¡¨å¼€å§‹æ”¯æŒICPï¼› load dataï¼šMySQL5.7å¼€å§‹ä½¿ç”¨ç¼“å­˜æ¥å®ç°æ€§èƒ½æå‡ï¼Œæ¯ä¸ªåˆ†åŒºä½¿ç”¨130KBç¼“å†²åŒºæ¥å®ç°è¿™ä¸€ç‚¹ï¼› Per-partitionç´¢å¼•ç¼“å­˜ï¼šMySQL5.7å¼€å§‹æ”¯æŒä½¿ç”¨CACHE INDEXå’ŒLOAD INDEX INTO CACHEè¯­å¥å¯¹åˆ†åŒºçš„MyISAMè¡¨æ”¯æŒç´¢å¼•ç¼“å­˜ï¼› FOR EXPORTé€‰é¡¹ï¼ˆFLUSH TABLESï¼‰:MySQL 5.7.4åˆ†åŒºçš„InnoDBè¡¨å¼€å§‹æ”¯æŒFLUSH TABLESè¯­å¥FOR EXPORTé€‰é¡¹ï¼› ä»MySQL 5.7.2å¼€å§‹ï¼Œå­åˆ†åŒºæ”¯æŒANALYZEï¼ŒCHECKï¼ŒOPTIMIZEï¼ŒREPAIRå’ŒTRUNCATEæ“ä½œï¼›</summary></entry><entry><title type="html">å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ</title><link href="http://localhost:4000/jvm/Thread" rel="alternate" type="text/html" title="å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ" /><published>2020-06-20T00:00:00+08:00</published><updated>2020-06-20T00:00:00+08:00</updated><id>http://localhost:4000/jvm/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B%E4%B8%AD%E7%9A%84%E4%B8%89%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5</id><content type="html" xml:base="http://localhost:4000/jvm/Thread">&lt;h3 id=&quot;å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ&quot;&gt;å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ&lt;/h3&gt;
&lt;h4 id=&quot;åŸå­æ€§&quot;&gt;åŸå­æ€§&lt;/h4&gt;
&lt;p&gt;è¿™ä¸€ç‚¹ï¼Œè·Ÿæ•°æ®åº“äº‹åŠ¡çš„åŸå­æ€§æ¦‚å¿µå·®ä¸å¤šï¼Œå³ä¸€ä¸ªæ“ä½œï¼ˆæœ‰å¯èƒ½åŒ…å«æœ‰å¤šä¸ªå­æ“ä½œï¼‰è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼ˆç”Ÿæ•ˆï¼‰ï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œï¼ˆéƒ½ä¸ç”Ÿæ•ˆï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å…³äºåŸå­æ€§ï¼Œä¸€ä¸ªéå¸¸ç»å…¸çš„ä¾‹å­å°±æ˜¯é“¶è¡Œè½¬è´¦é—®é¢˜ï¼šæ¯”å¦‚Aå’ŒBåŒæ—¶å‘Cè½¬è´¦10ä¸‡å…ƒã€‚å¦‚æœè½¬è´¦æ“ä½œä¸å…·æœ‰åŸå­æ€§ï¼ŒAåœ¨å‘Cè½¬è´¦æ—¶ï¼Œè¯»å–äº†Cçš„ä½™é¢ä¸º20ä¸‡ï¼Œç„¶ååŠ ä¸Šè½¬è´¦çš„10ä¸‡ï¼Œè®¡ç®—å‡ºæ­¤æ—¶åº”è¯¥æœ‰30ä¸‡ï¼Œä½†è¿˜æœªæ¥åŠå°†30ä¸‡å†™å›Cçš„è´¦æˆ·ï¼Œæ­¤æ—¶Bçš„è½¬è´¦è¯·æ±‚è¿‡æ¥äº†ï¼ŒBå‘ç°Cçš„ä½™é¢ä¸º20ä¸‡ï¼Œç„¶åå°†å…¶åŠ 10ä¸‡å¹¶å†™å›ã€‚ç„¶åAçš„è½¬è´¦æ“ä½œç»§ç»­â€”â€”å°†30ä¸‡å†™å›Cçš„ä½™é¢ã€‚è¿™ç§æƒ…å†µä¸‹Cçš„æœ€ç»ˆä½™é¢ä¸º30ä¸‡ï¼Œè€Œéé¢„æœŸçš„40ä¸‡ã€‚&lt;/p&gt;

&lt;h4 id=&quot;å¯è§æ€§ç»ˆç‚¹è¿™é‡Œèƒ½è¯´æ˜ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨æ•°æ®ä¼šè¢«ä¸²æ”¹&quot;&gt;å¯è§æ€§(ç»ˆç‚¹ï¼Œè¿™é‡Œèƒ½è¯´æ˜ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•°æ®ä¼šè¢«ä¸²æ”¹)&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;å¯è§æ€§æ˜¯æŒ‡ï¼Œå½“å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«å˜é‡æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹åˆ°ã€‚å¯è§æ€§é—®é¢˜æ˜¯å¥½å¤šäººå¿½ç•¥æˆ–è€…ç†è§£é”™è¯¯çš„ä¸€ç‚¹ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;CPUä»ä¸»å†…å­˜ä¸­è¯»æ•°æ®çš„æ•ˆç‡ç›¸å¯¹æ¥è¯´ä¸é«˜ï¼Œç°åœ¨ä¸»æµçš„è®¡ç®—æœºä¸­ï¼Œéƒ½æœ‰å‡ çº§ç¼“å­˜ã€‚æ¯ä¸ªçº¿ç¨‹è¯»å–å…±äº«å˜é‡æ—¶ï¼Œéƒ½ä¼šå°†è¯¥å˜é‡åŠ è½½è¿›å…¶å¯¹åº”CPUçš„é«˜é€Ÿç¼“å­˜é‡Œï¼Œä¿®æ”¹è¯¥å˜é‡åï¼ŒCPUä¼šç«‹å³æ›´æ–°è¯¥ç¼“å­˜ï¼Œä½†å¹¶ä¸ä¸€å®šä¼šç«‹å³å°†å…¶å†™å›ä¸»å†…å­˜ï¼ˆå®é™…ä¸Šå†™å›ä¸»å†…å­˜çš„æ—¶é—´ä¸å¯é¢„æœŸï¼‰ã€‚æ­¤æ—¶å…¶å®ƒçº¿ç¨‹ï¼ˆå°¤å…¶æ˜¯ä¸åœ¨åŒä¸€ä¸ªCPUä¸Šæ‰§è¡Œçš„çº¿ç¨‹ï¼‰è®¿é—®è¯¥å˜é‡æ—¶ï¼Œä»ä¸»å†…å­˜ä¸­è¯»åˆ°çš„å°±æ˜¯æ—§çš„æ•°æ®ï¼Œè€Œéç¬¬ä¸€ä¸ªçº¿ç¨‹æ›´æ–°åçš„æ•°æ®ã€‚
è¿™ä¸€ç‚¹æ˜¯æ“ä½œç³»ç»Ÿæˆ–è€…è¯´æ˜¯ç¡¬ä»¶å±‚é¢çš„æœºåˆ¶ï¼Œæ‰€ä»¥å¾ˆå¤šåº”ç”¨å¼€å‘äººå‘˜ç»å¸¸ä¼šå¿½ç•¥ã€‚&lt;/p&gt;

&lt;h4 id=&quot;é¡ºåºæ€§&quot;&gt;é¡ºåºæ€§&lt;/h4&gt;
&lt;p&gt;é¡ºåºæ€§æŒ‡çš„æ˜¯ï¼Œç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚
ä»¥ä¸‹é¢è¿™æ®µä»£ç ä¸ºä¾‹&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;started&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// è¯­å¥1&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// è¯­å¥2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// è¯­å¥3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;started&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// è¯­å¥4&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä»ä»£ç é¡ºåºä¸Šçœ‹ï¼Œä¸Šé¢å››æ¡è¯­å¥åº”è¯¥ä¾æ¬¡æ‰§è¡Œï¼Œä½†å®é™…ä¸ŠJVMçœŸæ­£åœ¨æ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå¹¶ä¸ä¿è¯å®ƒä»¬ä¸€å®šå®Œå…¨æŒ‰ç…§æ­¤é¡ºåºæ‰§è¡Œã€‚&lt;/p&gt;

&lt;p&gt;å¤„ç†å™¨ä¸ºäº†æé«˜ç¨‹åºæ•´ä½“çš„æ‰§è¡Œæ•ˆç‡ï¼Œå¯èƒ½ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œå…¶ä¸­çš„ä¸€é¡¹ä¼˜åŒ–æ–¹å¼å°±æ˜¯è°ƒæ•´ä»£ç é¡ºåºï¼ŒæŒ‰ç…§æ›´é«˜æ•ˆçš„é¡ºåºæ‰§è¡Œä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;è®²åˆ°è¿™é‡Œï¼Œæœ‰äººè¦ç€æ€¥äº†â€”â€”ä»€ä¹ˆï¼ŒCPUä¸æŒ‰ç…§æˆ‘çš„ä»£ç é¡ºåºæ‰§è¡Œä»£ç ï¼Œé‚£æ€ä¹ˆä¿è¯å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœå‘¢ï¼Ÿå®é™…ä¸Šï¼Œå¤§å®¶å¤§å¯æ”¾å¿ƒï¼ŒCPUè™½ç„¶å¹¶ä¸ä¿è¯å®Œå…¨æŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œï¼Œä½†å®ƒä¼šä¿è¯ç¨‹åºæœ€ç»ˆçš„æ‰§è¡Œç»“æœå’Œä»£ç é¡ºåºæ‰§è¡Œæ—¶çš„ç»“æœä¸€è‡´ã€‚&lt;/p&gt;
&lt;h3 id=&quot;javaå¦‚ä½•è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜&quot;&gt;Javaå¦‚ä½•è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜&lt;/h3&gt;
&lt;h4 id=&quot;javaå¦‚ä½•ä¿è¯åŸå­æ€§&quot;&gt;Javaå¦‚ä½•ä¿è¯åŸå­æ€§&lt;/h4&gt;
&lt;h5 id=&quot;é”å’ŒåŒæ­¥&quot;&gt;é”å’ŒåŒæ­¥&lt;/h5&gt;

&lt;p&gt;å¸¸ç”¨çš„ä¿è¯Javaæ“ä½œåŸå­æ€§çš„å·¥å…·æ˜¯é”å’ŒåŒæ­¥æ–¹æ³•ï¼ˆæˆ–è€…åŒæ­¥ä»£ç å—ï¼‰ã€‚ä½¿ç”¨é”ï¼Œå¯ä»¥ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‹¿åˆ°é”ï¼Œä¹Ÿå°±ä¿è¯äº†åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œç”³è¯·é”å’Œé‡Šæ”¾é”ä¹‹é—´çš„ä»£ç ã€‚&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;testLock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;unlock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä¸é”ç±»ä¼¼çš„æ˜¯åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥ä»£ç å—ã€‚ä½¿ç”¨éé™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯å½“å‰å®ä¾‹ï¼›ä½¿ç”¨é™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯è¯¥ç±»çš„Classå¯¹è±¡ï¼›ä½¿ç”¨é™æ€ä»£ç å—æ—¶ï¼Œé”ä½çš„æ˜¯synchronizedå…³é”®å­—åé¢æ‹¬å·å†…çš„å¯¹è±¡ã€‚ä¸‹é¢æ˜¯åŒæ­¥ä»£ç å—ç¤ºä¾‹&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;testLock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anyObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;æ— è®ºä½¿ç”¨é”è¿˜æ˜¯synchronizedï¼Œæœ¬è´¨éƒ½æ˜¯ä¸€æ ·ï¼Œé€šè¿‡é”æ¥å®ç°èµ„æºçš„æ’å®ƒæ€§ï¼Œä»è€Œå®é™…ç›®æ ‡ä»£ç æ®µåŒä¸€æ—¶é—´åªä¼šè¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œè¿›è€Œä¿è¯äº†ç›®æ ‡ä»£ç æ®µçš„åŸå­æ€§ã€‚è¿™æ˜¯ä¸€ç§ä»¥ç‰ºç‰²æ€§èƒ½ä¸ºä»£ä»·çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h5 id=&quot;cascompare-and-swap&quot;&gt;CASï¼ˆcompare and swapï¼‰&lt;/h5&gt;

&lt;p&gt;åŸºç¡€ç±»å‹å˜é‡è‡ªå¢ï¼ˆi++ï¼‰æ˜¯ä¸€ç§å¸¸è¢«æ–°æ‰‹è¯¯ä»¥ä¸ºæ˜¯åŸå­æ“ä½œè€Œå®é™…ä¸æ˜¯çš„æ“ä½œã€‚Javaä¸­æä¾›äº†å¯¹åº”çš„åŸå­æ“ä½œç±»æ¥å®ç°è¯¥æ“ä½œï¼Œå¹¶ä¿è¯åŸå­æ€§ï¼Œå…¶æœ¬è´¨æ˜¯åˆ©ç”¨äº†CPUçº§åˆ«çš„CASæŒ‡ä»¤ã€‚ç”±äºæ˜¯CPUçº§åˆ«çš„æŒ‡ä»¤ï¼Œå…¶å¼€é”€æ¯”éœ€è¦æ“ä½œç³»ç»Ÿå‚ä¸çš„é”çš„å¼€é”€å°ã€‚AtomicIntegerä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AtomicInteger&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atomicInteger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numThreads&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;atomicInteger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;incrementAndGet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;javaå¦‚ä½•ä¿è¯å¯è§æ€§&quot;&gt;Javaå¦‚ä½•ä¿è¯å¯è§æ€§&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Javaæä¾›äº†volatileå…³é”®å­—æ¥ä¿è¯å¯è§æ€§ã€‚å½“ä½¿ç”¨volatileä¿®é¥°æŸä¸ªå˜é‡æ—¶ï¼Œå®ƒä¼šä¿è¯å¯¹è¯¥å˜é‡çš„ä¿®æ”¹ä¼šç«‹å³è¢«æ›´æ–°åˆ°å†…å­˜ä¸­ï¼Œå¹¶ä¸”å°†å…¶å®ƒç¼“å­˜ä¸­å¯¹è¯¥å˜é‡çš„ç¼“å­˜è®¾ç½®æˆæ— æ•ˆï¼Œå› æ­¤å…¶å®ƒçº¿ç¨‹éœ€è¦è¯»å–è¯¥å€¼æ—¶å¿…é¡»ä»ä¸»å†…å­˜ä¸­è¯»å–ï¼Œä»è€Œå¾—åˆ°æœ€æ–°çš„å€¼ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id=&quot;javaå¦‚ä½•ä¿è¯é¡ºåºæ€§&quot;&gt;Javaå¦‚ä½•ä¿è¯é¡ºåºæ€§&lt;/h4&gt;
&lt;p&gt;ä¸Šæ–‡è®²è¿‡ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ–°æ’åºæ—¶ï¼Œä¼šä¿è¯é‡æ–°æ’åºåçš„æ‰§è¡Œç»“æœå’Œä»£ç é¡ºåºæ‰§è¡Œçš„ç»“æœä¸€è‡´ï¼Œæ‰€ä»¥é‡æ–°æ’åºè¿‡ç¨‹å¹¶ä¸ä¼šå½±å“å•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œï¼Œå´å¯èƒ½å½±å“å¤šçº¿ç¨‹ç¨‹åºå¹¶å‘æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;

&lt;p&gt;Javaä¸­å¯é€šè¿‡volatileåœ¨ä¸€å®šç¨‹åºä¸Šä¿è¯é¡ºåºæ€§ï¼Œå¦å¤–è¿˜å¯ä»¥é€šè¿‡synchronizedå’Œé”æ¥ä¿è¯é¡ºåºæ€§ã€‚&lt;/p&gt;

&lt;p&gt;synchronizedå’Œé”ä¿è¯é¡ºåºæ€§çš„åŸç†å’Œä¿è¯åŸå­æ€§ä¸€æ ·ï¼Œéƒ½æ˜¯é€šè¿‡ä¿è¯åŒä¸€æ—¶é—´åªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç›®æ ‡ä»£ç æ®µæ¥å®ç°çš„ã€‚&lt;/p&gt;

&lt;p&gt;é™¤äº†ä»åº”ç”¨å±‚é¢ä¿è¯ç›®æ ‡ä»£ç æ®µæ‰§è¡Œçš„é¡ºåºæ€§å¤–ï¼ŒJVMè¿˜é€šè¿‡è¢«ç§°ä¸ºhappens-beforeåŸåˆ™éšå¼åœ°ä¿è¯é¡ºåºæ€§ã€‚ä¸¤ä¸ªæ“ä½œçš„æ‰§è¡Œé¡ºåºåªè¦å¯ä»¥é€šè¿‡happens-beforeæ¨å¯¼å‡ºæ¥ï¼Œåˆ™JVMä¼šä¿è¯å…¶é¡ºåºæ€§ï¼Œåä¹‹JVMå¯¹å…¶é¡ºåºæ€§ä¸ä½œä»»ä½•ä¿è¯ï¼Œå¯å¯¹å…¶è¿›è¡Œä»»æ„å¿…è¦çš„é‡æ–°æ’åºä»¥è·å–é«˜æ•ˆç‡ã€‚&lt;/p&gt;

&lt;h4 id=&quot;happens-beforeåŸåˆ™å…ˆè¡Œå‘ç”ŸåŸåˆ™&quot;&gt;happens-beforeåŸåˆ™ï¼ˆå…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼‰&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;ä¼ é€’è§„åˆ™ï¼šå¦‚æœæ“ä½œ1åœ¨æ“ä½œ2å‰é¢ï¼Œè€Œæ“ä½œ2åœ¨æ“ä½œ3å‰é¢ï¼Œåˆ™æ“ä½œ1è‚¯å®šä¼šåœ¨æ“ä½œ3å‰å‘ç”Ÿã€‚è¯¥è§„åˆ™è¯´æ˜äº†happens-beforeåŸåˆ™å…·æœ‰ä¼ é€’æ€§&lt;/li&gt;
  &lt;li&gt;é”å®šè§„åˆ™ï¼šä¸€ä¸ªunlockæ“ä½œè‚¯å®šä¼šåœ¨åé¢å¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œå‰å‘ç”Ÿã€‚è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œé”åªæœ‰è¢«é‡Šæ”¾äº†æ‰ä¼šè¢«å†æ¬¡è·å–&lt;/li&gt;
  &lt;li&gt;volatileå˜é‡è§„åˆ™ï¼šå¯¹ä¸€ä¸ªè¢«volatileä¿®é¥°çš„å†™æ“ä½œå…ˆå‘ç”Ÿäºåé¢å¯¹è¯¥å˜é‡çš„è¯»æ“ä½œ&lt;/li&gt;
  &lt;li&gt;ç¨‹åºæ¬¡åºè§„åˆ™ï¼šä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œ&lt;/li&gt;
  &lt;li&gt;çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼šThreadå¯¹è±¡çš„start()æ–¹æ³•å…ˆå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„å…¶å®ƒåŠ¨ä½œ&lt;/li&gt;
  &lt;li&gt;çº¿ç¨‹ç»ˆç»“åŸåˆ™ï¼šçº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹åå‘ç”Ÿäºçº¿ç¨‹ä¸­å…¶å®ƒçš„æ‰€æœ‰æ“ä½œ&lt;/li&gt;
  &lt;li&gt;çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼š å¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆå‘ç”Ÿäºå¯¹è¯¥ä¸­æ–­å¼‚å¸¸çš„è·å–&lt;/li&gt;
  &lt;li&gt;å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡æ„é€ å…ˆäºå®ƒçš„finalizeå‘ç”Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;volatileé€‚ç”¨åœºæ™¯&quot;&gt;volatileé€‚ç”¨åœºæ™¯&lt;/h4&gt;

&lt;p&gt;volatileé€‚ç”¨äºä¸éœ€è¦ä¿è¯åŸå­æ€§ï¼Œä½†å´éœ€è¦ä¿è¯å¯è§æ€§çš„åœºæ™¯ã€‚ä¸€ç§å…¸å‹çš„ä½¿ç”¨åœºæ™¯æ˜¯ç”¨å®ƒä¿®é¥°ç”¨äºåœæ­¢çº¿ç¨‹çš„çŠ¶æ€æ ‡è®°ã€‚å¦‚ä¸‹æ‰€ç¤º&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isRunning&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isRunning&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;someOperation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;stop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;isRunning&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;åœ¨è¿™ç§å®ç°æ–¹å¼ä¸‹ï¼Œå³ä½¿å…¶å®ƒçº¿ç¨‹é€šè¿‡è°ƒç”¨stop()æ–¹æ³•å°†isRunningè®¾ç½®ä¸ºfalseï¼Œå¾ªç¯ä¹Ÿä¸ä¸€å®šä¼šç«‹å³ç»“æŸã€‚å¯ä»¥é€šè¿‡volatileå…³é”®å­—ï¼Œä¿è¯whileå¾ªç¯åŠæ—¶å¾—åˆ°isRunningæœ€æ–°çš„çŠ¶æ€ä»è€ŒåŠæ—¶åœæ­¢å¾ªç¯ï¼Œç»“æŸçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&quot;é¢è¯•é¢˜&quot;&gt;é¢è¯•é¢˜&lt;/h3&gt;
&lt;h4 id=&quot;çº¿ç¨‹å®‰å…¨åä¸‡ä¸ªä¸ºä»€ä¹ˆ&quot;&gt;çº¿ç¨‹å®‰å…¨åä¸‡ä¸ªä¸ºä»€ä¹ˆ&lt;/h4&gt;
&lt;p&gt;é—®ï¼šå¹³æ—¶é¡¹ç›®ä¸­ä½¿ç”¨é”å’Œsynchronizedæ¯”è¾ƒå¤šï¼Œè€Œå¾ˆå°‘ä½¿ç”¨volatileï¼Œéš¾é“å°±æ²¡æœ‰ä¿è¯å¯è§æ€§ï¼Ÿ  &lt;br /&gt;
ç­”ï¼šé”å’Œsynchronizedå³å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯å¯è§æ€§ã€‚éƒ½æ˜¯é€šè¿‡ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç›®æ ‡ä»£ç æ®µæ¥å®ç°çš„ã€‚&lt;/p&gt;

&lt;p&gt;é—®ï¼šé”å’Œsynchronizedä¸ºä½•èƒ½ä¿è¯å¯è§æ€§ï¼Ÿ   &lt;br /&gt;
ç­”ï¼šæ ¹æ®JDK 7çš„Java docä¸­å¯¹concurrentåŒ…çš„è¯´æ˜ï¼Œä¸€ä¸ªçº¿ç¨‹çš„å†™ç»“æœä¿è¯å¯¹å¦å¤–çº¿ç¨‹çš„è¯»æ“ä½œå¯è§ï¼Œåªè¦è¯¥å†™æ“ä½œå¯ä»¥ç”±happen-beforeåŸåˆ™æ¨æ–­å‡ºåœ¨è¯»æ“ä½œä¹‹å‰å‘ç”Ÿã€‚&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The results of a write by one thread are guaranteed to be visible to a read by another thread only if the write operation happens-before the read operation. The synchronized and volatile constructs, as well as the Thread.start() and Thread.join() methods, can form happens-before relationships.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;é—®ï¼šæ—¢ç„¶é”å’Œsynchronizedå³å¯ä¿è¯åŸå­æ€§ä¹Ÿå¯ä¿è¯å¯è§æ€§ï¼Œä¸ºä½•è¿˜éœ€è¦volatileï¼Ÿ&lt;/p&gt;

&lt;p&gt;ç­”ï¼šsynchronizedå’Œé”éœ€è¦é€šè¿‡æ“ä½œç³»ç»Ÿæ¥ä»²è£è°è·å¾—é”ï¼Œå¼€é”€æ¯”è¾ƒé«˜ï¼Œè€Œvolatileå¼€é”€å°å¾ˆå¤šã€‚å› æ­¤åœ¨åªéœ€è¦ä¿è¯å¯è§æ€§çš„æ¡ä»¶ä¸‹ï¼Œä½¿ç”¨volatileçš„æ€§èƒ½è¦æ¯”ä½¿ç”¨é”å’Œsynchronizedé«˜å¾—å¤šã€‚&lt;/p&gt;

&lt;p&gt;é—®ï¼šæ—¢ç„¶é”å’Œsynchronizedå¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦AtomicIntegerè¿™ç§çš„ç±»æ¥ä¿è¯åŸå­æ“ä½œï¼Ÿ&lt;/p&gt;

&lt;p&gt;ç­”ï¼šé”å’Œsynchronizedéœ€è¦é€šè¿‡æ“ä½œç³»ç»Ÿæ¥ä»²è£è°è·å¾—é”ï¼Œå¼€é”€æ¯”è¾ƒé«˜ï¼Œè€ŒAtomicIntegeræ˜¯é€šè¿‡CPUçº§çš„CASæ“ä½œæ¥ä¿è¯åŸå­æ€§ï¼Œå¼€é”€æ¯”è¾ƒå°ã€‚æ‰€ä»¥ä½¿ç”¨AtomicIntegerçš„ç›®çš„è¿˜æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;é—®ï¼šè¿˜æœ‰æ²¡æœ‰åˆ«çš„åŠæ³•ä¿è¯çº¿ç¨‹å®‰å…¨&lt;/p&gt;

&lt;p&gt;ç­”ï¼šæœ‰ã€‚å°½å¯èƒ½é¿å…å¼•èµ·éçº¿ç¨‹å®‰å…¨çš„æ¡ä»¶â€”â€”å…±äº«å˜é‡ã€‚å¦‚æœèƒ½ä»è®¾è®¡ä¸Šé¿å…å…±äº«å˜é‡çš„ä½¿ç”¨ï¼Œå³å¯é¿å…éçº¿ç¨‹å®‰å…¨çš„å‘ç”Ÿï¼Œä¹Ÿå°±æ— é¡»é€šè¿‡é”æˆ–è€…synchronizedä»¥åŠvolatileè§£å†³åŸå­æ€§ã€å¯è§æ€§å’Œé¡ºåºæ€§çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;é—®ï¼šsynchronizedå³å¯ä¿®é¥°éé™æ€æ–¹å¼ï¼Œä¹Ÿå¯ä¿®é¥°é™æ€æ–¹æ³•ï¼Œè¿˜å¯ä¿®é¥°ä»£ç å—ï¼Œæœ‰ä½•åŒºåˆ«&lt;/p&gt;

&lt;p&gt;ç­”ï¼šsynchronizedä¿®é¥°éé™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯å½“å‰å®ä¾‹ï¼›synchronizedä¿®é¥°é™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯è¯¥ç±»çš„Classå¯¹è±¡ï¼›synchronizedä¿®é¥°é™æ€ä»£ç å—æ—¶ï¼Œé”ä½çš„æ˜¯synchronizedå…³é”®å­—åé¢æ‹¬å·å†…çš„å¯¹è±¡ã€‚&lt;/p&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="jvm" /><summary type="html">å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ åŸå­æ€§ è¿™ä¸€ç‚¹ï¼Œè·Ÿæ•°æ®åº“äº‹åŠ¡çš„åŸå­æ€§æ¦‚å¿µå·®ä¸å¤šï¼Œå³ä¸€ä¸ªæ“ä½œï¼ˆæœ‰å¯èƒ½åŒ…å«æœ‰å¤šä¸ªå­æ“ä½œï¼‰è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼ˆç”Ÿæ•ˆï¼‰ï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œï¼ˆéƒ½ä¸ç”Ÿæ•ˆï¼‰ã€‚ å…³äºåŸå­æ€§ï¼Œä¸€ä¸ªéå¸¸ç»å…¸çš„ä¾‹å­å°±æ˜¯é“¶è¡Œè½¬è´¦é—®é¢˜ï¼šæ¯”å¦‚Aå’ŒBåŒæ—¶å‘Cè½¬è´¦10ä¸‡å…ƒã€‚å¦‚æœè½¬è´¦æ“ä½œä¸å…·æœ‰åŸå­æ€§ï¼ŒAåœ¨å‘Cè½¬è´¦æ—¶ï¼Œè¯»å–äº†Cçš„ä½™é¢ä¸º20ä¸‡ï¼Œç„¶ååŠ ä¸Šè½¬è´¦çš„10ä¸‡ï¼Œè®¡ç®—å‡ºæ­¤æ—¶åº”è¯¥æœ‰30ä¸‡ï¼Œä½†è¿˜æœªæ¥åŠå°†30ä¸‡å†™å›Cçš„è´¦æˆ·ï¼Œæ­¤æ—¶Bçš„è½¬è´¦è¯·æ±‚è¿‡æ¥äº†ï¼ŒBå‘ç°Cçš„ä½™é¢ä¸º20ä¸‡ï¼Œç„¶åå°†å…¶åŠ 10ä¸‡å¹¶å†™å›ã€‚ç„¶åAçš„è½¬è´¦æ“ä½œç»§ç»­â€”â€”å°†30ä¸‡å†™å›Cçš„ä½™é¢ã€‚è¿™ç§æƒ…å†µä¸‹Cçš„æœ€ç»ˆä½™é¢ä¸º30ä¸‡ï¼Œè€Œéé¢„æœŸçš„40ä¸‡ã€‚ å¯è§æ€§(ç»ˆç‚¹ï¼Œè¿™é‡Œèƒ½è¯´æ˜ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•°æ®ä¼šè¢«ä¸²æ”¹) å¯è§æ€§æ˜¯æŒ‡ï¼Œå½“å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«å˜é‡æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹åˆ°ã€‚å¯è§æ€§é—®é¢˜æ˜¯å¥½å¤šäººå¿½ç•¥æˆ–è€…ç†è§£é”™è¯¯çš„ä¸€ç‚¹ã€‚ CPUä»ä¸»å†…å­˜ä¸­è¯»æ•°æ®çš„æ•ˆç‡ç›¸å¯¹æ¥è¯´ä¸é«˜ï¼Œç°åœ¨ä¸»æµçš„è®¡ç®—æœºä¸­ï¼Œéƒ½æœ‰å‡ çº§ç¼“å­˜ã€‚æ¯ä¸ªçº¿ç¨‹è¯»å–å…±äº«å˜é‡æ—¶ï¼Œéƒ½ä¼šå°†è¯¥å˜é‡åŠ è½½è¿›å…¶å¯¹åº”CPUçš„é«˜é€Ÿç¼“å­˜é‡Œï¼Œä¿®æ”¹è¯¥å˜é‡åï¼ŒCPUä¼šç«‹å³æ›´æ–°è¯¥ç¼“å­˜ï¼Œä½†å¹¶ä¸ä¸€å®šä¼šç«‹å³å°†å…¶å†™å›ä¸»å†…å­˜ï¼ˆå®é™…ä¸Šå†™å›ä¸»å†…å­˜çš„æ—¶é—´ä¸å¯é¢„æœŸï¼‰ã€‚æ­¤æ—¶å…¶å®ƒçº¿ç¨‹ï¼ˆå°¤å…¶æ˜¯ä¸åœ¨åŒä¸€ä¸ªCPUä¸Šæ‰§è¡Œçš„çº¿ç¨‹ï¼‰è®¿é—®è¯¥å˜é‡æ—¶ï¼Œä»ä¸»å†…å­˜ä¸­è¯»åˆ°çš„å°±æ˜¯æ—§çš„æ•°æ®ï¼Œè€Œéç¬¬ä¸€ä¸ªçº¿ç¨‹æ›´æ–°åçš„æ•°æ®ã€‚ è¿™ä¸€ç‚¹æ˜¯æ“ä½œç³»ç»Ÿæˆ–è€…è¯´æ˜¯ç¡¬ä»¶å±‚é¢çš„æœºåˆ¶ï¼Œæ‰€ä»¥å¾ˆå¤šåº”ç”¨å¼€å‘äººå‘˜ç»å¸¸ä¼šå¿½ç•¥ã€‚ é¡ºåºæ€§ é¡ºåºæ€§æŒ‡çš„æ˜¯ï¼Œç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ ä»¥ä¸‹é¢è¿™æ®µä»£ç ä¸ºä¾‹ boolean started = false; // è¯­å¥1 long counter = 0L; // è¯­å¥2 counter = 1; // è¯­å¥3 started = true; // è¯­å¥4 ä»ä»£ç é¡ºåºä¸Šçœ‹ï¼Œä¸Šé¢å››æ¡è¯­å¥åº”è¯¥ä¾æ¬¡æ‰§è¡Œï¼Œä½†å®é™…ä¸ŠJVMçœŸæ­£åœ¨æ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå¹¶ä¸ä¿è¯å®ƒä»¬ä¸€å®šå®Œå…¨æŒ‰ç…§æ­¤é¡ºåºæ‰§è¡Œã€‚ å¤„ç†å™¨ä¸ºäº†æé«˜ç¨‹åºæ•´ä½“çš„æ‰§è¡Œæ•ˆç‡ï¼Œå¯èƒ½ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œå…¶ä¸­çš„ä¸€é¡¹ä¼˜åŒ–æ–¹å¼å°±æ˜¯è°ƒæ•´ä»£ç é¡ºåºï¼ŒæŒ‰ç…§æ›´é«˜æ•ˆçš„é¡ºåºæ‰§è¡Œä»£ç ã€‚ è®²åˆ°è¿™é‡Œï¼Œæœ‰äººè¦ç€æ€¥äº†â€”â€”ä»€ä¹ˆï¼ŒCPUä¸æŒ‰ç…§æˆ‘çš„ä»£ç é¡ºåºæ‰§è¡Œä»£ç ï¼Œé‚£æ€ä¹ˆä¿è¯å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœå‘¢ï¼Ÿå®é™…ä¸Šï¼Œå¤§å®¶å¤§å¯æ”¾å¿ƒï¼ŒCPUè™½ç„¶å¹¶ä¸ä¿è¯å®Œå…¨æŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œï¼Œä½†å®ƒä¼šä¿è¯ç¨‹åºæœ€ç»ˆçš„æ‰§è¡Œç»“æœå’Œä»£ç é¡ºåºæ‰§è¡Œæ—¶çš„ç»“æœä¸€è‡´ã€‚ Javaå¦‚ä½•è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜ Javaå¦‚ä½•ä¿è¯åŸå­æ€§ é”å’ŒåŒæ­¥ å¸¸ç”¨çš„ä¿è¯Javaæ“ä½œåŸå­æ€§çš„å·¥å…·æ˜¯é”å’ŒåŒæ­¥æ–¹æ³•ï¼ˆæˆ–è€…åŒæ­¥ä»£ç å—ï¼‰ã€‚ä½¿ç”¨é”ï¼Œå¯ä»¥ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‹¿åˆ°é”ï¼Œä¹Ÿå°±ä¿è¯äº†åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œç”³è¯·é”å’Œé‡Šæ”¾é”ä¹‹é—´çš„ä»£ç ã€‚ public void testLock () { lock.lock(); try{ int j = i; i = j + 1; } finally { lock.unlock(); } } ä¸é”ç±»ä¼¼çš„æ˜¯åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥ä»£ç å—ã€‚ä½¿ç”¨éé™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯å½“å‰å®ä¾‹ï¼›ä½¿ç”¨é™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯è¯¥ç±»çš„Classå¯¹è±¡ï¼›ä½¿ç”¨é™æ€ä»£ç å—æ—¶ï¼Œé”ä½çš„æ˜¯synchronizedå…³é”®å­—åé¢æ‹¬å·å†…çš„å¯¹è±¡ã€‚ä¸‹é¢æ˜¯åŒæ­¥ä»£ç å—ç¤ºä¾‹ public void testLock () { synchronized (anyObject){ int j = i; i = j + 1; } } æ— è®ºä½¿ç”¨é”è¿˜æ˜¯synchronizedï¼Œæœ¬è´¨éƒ½æ˜¯ä¸€æ ·ï¼Œé€šè¿‡é”æ¥å®ç°èµ„æºçš„æ’å®ƒæ€§ï¼Œä»è€Œå®é™…ç›®æ ‡ä»£ç æ®µåŒä¸€æ—¶é—´åªä¼šè¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œè¿›è€Œä¿è¯äº†ç›®æ ‡ä»£ç æ®µçš„åŸå­æ€§ã€‚è¿™æ˜¯ä¸€ç§ä»¥ç‰ºç‰²æ€§èƒ½ä¸ºä»£ä»·çš„æ–¹æ³•ã€‚ CASï¼ˆcompare and swapï¼‰ åŸºç¡€ç±»å‹å˜é‡è‡ªå¢ï¼ˆi++ï¼‰æ˜¯ä¸€ç§å¸¸è¢«æ–°æ‰‹è¯¯ä»¥ä¸ºæ˜¯åŸå­æ“ä½œè€Œå®é™…ä¸æ˜¯çš„æ“ä½œã€‚Javaä¸­æä¾›äº†å¯¹åº”çš„åŸå­æ“ä½œç±»æ¥å®ç°è¯¥æ“ä½œï¼Œå¹¶ä¿è¯åŸå­æ€§ï¼Œå…¶æœ¬è´¨æ˜¯åˆ©ç”¨äº†CPUçº§åˆ«çš„CASæŒ‡ä»¤ã€‚ç”±äºæ˜¯CPUçº§åˆ«çš„æŒ‡ä»¤ï¼Œå…¶å¼€é”€æ¯”éœ€è¦æ“ä½œç³»ç»Ÿå‚ä¸çš„é”çš„å¼€é”€å°ã€‚AtomicIntegerä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ã€‚ AtomicInteger atomicInteger = new AtomicInteger(); for(int b = 0; b &amp;lt; numThreads; b++) { new Thread(() -&amp;gt; { for(int a = 0; a &amp;lt; iteration; a++) { atomicInteger.incrementAndGet(); } }).start(); } Javaå¦‚ä½•ä¿è¯å¯è§æ€§ Javaæä¾›äº†volatileå…³é”®å­—æ¥ä¿è¯å¯è§æ€§ã€‚å½“ä½¿ç”¨volatileä¿®é¥°æŸä¸ªå˜é‡æ—¶ï¼Œå®ƒä¼šä¿è¯å¯¹è¯¥å˜é‡çš„ä¿®æ”¹ä¼šç«‹å³è¢«æ›´æ–°åˆ°å†…å­˜ä¸­ï¼Œå¹¶ä¸”å°†å…¶å®ƒç¼“å­˜ä¸­å¯¹è¯¥å˜é‡çš„ç¼“å­˜è®¾ç½®æˆæ— æ•ˆï¼Œå› æ­¤å…¶å®ƒçº¿ç¨‹éœ€è¦è¯»å–è¯¥å€¼æ—¶å¿…é¡»ä»ä¸»å†…å­˜ä¸­è¯»å–ï¼Œä»è€Œå¾—åˆ°æœ€æ–°çš„å€¼ã€‚ Javaå¦‚ä½•ä¿è¯é¡ºåºæ€§ ä¸Šæ–‡è®²è¿‡ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ–°æ’åºæ—¶ï¼Œä¼šä¿è¯é‡æ–°æ’åºåçš„æ‰§è¡Œç»“æœå’Œä»£ç é¡ºåºæ‰§è¡Œçš„ç»“æœä¸€è‡´ï¼Œæ‰€ä»¥é‡æ–°æ’åºè¿‡ç¨‹å¹¶ä¸ä¼šå½±å“å•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œï¼Œå´å¯èƒ½å½±å“å¤šçº¿ç¨‹ç¨‹åºå¹¶å‘æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚ Javaä¸­å¯é€šè¿‡volatileåœ¨ä¸€å®šç¨‹åºä¸Šä¿è¯é¡ºåºæ€§ï¼Œå¦å¤–è¿˜å¯ä»¥é€šè¿‡synchronizedå’Œé”æ¥ä¿è¯é¡ºåºæ€§ã€‚ synchronizedå’Œé”ä¿è¯é¡ºåºæ€§çš„åŸç†å’Œä¿è¯åŸå­æ€§ä¸€æ ·ï¼Œéƒ½æ˜¯é€šè¿‡ä¿è¯åŒä¸€æ—¶é—´åªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç›®æ ‡ä»£ç æ®µæ¥å®ç°çš„ã€‚ é™¤äº†ä»åº”ç”¨å±‚é¢ä¿è¯ç›®æ ‡ä»£ç æ®µæ‰§è¡Œçš„é¡ºåºæ€§å¤–ï¼ŒJVMè¿˜é€šè¿‡è¢«ç§°ä¸ºhappens-beforeåŸåˆ™éšå¼åœ°ä¿è¯é¡ºåºæ€§ã€‚ä¸¤ä¸ªæ“ä½œçš„æ‰§è¡Œé¡ºåºåªè¦å¯ä»¥é€šè¿‡happens-beforeæ¨å¯¼å‡ºæ¥ï¼Œåˆ™JVMä¼šä¿è¯å…¶é¡ºåºæ€§ï¼Œåä¹‹JVMå¯¹å…¶é¡ºåºæ€§ä¸ä½œä»»ä½•ä¿è¯ï¼Œå¯å¯¹å…¶è¿›è¡Œä»»æ„å¿…è¦çš„é‡æ–°æ’åºä»¥è·å–é«˜æ•ˆç‡ã€‚ happens-beforeåŸåˆ™ï¼ˆå…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼‰ ä¼ é€’è§„åˆ™ï¼šå¦‚æœæ“ä½œ1åœ¨æ“ä½œ2å‰é¢ï¼Œè€Œæ“ä½œ2åœ¨æ“ä½œ3å‰é¢ï¼Œåˆ™æ“ä½œ1è‚¯å®šä¼šåœ¨æ“ä½œ3å‰å‘ç”Ÿã€‚è¯¥è§„åˆ™è¯´æ˜äº†happens-beforeåŸåˆ™å…·æœ‰ä¼ é€’æ€§ é”å®šè§„åˆ™ï¼šä¸€ä¸ªunlockæ“ä½œè‚¯å®šä¼šåœ¨åé¢å¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œå‰å‘ç”Ÿã€‚è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œé”åªæœ‰è¢«é‡Šæ”¾äº†æ‰ä¼šè¢«å†æ¬¡è·å– volatileå˜é‡è§„åˆ™ï¼šå¯¹ä¸€ä¸ªè¢«volatileä¿®é¥°çš„å†™æ“ä½œå…ˆå‘ç”Ÿäºåé¢å¯¹è¯¥å˜é‡çš„è¯»æ“ä½œ ç¨‹åºæ¬¡åºè§„åˆ™ï¼šä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œ çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼šThreadå¯¹è±¡çš„start()æ–¹æ³•å…ˆå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„å…¶å®ƒåŠ¨ä½œ çº¿ç¨‹ç»ˆç»“åŸåˆ™ï¼šçº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹åå‘ç”Ÿäºçº¿ç¨‹ä¸­å…¶å®ƒçš„æ‰€æœ‰æ“ä½œ çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼š å¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆå‘ç”Ÿäºå¯¹è¯¥ä¸­æ–­å¼‚å¸¸çš„è·å– å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡æ„é€ å…ˆäºå®ƒçš„finalizeå‘ç”Ÿ volatileé€‚ç”¨åœºæ™¯ volatileé€‚ç”¨äºä¸éœ€è¦ä¿è¯åŸå­æ€§ï¼Œä½†å´éœ€è¦ä¿è¯å¯è§æ€§çš„åœºæ™¯ã€‚ä¸€ç§å…¸å‹çš„ä½¿ç”¨åœºæ™¯æ˜¯ç”¨å®ƒä¿®é¥°ç”¨äºåœæ­¢çº¿ç¨‹çš„çŠ¶æ€æ ‡è®°ã€‚å¦‚ä¸‹æ‰€ç¤º boolean isRunning = false; public void start () { new Thread( () -&amp;gt; { while(isRunning) { someOperation(); } }).start(); } public void stop () { isRunning = false; } åœ¨è¿™ç§å®ç°æ–¹å¼ä¸‹ï¼Œå³ä½¿å…¶å®ƒçº¿ç¨‹é€šè¿‡è°ƒç”¨stop()æ–¹æ³•å°†isRunningè®¾ç½®ä¸ºfalseï¼Œå¾ªç¯ä¹Ÿä¸ä¸€å®šä¼šç«‹å³ç»“æŸã€‚å¯ä»¥é€šè¿‡volatileå…³é”®å­—ï¼Œä¿è¯whileå¾ªç¯åŠæ—¶å¾—åˆ°isRunningæœ€æ–°çš„çŠ¶æ€ä»è€ŒåŠæ—¶åœæ­¢å¾ªç¯ï¼Œç»“æŸçº¿ç¨‹ã€‚ é¢è¯•é¢˜ çº¿ç¨‹å®‰å…¨åä¸‡ä¸ªä¸ºä»€ä¹ˆ é—®ï¼šå¹³æ—¶é¡¹ç›®ä¸­ä½¿ç”¨é”å’Œsynchronizedæ¯”è¾ƒå¤šï¼Œè€Œå¾ˆå°‘ä½¿ç”¨volatileï¼Œéš¾é“å°±æ²¡æœ‰ä¿è¯å¯è§æ€§ï¼Ÿ ç­”ï¼šé”å’Œsynchronizedå³å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯å¯è§æ€§ã€‚éƒ½æ˜¯é€šè¿‡ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç›®æ ‡ä»£ç æ®µæ¥å®ç°çš„ã€‚ é—®ï¼šé”å’Œsynchronizedä¸ºä½•èƒ½ä¿è¯å¯è§æ€§ï¼Ÿ ç­”ï¼šæ ¹æ®JDK 7çš„Java docä¸­å¯¹concurrentåŒ…çš„è¯´æ˜ï¼Œä¸€ä¸ªçº¿ç¨‹çš„å†™ç»“æœä¿è¯å¯¹å¦å¤–çº¿ç¨‹çš„è¯»æ“ä½œå¯è§ï¼Œåªè¦è¯¥å†™æ“ä½œå¯ä»¥ç”±happen-beforeåŸåˆ™æ¨æ–­å‡ºåœ¨è¯»æ“ä½œä¹‹å‰å‘ç”Ÿã€‚ The results of a write by one thread are guaranteed to be visible to a read by another thread only if the write operation happens-before the read operation. The synchronized and volatile constructs, as well as the Thread.start() and Thread.join() methods, can form happens-before relationships. é—®ï¼šæ—¢ç„¶é”å’Œsynchronizedå³å¯ä¿è¯åŸå­æ€§ä¹Ÿå¯ä¿è¯å¯è§æ€§ï¼Œä¸ºä½•è¿˜éœ€è¦volatileï¼Ÿ ç­”ï¼šsynchronizedå’Œé”éœ€è¦é€šè¿‡æ“ä½œç³»ç»Ÿæ¥ä»²è£è°è·å¾—é”ï¼Œå¼€é”€æ¯”è¾ƒé«˜ï¼Œè€Œvolatileå¼€é”€å°å¾ˆå¤šã€‚å› æ­¤åœ¨åªéœ€è¦ä¿è¯å¯è§æ€§çš„æ¡ä»¶ä¸‹ï¼Œä½¿ç”¨volatileçš„æ€§èƒ½è¦æ¯”ä½¿ç”¨é”å’Œsynchronizedé«˜å¾—å¤šã€‚ é—®ï¼šæ—¢ç„¶é”å’Œsynchronizedå¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦AtomicIntegerè¿™ç§çš„ç±»æ¥ä¿è¯åŸå­æ“ä½œï¼Ÿ ç­”ï¼šé”å’Œsynchronizedéœ€è¦é€šè¿‡æ“ä½œç³»ç»Ÿæ¥ä»²è£è°è·å¾—é”ï¼Œå¼€é”€æ¯”è¾ƒé«˜ï¼Œè€ŒAtomicIntegeræ˜¯é€šè¿‡CPUçº§çš„CASæ“ä½œæ¥ä¿è¯åŸå­æ€§ï¼Œå¼€é”€æ¯”è¾ƒå°ã€‚æ‰€ä»¥ä½¿ç”¨AtomicIntegerçš„ç›®çš„è¿˜æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ã€‚ é—®ï¼šè¿˜æœ‰æ²¡æœ‰åˆ«çš„åŠæ³•ä¿è¯çº¿ç¨‹å®‰å…¨ ç­”ï¼šæœ‰ã€‚å°½å¯èƒ½é¿å…å¼•èµ·éçº¿ç¨‹å®‰å…¨çš„æ¡ä»¶â€”â€”å…±äº«å˜é‡ã€‚å¦‚æœèƒ½ä»è®¾è®¡ä¸Šé¿å…å…±äº«å˜é‡çš„ä½¿ç”¨ï¼Œå³å¯é¿å…éçº¿ç¨‹å®‰å…¨çš„å‘ç”Ÿï¼Œä¹Ÿå°±æ— é¡»é€šè¿‡é”æˆ–è€…synchronizedä»¥åŠvolatileè§£å†³åŸå­æ€§ã€å¯è§æ€§å’Œé¡ºåºæ€§çš„é—®é¢˜ã€‚ é—®ï¼šsynchronizedå³å¯ä¿®é¥°éé™æ€æ–¹å¼ï¼Œä¹Ÿå¯ä¿®é¥°é™æ€æ–¹æ³•ï¼Œè¿˜å¯ä¿®é¥°ä»£ç å—ï¼Œæœ‰ä½•åŒºåˆ« ç­”ï¼šsynchronizedä¿®é¥°éé™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯å½“å‰å®ä¾‹ï¼›synchronizedä¿®é¥°é™æ€åŒæ­¥æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯è¯¥ç±»çš„Classå¯¹è±¡ï¼›synchronizedä¿®é¥°é™æ€ä»£ç å—æ—¶ï¼Œé”ä½çš„æ˜¯synchronizedå…³é”®å­—åé¢æ‹¬å·å†…çš„å¯¹è±¡ã€‚</summary></entry><entry><title type="html">35. æœç´¢æ’å…¥ä½ç½®</title><link href="http://localhost:4000/leetcode/2020/0620/001" rel="alternate" type="text/html" title="35. æœç´¢æ’å…¥ä½ç½®" /><published>2020-06-20T00:00:00+08:00</published><updated>2020-06-20T00:00:00+08:00</updated><id>http://localhost:4000/leetcode/2020/0620/35.%20%E6%90%9C%E7%B4%A2%E6%8F%92%E5%85%A5%E4%BD%8D%E7%BD%AE</id><content type="html" xml:base="http://localhost:4000/leetcode/2020/0620/001">&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;éš¾åº¦&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext success highlighter-rouge&quot;&gt;ç®€å•&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æœ¬é¢˜æ¶‰åŠç®—æ³•&lt;/strong&gt;ï¼š&lt;code class=&quot;language-plaintext success highlighter-rouge&quot;&gt;äºŒåˆ†æŸ¥æ‰¾&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ€è·¯&lt;/strong&gt;ï¼š   &lt;code class=&quot;language-plaintext info highlighter-rouge&quot;&gt;äºŒåˆ†æŸ¥æ‰¾&lt;/code&gt; &lt;code class=&quot;language-plaintext info highlighter-rouge&quot;&gt;æš´åŠ›&lt;/code&gt;   &lt;code class=&quot;language-plaintext info highlighter-rouge&quot;&gt;ç›®æ ‡å€¼æ’å…¥æ•°ç»„&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç±»ä¼¼é¢˜å‹&lt;/strong&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;é¢˜ç›®-35-æœç´¢æ’å…¥ä½ç½®&quot;&gt;é¢˜ç›® &lt;a href=&quot;https://leetcode-cn.com/problems/search-insert-position/&quot;&gt;35. æœç´¢æ’å…¥ä½ç½®&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­æ— é‡å¤å…ƒç´ ã€‚&lt;/p&gt;

&lt;h4 id=&quot;ç¤ºä¾‹-1&quot;&gt;ç¤ºä¾‹ 1:&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;è¾“å…¥: [1,3,5,6], 5
è¾“å‡º: 2
ç¤ºä¾‹Â 2:

è¾“å…¥: [1,3,5,6], 2
è¾“å‡º: 1
ç¤ºä¾‹ 3:

è¾“å…¥: [1,3,5,6], 7
è¾“å‡º: 4
ç¤ºä¾‹ 4:

è¾“å…¥: [1,3,5,6], 0
è¾“å‡º: 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ–¹æ³•ä¸€-äºŒåˆ†æŸ¥æ‰¾&quot;&gt;æ–¹æ³•ä¸€ äºŒåˆ†æŸ¥æ‰¾&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¤æ‚åº¦åˆ†æ&lt;/strong&gt;ï¼š
    &lt;ul&gt;
      &lt;li&gt;æ—¶é—´å¤æ‚åº¦ $O(logN)))$ ï¼Œè¿™é‡Œ $N$   æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œæ¯ä¸€æ¬¡éƒ½å°†é—®é¢˜çš„è§„æ¨¡ç¼©å‡ä¸ºåŸæ¥çš„ä¸€åŠï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯å¯¹æ•°çº§åˆ«çš„&lt;/li&gt;
      &lt;li&gt;ç©ºé—´å¤æ‚åº¦ $O(1)$
        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;searchInsert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
  :type nums: List[int]
  :type target: int
  :rtype: int
  &quot;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;mid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mid&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;æ–¹æ³•äºŒ-æš´åŠ›éå†&quot;&gt;æ–¹æ³•äºŒ æš´åŠ›éå†&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¤æ‚åº¦åˆ†æ&lt;/strong&gt;ï¼š
    &lt;ul&gt;
      &lt;li&gt;æ—¶é—´å¤æ‚åº¦ $O(logN)))$ ï¼Œè¿™é‡Œ $N$   æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œæœ€å·®æƒ…å†µä¸‹éå† ç›®æ ‡å€¼&amp;gt;æ•°ç»„æœ€åä¸€ä¸ªå€¼&lt;/li&gt;
      &lt;li&gt;ç©ºé—´å¤æ‚åº¦ $O(1)$
        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;searchInsert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
        &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;searchInsert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
        &lt;h3 id=&quot;æ–¹æ³•ä¸‰-ç›®æ ‡å€¼æ’å…¥æ•°ç»„ååœ¨æŸ¥æ‰¾å¯¹äºä½ç½®æä¾›äº†ä¸€ä¸ªæ–°æ€è·¯&quot;&gt;æ–¹æ³•ä¸‰ ç›®æ ‡å€¼æ’å…¥æ•°ç»„ååœ¨æŸ¥æ‰¾å¯¹äºä½ç½®ï¼ˆæä¾›äº†ä¸€ä¸ªæ–°æ€è·¯ï¼‰&lt;/h3&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è§£é¢˜æ€è·¯&lt;/strong&gt;ï¼š
    &lt;ul&gt;
      &lt;li&gt;ç›®æ ‡å€¼æ’å…¥æ•°ç»„ä¸­&lt;/li&gt;
      &lt;li&gt;æ’åºååœ¨æŸ¥è¯¢å¯¹äºç›®æ ‡å€¼çš„ä½ç½®&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¤æ‚åº¦åˆ†æ&lt;/strong&gt;ï¼š
    &lt;ul&gt;
      &lt;li&gt;æ—¶é—´å¤æ‚åº¦ $O(logN)))$ ï¼Œè¿™é‡Œ $N$   æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œæœ€å·®æƒ…å†µä¸‹éå† ç›®æ ‡å€¼&amp;gt;æ•°ç»„æœ€åä¸€ä¸ªå€¼&lt;/li&gt;
      &lt;li&gt;ç©ºé—´å¤æ‚åº¦ $O(1)$&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;searchInsert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# ä¸ç®¡è¿™ä¸ªæ•°åœ¨ä¸åœ¨é‡Œé¢ï¼Œç›´æ¥append
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# ç„¶åå†æ’åº
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# æœ€åè¿”å›æŸ¥æ‰¾çš„index
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nums&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å¦‚æœä½ ä¹Ÿå‘ç°äº†ï¼Œè¯·ä¸ºè‡ªå·±ç‚¹èµï¼Œé¡ºä¾¿ä¸ºå°ç‰›ç‚¹èµğŸ‘æ”¯æŒ&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¦‚æœå‘ç°åœ¨åˆ«å¤„ä¹Ÿæœ‰ç±»ä¼¼çš„ä¾‹é¢˜ï¼Œè¯·åœ¨ä¸‹é¢ğŸ‘‡è¯„è®ºåŒºå‘Šè¯‰å°ç‰›&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="leetcode" /><summary type="html">éš¾åº¦ï¼šç®€å• æœ¬é¢˜æ¶‰åŠç®—æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾ æ€è·¯ï¼š äºŒåˆ†æŸ¥æ‰¾ æš´åŠ› ç›®æ ‡å€¼æ’å…¥æ•°ç»„ ç±»ä¼¼é¢˜å‹: é¢˜ç›® 35. æœç´¢æ’å…¥ä½ç½® ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚ ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­æ— é‡å¤å…ƒç´ ã€‚ ç¤ºä¾‹ 1: è¾“å…¥: [1,3,5,6], 5 è¾“å‡º: 2 ç¤ºä¾‹Â 2: è¾“å…¥: [1,3,5,6], 2 è¾“å‡º: 1 ç¤ºä¾‹ 3: è¾“å…¥: [1,3,5,6], 7 è¾“å‡º: 4 ç¤ºä¾‹ 4: è¾“å…¥: [1,3,5,6], 0 è¾“å‡º: 0 æ–¹æ³•ä¸€ äºŒåˆ†æŸ¥æ‰¾ å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ $O(logN)))$ ï¼Œè¿™é‡Œ $N$ æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œæ¯ä¸€æ¬¡éƒ½å°†é—®é¢˜çš„è§„æ¨¡ç¼©å‡ä¸ºåŸæ¥çš„ä¸€åŠï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯å¯¹æ•°çº§åˆ«çš„ ç©ºé—´å¤æ‚åº¦ $O(1)$ class Solution(object): def searchInsert(self, nums, target): &quot;&quot;&quot; :type nums: List[int] :type target: int :rtype: int &quot;&quot;&quot; left , right = 0, len(nums) while left &amp;lt; right: mid = left + (right - left)/2 if nums[mid] &amp;lt; target: left = mid + 1 else: right = mid return left æ–¹æ³•äºŒ æš´åŠ›éå† å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ $O(logN)))$ ï¼Œè¿™é‡Œ $N$ æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œæœ€å·®æƒ…å†µä¸‹éå† ç›®æ ‡å€¼&amp;gt;æ•°ç»„æœ€åä¸€ä¸ªå€¼ ç©ºé—´å¤æ‚åº¦ $O(1)$ class Solution: def searchInsert(self, nums: List[int], target: int) -&amp;gt; int: if not nums: return 0 if nums[-1] &amp;lt; target: return len(nums) for i in range(len(nums)): if nums[i] &amp;gt;= target: return i class Solution { public int searchInsert(int[] nums, int target) { int len = nums.length; int ans = 0; if (len == 0){ return 0; } if (nums[len-1] &amp;lt; target) { return len; } for (int i = 0;i&amp;lt;len;i++) { if (nums[i] &amp;gt;= target) { ans = i; break; } } return ans; } } æ–¹æ³•ä¸‰ ç›®æ ‡å€¼æ’å…¥æ•°ç»„ååœ¨æŸ¥æ‰¾å¯¹äºä½ç½®ï¼ˆæä¾›äº†ä¸€ä¸ªæ–°æ€è·¯ï¼‰ è§£é¢˜æ€è·¯ï¼š ç›®æ ‡å€¼æ’å…¥æ•°ç»„ä¸­ æ’åºååœ¨æŸ¥è¯¢å¯¹äºç›®æ ‡å€¼çš„ä½ç½® å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ $O(logN)))$ ï¼Œè¿™é‡Œ $N$ æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œæœ€å·®æƒ…å†µä¸‹éå† ç›®æ ‡å€¼&amp;gt;æ•°ç»„æœ€åä¸€ä¸ªå€¼ ç©ºé—´å¤æ‚åº¦ $O(1)$ class Solution: def searchInsert(self, nums: List[int], target: int) -&amp;gt; int: # ä¸ç®¡è¿™ä¸ªæ•°åœ¨ä¸åœ¨é‡Œé¢ï¼Œç›´æ¥append nums.append(target) # ç„¶åå†æ’åº nums.sort() # æœ€åè¿”å›æŸ¥æ‰¾çš„index return nums.index(target) å¦‚æœä½ ä¹Ÿå‘ç°äº†ï¼Œè¯·ä¸ºè‡ªå·±ç‚¹èµï¼Œé¡ºä¾¿ä¸ºå°ç‰›ç‚¹èµğŸ‘æ”¯æŒ å¦‚æœå‘ç°åœ¨åˆ«å¤„ä¹Ÿæœ‰ç±»ä¼¼çš„ä¾‹é¢˜ï¼Œè¯·åœ¨ä¸‹é¢ğŸ‘‡è¯„è®ºåŒºå‘Šè¯‰å°ç‰›</summary></entry><entry><title type="html">Springä¸­Beançš„ä½œç”¨åŸŸã€ç”Ÿå‘½å‘¨æœŸ</title><link href="http://localhost:4000/spring/bean" rel="alternate" type="text/html" title="Springä¸­Beançš„ä½œç”¨åŸŸã€ç”Ÿå‘½å‘¨æœŸ" /><published>2020-06-18T00:00:00+08:00</published><updated>2020-06-18T00:00:00+08:00</updated><id>http://localhost:4000/spring/Spring%E4%B8%ADBean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E3%80%81%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F</id><content type="html" xml:base="http://localhost:4000/spring/bean">&lt;h3 id=&quot;beançš„ä½œç”¨åŸŸ&quot;&gt;Beançš„ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ã€€ã€€Spring 3ä¸­ä¸ºBeanå®šä¹‰äº†5ä¸­ä½œç”¨åŸŸï¼Œåˆ†åˆ«ä¸ºsingletonï¼ˆå•ä¾‹ï¼‰ã€prototypeï¼ˆåŸå‹ï¼‰ã€requestã€sessionå’Œglobal sessionï¼Œ5ç§ä½œç”¨åŸŸè¯´æ˜å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;singleton&lt;/strong&gt;ï¼šå•ä¾‹æ¨¡å¼ï¼ŒSpring IoCå®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªå…±äº«çš„Beanå®ä¾‹ï¼Œæ— è®ºæœ‰å¤šå°‘ä¸ªBeanå¼•ç”¨å®ƒï¼Œå§‹ç»ˆæŒ‡å‘åŒä¸€å¯¹è±¡ã€‚Singletonä½œç”¨åŸŸæ˜¯Springä¸­çš„ç¼ºçœä½œç”¨åŸŸï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºçš„å°†Beanå®šä¹‰ä¸ºsingletonæ¨¡å¼ï¼Œé…ç½®ä¸ºï¼š
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;bean id=&quot;userDao&quot; class=&quot;com.ioc.UserDaoImpl&quot; scope=&quot;singleton&quot;/&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;prototype&lt;/strong&gt;:åŸå‹æ¨¡å¼ï¼Œæ¯æ¬¡é€šè¿‡Springå®¹å™¨è·å–prototypeå®šä¹‰çš„beanæ—¶ï¼Œå®¹å™¨éƒ½å°†åˆ›å»ºä¸€ä¸ªæ–°çš„Beanå®ä¾‹ï¼Œæ¯ä¸ªBeanå®ä¾‹éƒ½æœ‰è‡ªå·±çš„å±æ€§å’ŒçŠ¶æ€ï¼Œè€Œsingletonå…¨å±€åªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚æ ¹æ®ç»éªŒï¼Œå¯¹æœ‰çŠ¶æ€çš„beanä½¿ç”¨prototypeä½œç”¨åŸŸï¼Œè€Œå¯¹æ— çŠ¶æ€çš„beanä½¿ç”¨singletonä½œç”¨åŸŸã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;request&lt;/strong&gt;ï¼šåœ¨ä¸€æ¬¡Httpè¯·æ±‚ä¸­ï¼Œå®¹å™¨ä¼šè¿”å›è¯¥Beançš„åŒä¸€å®ä¾‹ã€‚è€Œå¯¹ä¸åŒçš„Httpè¯·æ±‚åˆ™ä¼šäº§ç”Ÿæ–°çš„Beanï¼Œè€Œä¸”è¯¥beanä»…åœ¨å½“å‰Http Requestå†…æœ‰æ•ˆã€‚
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;bean id=&quot;loginAction&quot; class=&quot;com.cnblogs.Login&quot; scope=&quot;request&quot;/&amp;gt;&lt;/code&gt; ï¼Œé’ˆå¯¹æ¯ä¸€æ¬¡Httpè¯·æ±‚ï¼ŒSpringå®¹å™¨æ ¹æ®è¯¥beançš„å®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å®ä¾‹ï¼Œä¸”è¯¥å®ä¾‹ä»…åœ¨å½“å‰Httpè¯·æ±‚å†…æœ‰æ•ˆï¼Œè€Œå…¶å®ƒè¯·æ±‚æ— æ³•çœ‹åˆ°å½“å‰è¯·æ±‚ä¸­çŠ¶æ€çš„å˜åŒ–ï¼Œå½“å½“å‰Httpè¯·æ±‚ç»“æŸï¼Œè¯¥beanå®ä¾‹ä¹Ÿå°†ä¼šè¢«é”€æ¯ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;session&lt;/strong&gt;ï¼šåœ¨ä¸€æ¬¡Http Sessionä¸­ï¼Œå®¹å™¨ä¼šè¿”å›è¯¥Beançš„åŒä¸€å®ä¾‹ã€‚è€Œå¯¹ä¸åŒçš„Sessionè¯·æ±‚åˆ™ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼Œè¯¥beanå®ä¾‹ä»…åœ¨å½“å‰Sessionå†…æœ‰æ•ˆã€‚
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;bean id=&quot;userPreference&quot; class=&quot;com.ioc.UserPreference&quot; scope=&quot;session&quot;/&amp;gt;&lt;/code&gt;ï¼ŒåŒHttpè¯·æ±‚ç›¸åŒï¼Œæ¯ä¸€æ¬¡sessionè¯·æ±‚åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œè€Œä¸åŒçš„å®ä¾‹ä¹‹é—´ä¸å…±äº«å±æ€§ï¼Œä¸”å®ä¾‹ä»…åœ¨è‡ªå·±çš„sessionè¯·æ±‚å†…æœ‰æ•ˆï¼Œè¯·æ±‚ç»“æŸï¼Œåˆ™å®ä¾‹å°†è¢«é”€æ¯ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;global Session&lt;/strong&gt;ï¼šåœ¨ä¸€ä¸ªå…¨å±€çš„Http Sessionä¸­ï¼Œå®¹å™¨ä¼šè¿”å›è¯¥Beançš„åŒä¸€ä¸ªå®ä¾‹ï¼Œä»…åœ¨ä½¿ç”¨portlet contextæ—¶æœ‰æ•ˆã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;beançš„ç”Ÿå‘½å‘¨æœŸ&quot;&gt;Beançš„ç”Ÿå‘½å‘¨æœŸ&lt;/h3&gt;
&lt;p&gt;ã€€ã€€ç»è¿‡å¦‚ä¸Šå¯¹Beanä½œç”¨åŸŸçš„ä»‹ç»ï¼Œæ¥ä¸‹æ¥å°†åœ¨Beanä½œç”¨åŸŸçš„åŸºç¡€ä¸Šè®²è§£Beançš„ç”Ÿå‘½å‘¨æœŸã€‚  &lt;br /&gt;
ã€€ã€€Springå®¹å™¨å¯ä»¥ç®¡ç†singletonä½œç”¨åŸŸä¸‹Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨æ­¤ä½œç”¨åŸŸä¸‹ï¼ŒSpringèƒ½å¤Ÿç²¾ç¡®åœ°çŸ¥é“Beanä½•æ—¶è¢«åˆ›å»ºï¼Œä½•æ—¶åˆå§‹åŒ–å®Œæˆï¼Œä»¥åŠä½•æ—¶è¢«é”€æ¯ã€‚è€Œå¯¹äºprototypeä½œç”¨åŸŸçš„Beanï¼ŒSpringåªè´Ÿè´£åˆ›å»ºï¼Œå½“å®¹å™¨åˆ›å»ºäº†Beançš„å®ä¾‹åï¼ŒBeançš„å®ä¾‹å°±äº¤ç»™äº†å®¢æˆ·ç«¯çš„ä»£ç ç®¡ç†ï¼ŒSpringå®¹å™¨å°†ä¸å†è·Ÿè¸ªå…¶ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”ä¸ä¼šç®¡ç†é‚£äº›è¢«é…ç½®æˆprototypeä½œç”¨åŸŸçš„Beançš„ç”Ÿå‘½å‘¨æœŸã€‚Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œæ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„è¿‡ç¨‹ï¼Œè¯»è€…å¯ä»¥åˆ©ç”¨Springæä¾›çš„æ–¹æ³•æ¥å®šåˆ¶Beançš„åˆ›å»ºè¿‡ç¨‹ã€‚Springå®¹å™¨åœ¨ä¿è¯ä¸€ä¸ªbeanå®ä¾‹èƒ½å¤Ÿä½¿ç”¨ä¹‹å‰ä¼šåšå¾ˆå¤šå·¥ä½œï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/spring/0618/2018110145039276.png&quot; alt=&quot;1&quot; /&gt;
&lt;img src=&quot;/assets/images/spring/0618/2018110145059598.png&quot; alt=&quot;2&quot; /&gt;&lt;/p&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="spring" /><summary type="html">Beançš„ä½œç”¨åŸŸ ã€€ã€€Spring 3ä¸­ä¸ºBeanå®šä¹‰äº†5ä¸­ä½œç”¨åŸŸï¼Œåˆ†åˆ«ä¸ºsingletonï¼ˆå•ä¾‹ï¼‰ã€prototypeï¼ˆåŸå‹ï¼‰ã€requestã€sessionå’Œglobal sessionï¼Œ5ç§ä½œç”¨åŸŸè¯´æ˜å¦‚ä¸‹ï¼š singletonï¼šå•ä¾‹æ¨¡å¼ï¼ŒSpring IoCå®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªå…±äº«çš„Beanå®ä¾‹ï¼Œæ— è®ºæœ‰å¤šå°‘ä¸ªBeanå¼•ç”¨å®ƒï¼Œå§‹ç»ˆæŒ‡å‘åŒä¸€å¯¹è±¡ã€‚Singletonä½œç”¨åŸŸæ˜¯Springä¸­çš„ç¼ºçœä½œç”¨åŸŸï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºçš„å°†Beanå®šä¹‰ä¸ºsingletonæ¨¡å¼ï¼Œé…ç½®ä¸ºï¼š &amp;lt;bean id=&quot;userDao&quot; class=&quot;com.ioc.UserDaoImpl&quot; scope=&quot;singleton&quot;/&amp;gt; prototype:åŸå‹æ¨¡å¼ï¼Œæ¯æ¬¡é€šè¿‡Springå®¹å™¨è·å–prototypeå®šä¹‰çš„beanæ—¶ï¼Œå®¹å™¨éƒ½å°†åˆ›å»ºä¸€ä¸ªæ–°çš„Beanå®ä¾‹ï¼Œæ¯ä¸ªBeanå®ä¾‹éƒ½æœ‰è‡ªå·±çš„å±æ€§å’ŒçŠ¶æ€ï¼Œè€Œsingletonå…¨å±€åªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚æ ¹æ®ç»éªŒï¼Œå¯¹æœ‰çŠ¶æ€çš„beanä½¿ç”¨prototypeä½œç”¨åŸŸï¼Œè€Œå¯¹æ— çŠ¶æ€çš„beanä½¿ç”¨singletonä½œç”¨åŸŸã€‚ requestï¼šåœ¨ä¸€æ¬¡Httpè¯·æ±‚ä¸­ï¼Œå®¹å™¨ä¼šè¿”å›è¯¥Beançš„åŒä¸€å®ä¾‹ã€‚è€Œå¯¹ä¸åŒçš„Httpè¯·æ±‚åˆ™ä¼šäº§ç”Ÿæ–°çš„Beanï¼Œè€Œä¸”è¯¥beanä»…åœ¨å½“å‰Http Requestå†…æœ‰æ•ˆã€‚ &amp;lt;bean id=&quot;loginAction&quot; class=&quot;com.cnblogs.Login&quot; scope=&quot;request&quot;/&amp;gt; ï¼Œé’ˆå¯¹æ¯ä¸€æ¬¡Httpè¯·æ±‚ï¼ŒSpringå®¹å™¨æ ¹æ®è¯¥beançš„å®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å®ä¾‹ï¼Œä¸”è¯¥å®ä¾‹ä»…åœ¨å½“å‰Httpè¯·æ±‚å†…æœ‰æ•ˆï¼Œè€Œå…¶å®ƒè¯·æ±‚æ— æ³•çœ‹åˆ°å½“å‰è¯·æ±‚ä¸­çŠ¶æ€çš„å˜åŒ–ï¼Œå½“å½“å‰Httpè¯·æ±‚ç»“æŸï¼Œè¯¥beanå®ä¾‹ä¹Ÿå°†ä¼šè¢«é”€æ¯ã€‚ sessionï¼šåœ¨ä¸€æ¬¡Http Sessionä¸­ï¼Œå®¹å™¨ä¼šè¿”å›è¯¥Beançš„åŒä¸€å®ä¾‹ã€‚è€Œå¯¹ä¸åŒçš„Sessionè¯·æ±‚åˆ™ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼Œè¯¥beanå®ä¾‹ä»…åœ¨å½“å‰Sessionå†…æœ‰æ•ˆã€‚ &amp;lt;bean id=&quot;userPreference&quot; class=&quot;com.ioc.UserPreference&quot; scope=&quot;session&quot;/&amp;gt;ï¼ŒåŒHttpè¯·æ±‚ç›¸åŒï¼Œæ¯ä¸€æ¬¡sessionè¯·æ±‚åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œè€Œä¸åŒçš„å®ä¾‹ä¹‹é—´ä¸å…±äº«å±æ€§ï¼Œä¸”å®ä¾‹ä»…åœ¨è‡ªå·±çš„sessionè¯·æ±‚å†…æœ‰æ•ˆï¼Œè¯·æ±‚ç»“æŸï¼Œåˆ™å®ä¾‹å°†è¢«é”€æ¯ã€‚ global Sessionï¼šåœ¨ä¸€ä¸ªå…¨å±€çš„Http Sessionä¸­ï¼Œå®¹å™¨ä¼šè¿”å›è¯¥Beançš„åŒä¸€ä¸ªå®ä¾‹ï¼Œä»…åœ¨ä½¿ç”¨portlet contextæ—¶æœ‰æ•ˆã€‚ Beançš„ç”Ÿå‘½å‘¨æœŸ ã€€ã€€ç»è¿‡å¦‚ä¸Šå¯¹Beanä½œç”¨åŸŸçš„ä»‹ç»ï¼Œæ¥ä¸‹æ¥å°†åœ¨Beanä½œç”¨åŸŸçš„åŸºç¡€ä¸Šè®²è§£Beançš„ç”Ÿå‘½å‘¨æœŸã€‚ ã€€ã€€Springå®¹å™¨å¯ä»¥ç®¡ç†singletonä½œç”¨åŸŸä¸‹Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨æ­¤ä½œç”¨åŸŸä¸‹ï¼ŒSpringèƒ½å¤Ÿç²¾ç¡®åœ°çŸ¥é“Beanä½•æ—¶è¢«åˆ›å»ºï¼Œä½•æ—¶åˆå§‹åŒ–å®Œæˆï¼Œä»¥åŠä½•æ—¶è¢«é”€æ¯ã€‚è€Œå¯¹äºprototypeä½œç”¨åŸŸçš„Beanï¼ŒSpringåªè´Ÿè´£åˆ›å»ºï¼Œå½“å®¹å™¨åˆ›å»ºäº†Beançš„å®ä¾‹åï¼ŒBeançš„å®ä¾‹å°±äº¤ç»™äº†å®¢æˆ·ç«¯çš„ä»£ç ç®¡ç†ï¼ŒSpringå®¹å™¨å°†ä¸å†è·Ÿè¸ªå…¶ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”ä¸ä¼šç®¡ç†é‚£äº›è¢«é…ç½®æˆprototypeä½œç”¨åŸŸçš„Beançš„ç”Ÿå‘½å‘¨æœŸã€‚Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œæ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„è¿‡ç¨‹ï¼Œè¯»è€…å¯ä»¥åˆ©ç”¨Springæä¾›çš„æ–¹æ³•æ¥å®šåˆ¶Beançš„åˆ›å»ºè¿‡ç¨‹ã€‚Springå®¹å™¨åœ¨ä¿è¯ä¸€ä¸ªbeanå®ä¾‹èƒ½å¤Ÿä½¿ç”¨ä¹‹å‰ä¼šåšå¾ˆå¤šå·¥ä½œï¼š</summary></entry><entry><title type="html">åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å­—èŠ‚æµã€å­—ç¬¦æµ</title><link href="http://localhost:4000/java/io" rel="alternate" type="text/html" title="åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å­—èŠ‚æµã€å­—ç¬¦æµ" /><published>2020-06-18T00:00:00+08:00</published><updated>2020-06-18T00:00:00+08:00</updated><id>http://localhost:4000/java/%E5%9C%A8%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E5%AD%97%E8%8A%82%E6%B5%81%E3%80%81%E5%AD%97%E7%AC%A6%E6%B5%81</id><content type="html" xml:base="http://localhost:4000/java/io">&lt;h3 id=&quot;æ€»ç»“æ€§é™ˆè¿°&quot;&gt;æ€»ç»“æ€§é™ˆè¿°&lt;/h3&gt;
&lt;h4 id=&quot;å­—èŠ‚æµfileinputstreamå’Œfileoutputstream&quot;&gt;å­—èŠ‚æµï¼ˆFileInputStreamå’ŒFileOutputStreamï¼‰&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;InputStream å’ŒOutputStream,ä¸¤ä¸ªæ˜¯ä¸ºå­—èŠ‚æµè®¾è®¡çš„,ä¸»è¦ç”¨æ¥å¤„ç†å­—èŠ‚æˆ–äºŒè¿›åˆ¶å¯¹è±¡&lt;/li&gt;
  &lt;li&gt;å­—èŠ‚æµå¤„ç†å•å…ƒä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1ä¸ªå­—èŠ‚&lt;/code&gt;ï¼Œæ“ä½œå­—èŠ‚å’Œå­—èŠ‚æ•°ç»„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¦‚æœæ˜¯éŸ³é¢‘æ–‡ä»¶ã€å›¾ç‰‡ã€æ­Œæ›²ï¼Œå°±ç”¨å­—èŠ‚æµå¥½ç‚¹ï¼Œæ‰€ä»¥å®ƒå¯¹å¤šå›½è¯­è¨€æ”¯æŒæ€§æ¯”è¾ƒå¥½ï¼&lt;/strong&gt;
    &lt;h4 id=&quot;å­—ç¬¦æµfilereaderå’Œfilewriter&quot;&gt;å­—ç¬¦æµï¼ˆFileReaderå’ŒFileWriterï¼‰&lt;/h4&gt;
  &lt;/li&gt;
  &lt;li&gt;Readerå’Œ Writer.ä¸¤ä¸ªæ˜¯ä¸ºå­—ç¬¦æµï¼ˆä¸€ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚ï¼‰è®¾è®¡çš„,ä¸»è¦ç”¨æ¥å¤„ç†å­—ç¬¦æˆ–å­—ç¬¦ä¸².&lt;/li&gt;
  &lt;li&gt;å­—ç¬¦æµå¤„ç†çš„å•å…ƒä¸º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2ä¸ªå­—èŠ‚&lt;/code&gt; çš„Unicodeå­—ç¬¦ï¼Œæ“ä½œå­—ç¬¦ã€å­—ç¬¦æ•°ç»„æˆ–å­—ç¬¦ä¸²&lt;/li&gt;
  &lt;li&gt;æ‰€ä»¥å­—ç¬¦æµæ˜¯ç”±Javaè™šæ‹Ÿæœºå°†å­—èŠ‚è½¬åŒ–ä¸º2ä¸ªå­—èŠ‚çš„Unicodeå­—ç¬¦ä¸ºå•ä½çš„å­—ç¬¦è€Œæˆçš„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¦‚æœæ˜¯å…³ç³»åˆ°ä¸­æ–‡ï¼ˆæ–‡æœ¬ï¼‰çš„ï¼Œç”¨å­—ç¬¦æµå¥½ç‚¹&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;ç¼“å†²åŒºçš„ä½¿ç”¨&quot;&gt;ç¼“å†²åŒºçš„ä½¿ç”¨&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;å­—èŠ‚æµåœ¨æ“ä½œæ—¶ä¸ä¼šç”¨åˆ°ç¼“å†²åŒºï¼ˆå†…å­˜ï¼‰ï¼Œæ˜¯ç›´æ¥å¯¹æ–‡ä»¶æœ¬èº«è¿›è¡Œæ“ä½œçš„ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è€Œå­—ç¬¦æµåœ¨æ“ä½œæ—¶ä½¿ç”¨äº†ç¼“å†²åŒºï¼Œé€šè¿‡ç¼“å†²åŒºå†æ“ä½œæ–‡ä»¶ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åœ¨ç¡¬ç›˜ä¸Šçš„æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯ä»¥å­—èŠ‚å½¢å¼å­˜åœ¨çš„ï¼ˆå›¾ç‰‡ï¼Œå£°éŸ³ï¼Œè§†é¢‘ï¼‰ï¼Œè€Œå­—ç¬¦å€¼åœ¨å†…å­˜ä¸­æ‰ä¼šå½¢æˆã€‚ï¼ˆé‡ç‚¹ï¼‰&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;å¢æ·»çŸ¥è¯†ç‚¹&quot;&gt;å¢æ·»çŸ¥è¯†ç‚¹&lt;/h4&gt;
&lt;p&gt;æ–‡ç« é‡ç‚¹ï¼šå­—èŠ‚æµåœ¨æ“ä½œçš„æ—¶å€™æœ¬èº«æ˜¯ä¸ä¼šç”¨åˆ°ç¼“å†²åŒºï¼ˆå†…å­˜ï¼‰çš„ï¼Œæ˜¯ä¸æ–‡ä»¶æœ¬èº«ç›´æ¥æ“ä½œçš„ï¼Œè€Œå­—ç¬¦æµåœ¨æ“ä½œçš„æ—¶å€™æ˜¯ä½¿ç”¨åˆ°ç¼“å†²åŒºçš„ã€‚&lt;/p&gt;

&lt;p&gt;å­—èŠ‚æµåœ¨æ“ä½œæ–‡ä»¶æ—¶ï¼Œå³ä½¿ä¸å…³é—­èµ„æºï¼ˆcloseæ–¹æ³•ï¼‰ï¼Œæ–‡ä»¶ä¹Ÿèƒ½è¾“å‡ºï¼Œä½†æ˜¯å¦‚æœå­—ç¬¦æµä¸ä½¿ç”¨closeæ–¹æ³•çš„è¯ï¼Œåˆ™ä¸ä¼šè¾“å‡ºä»»ä½•å†…å®¹ï¼Œè¯´æ˜å­—ç¬¦æµç”¨çš„æ˜¯ç¼“å†²åŒºï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨flushæ–¹æ³•å¼ºåˆ¶è¿›è¡Œåˆ·æ–°ç¼“å†²åŒºï¼Œè¿™æ—¶æ‰èƒ½åœ¨ä¸closeçš„æƒ…å†µä¸‹è¾“å‡ºå†…å®¹ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯èŠ‚æµæ˜¯æœ€åŸºæœ¬çš„ï¼Œä¸€ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚å°±å¯ä»¥çœ‹å‡ºï¼Œç”šè‡³æºç ä½¿ç”¨å­—ç¬¦æµçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å…ˆè½¬æˆå­—èŠ‚åœ¨å˜æˆå­—ç¬¦ï¼Œæ‰€ä»¥ä½¿ç”¨å­—èŠ‚æµçš„æ“ä½œæ˜¯æœ€å¤šçš„ã€‚&lt;/p&gt;

&lt;h4 id=&quot;ä¸Šé¢ä¸¤ç‚¹èƒ½è¯´æ˜ä»€ä¹ˆå‘¢&quot;&gt;ä¸Šé¢ä¸¤ç‚¹èƒ½è¯´æ˜ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ç¬¬ä¸€ç‚¹ï¼Œæ‰€æœ‰æ–‡ä»¶çš„å‚¨å­˜æ˜¯éƒ½æ˜¯å­—èŠ‚ï¼ˆbyteï¼‰çš„å‚¨å­˜ï¼Œåœ¨ç£ç›˜ä¸Šä¿ç•™çš„å¹¶ä¸æ˜¯æ–‡ä»¶çš„å­—ç¬¦è€Œæ˜¯å…ˆæŠŠå­—ç¬¦ç¼–ç æˆå­—èŠ‚ï¼Œå†å‚¨å­˜è¿™äº›å­—èŠ‚åˆ°ç£ç›˜ã€‚
åœ¨è¯»å–æ–‡ä»¶ï¼ˆç‰¹åˆ«æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼‰æ—¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°è¯»å–ä»¥å½¢æˆå­—èŠ‚åºåˆ—&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç¬¬äºŒç‚¹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé¢‘ç¹å¯¹ä¸€ä¸ªèµ„æºè¿›è¡ŒIOæ“ä½œï¼Œæ•ˆç‡ä¼šéå¸¸ä½ã€‚æ­¤æ—¶ï¼Œé€šè¿‡ç¼“å†²åŒºï¼Œå…ˆæŠŠéœ€è¦æ“ä½œçš„æ•°æ®æš‚æ—¶æ”¾å…¥å†…å­˜ä¸­ï¼Œä»¥åç›´æ¥ä»å†…å­˜ä¸­è¯»å–æ•°æ®ï¼Œåˆ™å¯ä»¥é¿å…å¤šæ¬¡çš„IOæ“ä½œï¼Œæé«˜æ•ˆç‡&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç¬¬ä¸‰ç‚¹ï¼ŒçœŸæ­£å­˜å‚¨å’Œä¼ è¾“æ•°æ®æ—¶éƒ½æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œå­—ç¬¦åªæ˜¯å­˜åœ¨ä¸å†…å­˜å½“ä¸­çš„ï¼Œæ‰€ä»¥ï¼Œ&lt;strong&gt;å­—èŠ‚æµé€‚ç”¨èŒƒå›´æ›´ä¸ºå®½å¹¿&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;æ¦‚å¿µ&quot;&gt;æ¦‚å¿µ&lt;/h3&gt;

&lt;p&gt;åœ¨ç¨‹åºä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥æµçš„æ–¹å¼è¿›è¡Œä¼ è¾“æˆ–ä¿å­˜çš„ï¼Œç¨‹åºéœ€è¦æ•°æ®çš„æ—¶å€™è¦ä½¿ç”¨è¾“å…¥æµè¯»å–æ•°æ®ï¼Œè€Œå½“ç¨‹åºéœ€è¦å°†ä¸€äº›æ•°æ®ä¿å­˜èµ·æ¥çš„æ—¶å€™ï¼Œå°±è¦ä½¿ç”¨è¾“å‡ºæµå®Œæˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ç¨‹åºä¸­çš„è¾“å…¥è¾“å‡ºéƒ½æ˜¯ä»¥æµçš„å½¢å¼ä¿å­˜çš„ï¼Œæµä¸­ä¿å­˜çš„å®é™…ä¸Šå…¨éƒ½æ˜¯å­—èŠ‚æ–‡ä»¶ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id=&quot;å­—èŠ‚æµä¸å­—ç¬¦æµ&quot;&gt;å­—èŠ‚æµä¸å­—ç¬¦æµ&lt;/h4&gt;

&lt;p&gt;åœ¨java.ioåŒ…ä¸­æ“ä½œæ–‡ä»¶å†…å®¹çš„ä¸»è¦æœ‰ä¸¤å¤§ç±»ï¼šå­—èŠ‚æµã€å­—ç¬¦æµï¼Œä¸¤ç±»éƒ½åˆ†ä¸ºè¾“å…¥å’Œè¾“å‡ºæ“ä½œã€‚åœ¨å­—èŠ‚æµä¸­è¾“å‡ºæ•°æ®ä¸»è¦æ˜¯ä½¿ç”¨OutputStreamå®Œæˆï¼Œè¾“å…¥ä½¿çš„æ˜¯InputStreamï¼Œåœ¨å­—ç¬¦æµä¸­è¾“å‡ºä¸»è¦æ˜¯ä½¿ç”¨Writerç±»å®Œæˆï¼Œè¾“å…¥æµä¸»è¦ä½¿ç”¨Readerç±»å®Œæˆã€‚ï¼ˆè¿™å››ä¸ªéƒ½æ˜¯æŠ½è±¡ç±»ï¼‰&lt;/p&gt;

&lt;h4 id=&quot;æ“ä½œæµç¨‹&quot;&gt;æ“ä½œæµç¨‹&lt;/h4&gt;

&lt;p&gt;åœ¨Javaä¸­IOæ“ä½œä¹Ÿæ˜¯æœ‰ç›¸åº”æ­¥éª¤çš„ï¼Œä»¥æ–‡ä»¶æ“ä½œä¸ºä¾‹ï¼Œä¸»è¦çš„æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä½¿ç”¨Fileç±»æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶&lt;/li&gt;
  &lt;li&gt;é€šè¿‡å­—èŠ‚æµæˆ–å­—ç¬¦æµçš„å­ç±»ï¼ŒæŒ‡å®šè¾“å‡ºçš„ä½ç½®&lt;/li&gt;
  &lt;li&gt;è¿›è¡Œè¯»/å†™æ“ä½œ&lt;/li&gt;
  &lt;li&gt;å…³é—­è¾“å…¥/è¾“å‡º&lt;/li&gt;
  &lt;li&gt;IOæ“ä½œå±äºèµ„æºæ“ä½œï¼Œä¸€å®šè¦è®°å¾—å…³é—­&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;å­—èŠ‚æµ&quot;&gt;å­—èŠ‚æµ&lt;/h4&gt;
&lt;p&gt;å­—èŠ‚æµä¸»è¦æ˜¯æ“ä½œbyteç±»å‹æ•°æ®ï¼Œä»¥byteæ•°ç»„ä¸ºå‡†ï¼Œä¸»è¦æ“ä½œç±»å°±æ˜¯OutputStreamã€InputStream&lt;/p&gt;

&lt;h5 id=&quot;å­—èŠ‚è¾“å‡ºæµoutputstream&quot;&gt;å­—èŠ‚è¾“å‡ºæµï¼šOutputStream&lt;/h5&gt;

&lt;p&gt;OutputStreamæ˜¯æ•´ä¸ªIOåŒ…ä¸­å­—èŠ‚è¾“å‡ºæµçš„æœ€å¤§çˆ¶ç±»ï¼Œæ­¤ç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;public abstract class OutputStream extends Object implements Closeable,Flushable&lt;/p&gt;

&lt;p&gt;ä»ä»¥ä¸Šçš„å®šä¹‰å¯ä»¥å‘ç°ï¼Œæ­¤ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨æ­¤ç±»çš„è¯ï¼Œåˆ™é¦–å…ˆå¿…é¡»é€šè¿‡å­ç±»å®ä¾‹åŒ–å¯¹è±¡ï¼Œé‚£ä¹ˆå¦‚æœç°åœ¨è¦æ“ä½œçš„æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ï¼šFileOutputStreamç±»ã€‚é€šè¿‡å‘ä¸Šè½¬å‹ä¹‹åï¼Œå¯ä»¥ä¸ºOutputStreamå®ä¾‹åŒ–&lt;/p&gt;

&lt;p&gt;Closeableè¡¨ç¤ºå¯ä»¥å…³é—­çš„æ“ä½œï¼Œå› ä¸ºç¨‹åºè¿è¡Œåˆ°æœ€åè‚¯å®šè¦å…³é—­&lt;/p&gt;

&lt;p&gt;Flushableï¼šè¡¨ç¤ºåˆ·æ–°ï¼Œæ¸…ç©ºå†…å­˜ä¸­çš„æ•°æ®&lt;/p&gt;

&lt;p&gt;FileOutputStreamç±»çš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;public FileOutputStream(File file)throws FileNotFoundException&lt;/p&gt;

&lt;p&gt;å†™æ•°æ®ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.OutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;OutputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getBytes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//å› ä¸ºæ˜¯å­—èŠ‚æµï¼Œæ‰€ä»¥è¦è½¬åŒ–æˆå­—èŠ‚æ•°ç»„è¿›è¡Œè¾“å‡º&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¿›è¡Œè¾“å‡ºï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.OutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;OutputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getBytes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä»¥ä¸Šè¾“å‡ºåªä¼šè¿›è¡Œè¦†ç›–ï¼Œå¦‚æœè¦è¿½åŠ çš„è¯ï¼Œè¯·çœ‹FileOutputStreamç±»çš„å¦ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼š&lt;/p&gt;

&lt;p&gt;public FileOutputStream(File file,boolean append)throws FileNotFoundException&lt;/p&gt;

&lt;p&gt;åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œå¦‚æœå°†appendçš„å€¼è®¾ç½®ä¸ºtrueï¼Œåˆ™è¡¨ç¤ºåœ¨æ–‡ä»¶çš„æœ«å°¾è¿½åŠ å†…å®¹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.OutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;OutputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//è¿½åŠ å†…å®¹&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\r\nHello World&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getBytes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;æ–‡ä»¶ä¸­æ¢è¡Œä¸ºï¼š\r\n&lt;/p&gt;

&lt;h5 id=&quot;å­—èŠ‚è¾“å…¥æµinputstream&quot;&gt;å­—èŠ‚è¾“å…¥æµï¼šInputStream&lt;/h5&gt;

&lt;p&gt;æ—¢ç„¶ç¨‹åºå¯ä»¥å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œåˆ™å°±å¯ä»¥é€šè¿‡InputStreamä»æ–‡ä»¶ä¸­æŠŠå†…å®¹è¯»å–è¿›æ¥ï¼Œé¦–å…ˆæ¥çœ‹InputStreamç±»çš„å®šä¹‰ï¼š&lt;/p&gt;

&lt;p&gt;public abstract class InputStream extends Object implements Closeable&lt;/p&gt;

&lt;p&gt;ä¸OutputStreamç±»ä¸€æ ·ï¼ŒInputStreamæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¿…é¡»ä¾é å…¶å­ç±»ï¼Œå¦‚æœç°åœ¨æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–ï¼Œå°±ç”¨FileInputStreamæ¥å®ç°ã€‚&lt;/p&gt;

&lt;p&gt;è§‚å¯ŸFileInputStreamç±»çš„æ„é€ æ–¹æ³•ï¼š&lt;/p&gt;

&lt;p&gt;public FileInputStream(File file)throws FileNotFoundException&lt;/p&gt;

&lt;p&gt;è¯»æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.InputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä½†ä»¥ä¸Šæ–¹æ³•æ˜¯æœ‰é—®é¢˜çš„ï¼Œç”¨ä¸ç”¨å¼€è¾Ÿè¿™ä¹ˆå¤§çš„ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œæ˜æ˜¾æ˜¯æµªè´¹å˜›ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ–‡ä»¶çš„å¤§å°æ¥å®šä¹‰å­—èŠ‚æ•°ç»„çš„å¤§å°ï¼ŒFileç±»ä¸­çš„æ–¹æ³•ï¼špublic long length()&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.InputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬æ¢ç§æ–¹å¼ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¯»å…¥~&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.InputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()];&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]=(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä½†ä»¥ä¸Šæƒ…å†µåªé€‚åˆçŸ¥é“è¾“å…¥æ–‡ä»¶çš„å¤§å°ï¼Œä¸çŸ¥é“çš„è¯ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.InputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())!=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//-1ä¸ºæ–‡ä»¶è¯»å®Œçš„æ ‡å¿—&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]=(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;å­—ç¬¦æµ&quot;&gt;å­—ç¬¦æµ&lt;/h4&gt;
&lt;p&gt;åœ¨ç¨‹åºä¸­ä¸€ä¸ªå­—ç¬¦ç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆjavaæä¾›äº†Readerã€Writerä¸¤ä¸ªä¸“é—¨æ“ä½œå­—ç¬¦æµçš„ç±»ã€‚&lt;/p&gt;

&lt;h5 id=&quot;å­—ç¬¦è¾“å‡ºæµwriter&quot;&gt;å­—ç¬¦è¾“å‡ºæµï¼šWriter&lt;/h5&gt;

&lt;p&gt;Writeræœ¬èº«æ˜¯ä¸€ä¸ªå­—ç¬¦æµçš„è¾“å‡ºç±»ï¼Œæ­¤ç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;public abstract class Writer extends Object implements Appendableï¼ŒCloseableï¼ŒFlushable&lt;/p&gt;

&lt;p&gt;æ­¤ç±»æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¦‚æœè¦ä½¿ç”¨æ­¤ç±»ï¼Œåˆ™è‚¯å®šè¦ä½¿ç”¨å…¶å­ç±»ï¼Œæ­¤æ—¶å¦‚æœæ˜¯å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œæ‰€ä»¥åº”è¯¥ä½¿ç”¨FileWriterçš„å­ç±»ã€‚&lt;/p&gt;

&lt;p&gt;FileWriterç±»çš„æ„é€ æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;public FileWriter(File file)throws IOException&lt;/p&gt;

&lt;p&gt;å­—ç¬¦æµçš„æ“ä½œæ¯”å­—èŠ‚æµæ“ä½œå¥½åœ¨ä¸€ç‚¹ï¼Œå°±æ˜¯å¯ä»¥ç›´æ¥è¾“å‡ºå­—ç¬¦ä¸²äº†ï¼Œä¸ç”¨å†åƒä¹‹å‰é‚£æ ·è¿›è¡Œè½¬æ¢æ“ä½œäº†ã€‚&lt;/p&gt;

&lt;p&gt;å†™æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileWriter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.Writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Writer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileWriter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;åœ¨é»˜è®¤æƒ…å†µä¸‹å†æ¬¡è¾“å‡ºä¼šè¦†ç›–ï¼Œè¿½åŠ çš„æ–¹æ³•ä¹Ÿæ˜¯åœ¨æ„é€ å‡½æ•°ä¸ŠåŠ ä¸Šè¿½åŠ æ ‡è®°&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileWriter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.Writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Writer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileWriter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//è¿½åŠ &lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\r\nHello World&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;å­—ç¬¦è¾“å…¥æµreader&quot;&gt;å­—ç¬¦è¾“å…¥æµï¼šReader&lt;/h5&gt;

&lt;p&gt;Readeræ˜¯ä½¿ç”¨å­—ç¬¦çš„æ–¹å¼ä»æ–‡ä»¶ä¸­å–å‡ºæ•°æ®ï¼ŒReaderç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;public abstract class Reader extends Objects implements Readableï¼ŒCloseable&lt;/p&gt;

&lt;p&gt;Readeræœ¬èº«ä¹Ÿæ˜¯æŠ½è±¡ç±»ï¼Œå¦‚æœç°åœ¨è¦ä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨FileReaderå­ç±»ã€‚&lt;/p&gt;

&lt;p&gt;FileReaderçš„æ„é€ æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;public FileReader(File file)throws FileNotFoundException&lt;/p&gt;

&lt;p&gt;ä»¥å­—ç¬¦æ•°ç»„çš„å½¢å¼è¯»å–å‡ºæ•°æ®ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.Reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Reader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ç”¨å¾ªç¯æ–¹å¼ï¼Œåˆ¤æ–­æ˜¯å¦è¯»åˆ°åº•ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.FileReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.Reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;d:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test.txt&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Reader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FileReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())!=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]=(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="ioæµ" /><summary type="html">æ€»ç»“æ€§é™ˆè¿° å­—èŠ‚æµï¼ˆFileInputStreamå’ŒFileOutputStreamï¼‰ InputStream å’ŒOutputStream,ä¸¤ä¸ªæ˜¯ä¸ºå­—èŠ‚æµè®¾è®¡çš„,ä¸»è¦ç”¨æ¥å¤„ç†å­—èŠ‚æˆ–äºŒè¿›åˆ¶å¯¹è±¡ å­—èŠ‚æµå¤„ç†å•å…ƒä¸º 1ä¸ªå­—èŠ‚ï¼Œæ“ä½œå­—èŠ‚å’Œå­—èŠ‚æ•°ç»„ã€‚ å¦‚æœæ˜¯éŸ³é¢‘æ–‡ä»¶ã€å›¾ç‰‡ã€æ­Œæ›²ï¼Œå°±ç”¨å­—èŠ‚æµå¥½ç‚¹ï¼Œæ‰€ä»¥å®ƒå¯¹å¤šå›½è¯­è¨€æ”¯æŒæ€§æ¯”è¾ƒå¥½ï¼ å­—ç¬¦æµï¼ˆFileReaderå’ŒFileWriterï¼‰ Readerå’Œ Writer.ä¸¤ä¸ªæ˜¯ä¸ºå­—ç¬¦æµï¼ˆä¸€ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚ï¼‰è®¾è®¡çš„,ä¸»è¦ç”¨æ¥å¤„ç†å­—ç¬¦æˆ–å­—ç¬¦ä¸². å­—ç¬¦æµå¤„ç†çš„å•å…ƒä¸º 2ä¸ªå­—èŠ‚ çš„Unicodeå­—ç¬¦ï¼Œæ“ä½œå­—ç¬¦ã€å­—ç¬¦æ•°ç»„æˆ–å­—ç¬¦ä¸² æ‰€ä»¥å­—ç¬¦æµæ˜¯ç”±Javaè™šæ‹Ÿæœºå°†å­—èŠ‚è½¬åŒ–ä¸º2ä¸ªå­—èŠ‚çš„Unicodeå­—ç¬¦ä¸ºå•ä½çš„å­—ç¬¦è€Œæˆçš„ã€‚ å¦‚æœæ˜¯å…³ç³»åˆ°ä¸­æ–‡ï¼ˆæ–‡æœ¬ï¼‰çš„ï¼Œç”¨å­—ç¬¦æµå¥½ç‚¹ ç¼“å†²åŒºçš„ä½¿ç”¨ å­—èŠ‚æµåœ¨æ“ä½œæ—¶ä¸ä¼šç”¨åˆ°ç¼“å†²åŒºï¼ˆå†…å­˜ï¼‰ï¼Œæ˜¯ç›´æ¥å¯¹æ–‡ä»¶æœ¬èº«è¿›è¡Œæ“ä½œçš„ã€‚ è€Œå­—ç¬¦æµåœ¨æ“ä½œæ—¶ä½¿ç”¨äº†ç¼“å†²åŒºï¼Œé€šè¿‡ç¼“å†²åŒºå†æ“ä½œæ–‡ä»¶ã€‚ åœ¨ç¡¬ç›˜ä¸Šçš„æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯ä»¥å­—èŠ‚å½¢å¼å­˜åœ¨çš„ï¼ˆå›¾ç‰‡ï¼Œå£°éŸ³ï¼Œè§†é¢‘ï¼‰ï¼Œè€Œå­—ç¬¦å€¼åœ¨å†…å­˜ä¸­æ‰ä¼šå½¢æˆã€‚ï¼ˆé‡ç‚¹ï¼‰ å¢æ·»çŸ¥è¯†ç‚¹ æ–‡ç« é‡ç‚¹ï¼šå­—èŠ‚æµåœ¨æ“ä½œçš„æ—¶å€™æœ¬èº«æ˜¯ä¸ä¼šç”¨åˆ°ç¼“å†²åŒºï¼ˆå†…å­˜ï¼‰çš„ï¼Œæ˜¯ä¸æ–‡ä»¶æœ¬èº«ç›´æ¥æ“ä½œçš„ï¼Œè€Œå­—ç¬¦æµåœ¨æ“ä½œçš„æ—¶å€™æ˜¯ä½¿ç”¨åˆ°ç¼“å†²åŒºçš„ã€‚ å­—èŠ‚æµåœ¨æ“ä½œæ–‡ä»¶æ—¶ï¼Œå³ä½¿ä¸å…³é—­èµ„æºï¼ˆcloseæ–¹æ³•ï¼‰ï¼Œæ–‡ä»¶ä¹Ÿèƒ½è¾“å‡ºï¼Œä½†æ˜¯å¦‚æœå­—ç¬¦æµä¸ä½¿ç”¨closeæ–¹æ³•çš„è¯ï¼Œåˆ™ä¸ä¼šè¾“å‡ºä»»ä½•å†…å®¹ï¼Œè¯´æ˜å­—ç¬¦æµç”¨çš„æ˜¯ç¼“å†²åŒºï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨flushæ–¹æ³•å¼ºåˆ¶è¿›è¡Œåˆ·æ–°ç¼“å†²åŒºï¼Œè¿™æ—¶æ‰èƒ½åœ¨ä¸closeçš„æƒ…å†µä¸‹è¾“å‡ºå†…å®¹ã€‚ ä½†æ˜¯èŠ‚æµæ˜¯æœ€åŸºæœ¬çš„ï¼Œä¸€ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚å°±å¯ä»¥çœ‹å‡ºï¼Œç”šè‡³æºç ä½¿ç”¨å­—ç¬¦æµçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å…ˆè½¬æˆå­—èŠ‚åœ¨å˜æˆå­—ç¬¦ï¼Œæ‰€ä»¥ä½¿ç”¨å­—èŠ‚æµçš„æ“ä½œæ˜¯æœ€å¤šçš„ã€‚ ä¸Šé¢ä¸¤ç‚¹èƒ½è¯´æ˜ä»€ä¹ˆå‘¢ï¼Ÿ ç¬¬ä¸€ç‚¹ï¼Œæ‰€æœ‰æ–‡ä»¶çš„å‚¨å­˜æ˜¯éƒ½æ˜¯å­—èŠ‚ï¼ˆbyteï¼‰çš„å‚¨å­˜ï¼Œåœ¨ç£ç›˜ä¸Šä¿ç•™çš„å¹¶ä¸æ˜¯æ–‡ä»¶çš„å­—ç¬¦è€Œæ˜¯å…ˆæŠŠå­—ç¬¦ç¼–ç æˆå­—èŠ‚ï¼Œå†å‚¨å­˜è¿™äº›å­—èŠ‚åˆ°ç£ç›˜ã€‚ åœ¨è¯»å–æ–‡ä»¶ï¼ˆç‰¹åˆ«æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼‰æ—¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°è¯»å–ä»¥å½¢æˆå­—èŠ‚åºåˆ— ç¬¬äºŒç‚¹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé¢‘ç¹å¯¹ä¸€ä¸ªèµ„æºè¿›è¡ŒIOæ“ä½œï¼Œæ•ˆç‡ä¼šéå¸¸ä½ã€‚æ­¤æ—¶ï¼Œé€šè¿‡ç¼“å†²åŒºï¼Œå…ˆæŠŠéœ€è¦æ“ä½œçš„æ•°æ®æš‚æ—¶æ”¾å…¥å†…å­˜ä¸­ï¼Œä»¥åç›´æ¥ä»å†…å­˜ä¸­è¯»å–æ•°æ®ï¼Œåˆ™å¯ä»¥é¿å…å¤šæ¬¡çš„IOæ“ä½œï¼Œæé«˜æ•ˆç‡ ç¬¬ä¸‰ç‚¹ï¼ŒçœŸæ­£å­˜å‚¨å’Œä¼ è¾“æ•°æ®æ—¶éƒ½æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œå­—ç¬¦åªæ˜¯å­˜åœ¨ä¸å†…å­˜å½“ä¸­çš„ï¼Œæ‰€ä»¥ï¼Œå­—èŠ‚æµé€‚ç”¨èŒƒå›´æ›´ä¸ºå®½å¹¿ æ¦‚å¿µ åœ¨ç¨‹åºä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥æµçš„æ–¹å¼è¿›è¡Œä¼ è¾“æˆ–ä¿å­˜çš„ï¼Œç¨‹åºéœ€è¦æ•°æ®çš„æ—¶å€™è¦ä½¿ç”¨è¾“å…¥æµè¯»å–æ•°æ®ï¼Œè€Œå½“ç¨‹åºéœ€è¦å°†ä¸€äº›æ•°æ®ä¿å­˜èµ·æ¥çš„æ—¶å€™ï¼Œå°±è¦ä½¿ç”¨è¾“å‡ºæµå®Œæˆã€‚ ç¨‹åºä¸­çš„è¾“å…¥è¾“å‡ºéƒ½æ˜¯ä»¥æµçš„å½¢å¼ä¿å­˜çš„ï¼Œæµä¸­ä¿å­˜çš„å®é™…ä¸Šå…¨éƒ½æ˜¯å­—èŠ‚æ–‡ä»¶ã€‚ å­—èŠ‚æµä¸å­—ç¬¦æµ åœ¨java.ioåŒ…ä¸­æ“ä½œæ–‡ä»¶å†…å®¹çš„ä¸»è¦æœ‰ä¸¤å¤§ç±»ï¼šå­—èŠ‚æµã€å­—ç¬¦æµï¼Œä¸¤ç±»éƒ½åˆ†ä¸ºè¾“å…¥å’Œè¾“å‡ºæ“ä½œã€‚åœ¨å­—èŠ‚æµä¸­è¾“å‡ºæ•°æ®ä¸»è¦æ˜¯ä½¿ç”¨OutputStreamå®Œæˆï¼Œè¾“å…¥ä½¿çš„æ˜¯InputStreamï¼Œåœ¨å­—ç¬¦æµä¸­è¾“å‡ºä¸»è¦æ˜¯ä½¿ç”¨Writerç±»å®Œæˆï¼Œè¾“å…¥æµä¸»è¦ä½¿ç”¨Readerç±»å®Œæˆã€‚ï¼ˆè¿™å››ä¸ªéƒ½æ˜¯æŠ½è±¡ç±»ï¼‰ æ“ä½œæµç¨‹ åœ¨Javaä¸­IOæ“ä½œä¹Ÿæ˜¯æœ‰ç›¸åº”æ­¥éª¤çš„ï¼Œä»¥æ–‡ä»¶æ“ä½œä¸ºä¾‹ï¼Œä¸»è¦çš„æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š ä½¿ç”¨Fileç±»æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ é€šè¿‡å­—èŠ‚æµæˆ–å­—ç¬¦æµçš„å­ç±»ï¼ŒæŒ‡å®šè¾“å‡ºçš„ä½ç½® è¿›è¡Œè¯»/å†™æ“ä½œ å…³é—­è¾“å…¥/è¾“å‡º IOæ“ä½œå±äºèµ„æºæ“ä½œï¼Œä¸€å®šè¦è®°å¾—å…³é—­ å­—èŠ‚æµ å­—èŠ‚æµä¸»è¦æ˜¯æ“ä½œbyteç±»å‹æ•°æ®ï¼Œä»¥byteæ•°ç»„ä¸ºå‡†ï¼Œä¸»è¦æ“ä½œç±»å°±æ˜¯OutputStreamã€InputStream å­—èŠ‚è¾“å‡ºæµï¼šOutputStream OutputStreamæ˜¯æ•´ä¸ªIOåŒ…ä¸­å­—èŠ‚è¾“å‡ºæµçš„æœ€å¤§çˆ¶ç±»ï¼Œæ­¤ç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š public abstract class OutputStream extends Object implements Closeable,Flushable ä»ä»¥ä¸Šçš„å®šä¹‰å¯ä»¥å‘ç°ï¼Œæ­¤ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨æ­¤ç±»çš„è¯ï¼Œåˆ™é¦–å…ˆå¿…é¡»é€šè¿‡å­ç±»å®ä¾‹åŒ–å¯¹è±¡ï¼Œé‚£ä¹ˆå¦‚æœç°åœ¨è¦æ“ä½œçš„æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ï¼šFileOutputStreamç±»ã€‚é€šè¿‡å‘ä¸Šè½¬å‹ä¹‹åï¼Œå¯ä»¥ä¸ºOutputStreamå®ä¾‹åŒ– Closeableè¡¨ç¤ºå¯ä»¥å…³é—­çš„æ“ä½œï¼Œå› ä¸ºç¨‹åºè¿è¡Œåˆ°æœ€åè‚¯å®šè¦å…³é—­ Flushableï¼šè¡¨ç¤ºåˆ·æ–°ï¼Œæ¸…ç©ºå†…å­˜ä¸­çš„æ•°æ® FileOutputStreamç±»çš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š public FileOutputStream(File file)throws FileNotFoundException å†™æ•°æ®ï¼š import java.io.File; import java.io.FileOutputStream; import java.io.IOException; import java.io.OutputStream; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); OutputStream out=new FileOutputStream(f);//å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º String str=&quot;Hello World&quot;; byte[] b=str.getBytes(); out.write(b);//å› ä¸ºæ˜¯å­—èŠ‚æµï¼Œæ‰€ä»¥è¦è½¬åŒ–æˆå­—èŠ‚æ•°ç»„è¿›è¡Œè¾“å‡º out.close(); } } ä¹Ÿå¯ä»¥ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¿›è¡Œè¾“å‡ºï¼Œå¦‚ä¸‹ï¼š import java.io.File; import java.io.FileOutputStream; import java.io.IOException; import java.io.OutputStream; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); OutputStream out=new FileOutputStream(f);//å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º String str=&quot;Hello World&quot;; byte[] b=str.getBytes(); for(int i=0;i&amp;lt;b.length;i++){ out.write(b[i]); } out.close(); } } ä»¥ä¸Šè¾“å‡ºåªä¼šè¿›è¡Œè¦†ç›–ï¼Œå¦‚æœè¦è¿½åŠ çš„è¯ï¼Œè¯·çœ‹FileOutputStreamç±»çš„å¦ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼š public FileOutputStream(File file,boolean append)throws FileNotFoundException åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œå¦‚æœå°†appendçš„å€¼è®¾ç½®ä¸ºtrueï¼Œåˆ™è¡¨ç¤ºåœ¨æ–‡ä»¶çš„æœ«å°¾è¿½åŠ å†…å®¹ã€‚ import java.io.File; import java.io.FileOutputStream; import java.io.IOException; import java.io.OutputStream; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); OutputStream out=new FileOutputStream(f,true);//è¿½åŠ å†…å®¹ String str=&quot;\r\nHello World&quot;; byte[] b=str.getBytes(); for(int i=0;i&amp;lt;b.length;i++){ out.write(b[i]); } out.close(); } } æ–‡ä»¶ä¸­æ¢è¡Œä¸ºï¼š\r\n å­—èŠ‚è¾“å…¥æµï¼šInputStream æ—¢ç„¶ç¨‹åºå¯ä»¥å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œåˆ™å°±å¯ä»¥é€šè¿‡InputStreamä»æ–‡ä»¶ä¸­æŠŠå†…å®¹è¯»å–è¿›æ¥ï¼Œé¦–å…ˆæ¥çœ‹InputStreamç±»çš„å®šä¹‰ï¼š public abstract class InputStream extends Object implements Closeable ä¸OutputStreamç±»ä¸€æ ·ï¼ŒInputStreamæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¿…é¡»ä¾é å…¶å­ç±»ï¼Œå¦‚æœç°åœ¨æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–ï¼Œå°±ç”¨FileInputStreamæ¥å®ç°ã€‚ è§‚å¯ŸFileInputStreamç±»çš„æ„é€ æ–¹æ³•ï¼š public FileInputStream(File file)throws FileNotFoundException è¯»æ–‡ä»¶ï¼š import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.io.InputStream; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); InputStream in=new FileInputStream(f); byte[] b=new byte[1024]; int len=in.read(b); in.close(); System.out.println(new String(b,0,len)); } } ä½†ä»¥ä¸Šæ–¹æ³•æ˜¯æœ‰é—®é¢˜çš„ï¼Œç”¨ä¸ç”¨å¼€è¾Ÿè¿™ä¹ˆå¤§çš„ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œæ˜æ˜¾æ˜¯æµªè´¹å˜›ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ–‡ä»¶çš„å¤§å°æ¥å®šä¹‰å­—èŠ‚æ•°ç»„çš„å¤§å°ï¼ŒFileç±»ä¸­çš„æ–¹æ³•ï¼špublic long length() import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.io.InputStream; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); InputStream in=new FileInputStream(f); byte[] b=new byte[(int) f.length()]; in.read(b); in.close(); System.out.println(new String(b)); } } æˆ‘ä»¬æ¢ç§æ–¹å¼ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¯»å…¥~ import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.io.InputStream; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); InputStream in=new FileInputStream(f); byte[] b=new byte[(int) f.length()]; for(int i=0;i&amp;lt;b.length;i++){ b[i]=(byte) in.read(); } in.close(); System.out.println(new String(b)); } } ä½†ä»¥ä¸Šæƒ…å†µåªé€‚åˆçŸ¥é“è¾“å…¥æ–‡ä»¶çš„å¤§å°ï¼Œä¸çŸ¥é“çš„è¯ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.io.InputStream; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); InputStream in=new FileInputStream(f); byte[] b=new byte[1024]; int temp=0; int len=0; while((temp=in.read())!=-1){//-1ä¸ºæ–‡ä»¶è¯»å®Œçš„æ ‡å¿— b[len]=(byte) temp; len++; } in.close(); System.out.println(new String(b,0,len)); } } å­—ç¬¦æµ åœ¨ç¨‹åºä¸­ä¸€ä¸ªå­—ç¬¦ç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆjavaæä¾›äº†Readerã€Writerä¸¤ä¸ªä¸“é—¨æ“ä½œå­—ç¬¦æµçš„ç±»ã€‚ å­—ç¬¦è¾“å‡ºæµï¼šWriter Writeræœ¬èº«æ˜¯ä¸€ä¸ªå­—ç¬¦æµçš„è¾“å‡ºç±»ï¼Œæ­¤ç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š public abstract class Writer extends Object implements Appendableï¼ŒCloseableï¼ŒFlushable æ­¤ç±»æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¦‚æœè¦ä½¿ç”¨æ­¤ç±»ï¼Œåˆ™è‚¯å®šè¦ä½¿ç”¨å…¶å­ç±»ï¼Œæ­¤æ—¶å¦‚æœæ˜¯å‘æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œæ‰€ä»¥åº”è¯¥ä½¿ç”¨FileWriterçš„å­ç±»ã€‚ FileWriterç±»çš„æ„é€ æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š public FileWriter(File file)throws IOException å­—ç¬¦æµçš„æ“ä½œæ¯”å­—èŠ‚æµæ“ä½œå¥½åœ¨ä¸€ç‚¹ï¼Œå°±æ˜¯å¯ä»¥ç›´æ¥è¾“å‡ºå­—ç¬¦ä¸²äº†ï¼Œä¸ç”¨å†åƒä¹‹å‰é‚£æ ·è¿›è¡Œè½¬æ¢æ“ä½œäº†ã€‚ å†™æ–‡ä»¶ï¼š import java.io.File; import java.io.FileWriter; import java.io.IOException; import java.io.Writer; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); Writer out=new FileWriter(f); String str=&quot;Hello World&quot;; out.write(str); out.close(); } } åœ¨é»˜è®¤æƒ…å†µä¸‹å†æ¬¡è¾“å‡ºä¼šè¦†ç›–ï¼Œè¿½åŠ çš„æ–¹æ³•ä¹Ÿæ˜¯åœ¨æ„é€ å‡½æ•°ä¸ŠåŠ ä¸Šè¿½åŠ æ ‡è®° import java.io.File; import java.io.FileWriter; import java.io.IOException; import java.io.Writer; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); Writer out=new FileWriter(f,true);//è¿½åŠ  String str=&quot;\r\nHello World&quot;; out.write(str); out.close(); } } å­—ç¬¦è¾“å…¥æµï¼šReader Readeræ˜¯ä½¿ç”¨å­—ç¬¦çš„æ–¹å¼ä»æ–‡ä»¶ä¸­å–å‡ºæ•°æ®ï¼ŒReaderç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š public abstract class Reader extends Objects implements Readableï¼ŒCloseable Readeræœ¬èº«ä¹Ÿæ˜¯æŠ½è±¡ç±»ï¼Œå¦‚æœç°åœ¨è¦ä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨FileReaderå­ç±»ã€‚ FileReaderçš„æ„é€ æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š public FileReader(File file)throws FileNotFoundException ä»¥å­—ç¬¦æ•°ç»„çš„å½¢å¼è¯»å–å‡ºæ•°æ®ï¼š import java.io.File; import java.io.FileReader; import java.io.IOException; import java.io.Reader; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); Reader input=new FileReader(f); char[] c=new char[1024]; int len=input.read(c); input.close(); System.out.println(new String(c,0,len)); } } ä¹Ÿå¯ä»¥ç”¨å¾ªç¯æ–¹å¼ï¼Œåˆ¤æ–­æ˜¯å¦è¯»åˆ°åº•ï¼š import java.io.File; import java.io.FileReader; import java.io.IOException; import java.io.Reader; public class Test{ public static void main(String[] args) throws IOException { File f = new File(&quot;d:&quot; + File.separator+&quot;test.txt&quot;); Reader input=new FileReader(f); char[] c=new char[1024]; int temp=0; int len=0; while((temp=input.read())!=-1){ c[len]=(char) temp; len++; } input.close(); System.out.println(new String(c,0,len)); } }</summary></entry><entry><title type="html">jvmé¢è¯•é¢˜</title><link href="http://localhost:4000/jvm/mianshiti" rel="alternate" type="text/html" title="jvmé¢è¯•é¢˜" /><published>2020-06-15T00:00:00+08:00</published><updated>2020-06-15T00:00:00+08:00</updated><id>http://localhost:4000/jvm/%E9%9D%A2%E8%AF%95%E9%A2%98</id><content type="html" xml:base="http://localhost:4000/jvm/mianshiti">&lt;h3 id=&quot;newä¸€ä¸ªå¯¹è±¡è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ&quot;&gt;newä¸€ä¸ªå¯¹è±¡è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;ç¡®è®¤ç±»å…ƒä¿¡æ¯æ˜¯å¦å­˜åœ¨&lt;/strong&gt;ã€‚å½“ JVM æ¥æ”¶åˆ° new æŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆåœ¨ metaspace å†…æ£€æŸ¥éœ€è¦åˆ›å»ºçš„ç±»å…ƒä¿¡æ¯æ˜¯å¦å­˜åœ¨ã€‚ è‹¥ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨åŒäº²å§”æ´¾æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨å½“å‰ç±»åŠ è½½å™¨ä»¥ ClassLoader + åŒ…åï¼‹ç±»åä¸º Key è¿›è¡ŒæŸ¥æ‰¾å¯¹åº”çš„ class æ–‡ä»¶ã€‚ å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶ï¼Œåˆ™æŠ›å‡º ClassNotFoundException å¼‚å¸¸ ï¼Œ å¦‚æœæ‰¾åˆ°ï¼Œåˆ™è¿›è¡Œç±»åŠ è½½ï¼ˆåŠ è½½ - éªŒè¯ - å‡†å¤‡ - è§£æ - åˆå§‹åŒ–ï¼‰ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„ Class ç±»å¯¹è±¡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åˆ†é…å¯¹è±¡å†…å­˜&lt;/strong&gt;ã€‚ é¦–å…ˆè®¡ç®—å¯¹è±¡å ç”¨ç©ºé—´å¤§å°ï¼Œå¦‚æœå®ä¾‹æˆå‘˜å˜é‡æ˜¯å¼•ç”¨å˜é‡ï¼Œä»…åˆ†é…å¼•ç”¨å˜é‡ç©ºé—´å³å¯ï¼Œå³ 4 ä¸ªå­—èŠ‚å¤§å°ï¼Œæ¥ç€åœ¨å †ä¸­åˆ’åˆ†â€”å—å†…å­˜ç»™æ–°å¯¹è±¡ã€‚ åœ¨åˆ†é…å†…å­˜ç©ºé—´æ—¶ï¼Œéœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œæ¯”å¦‚é‡‡ç”¨ CAS (Compare And Swap) å¤±è´¥é‡è¯•ã€ åŒºåŸŸåŠ é”ç­‰æ–¹å¼ä¿è¯åˆ†é…æ“ä½œçš„åŸå­æ€§ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è®¾å®šé»˜è®¤å€¼&lt;/strong&gt;ã€‚ æˆå‘˜å˜é‡å€¼éƒ½éœ€è¦è®¾å®šä¸ºé»˜è®¤å€¼ï¼Œ å³å„ç§ä¸åŒå½¢å¼çš„é›¶å€¼ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è®¾ç½®å¯¹è±¡å¤´&lt;/strong&gt;ã€‚è®¾ç½®æ–°å¯¹è±¡çš„å“ˆå¸Œç ã€ GC ä¿¡æ¯ã€é”ä¿¡æ¯ã€å¯¹è±¡æ‰€å±çš„ç±»å…ƒä¿¡æ¯ç­‰ã€‚è¿™ä¸ªè¿‡ç¨‹çš„å…·ä½“è®¾ç½®æ–¹å¼å–å†³äº JVM å®ç°ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ‰§è¡Œ init æ–¹æ³•&lt;/strong&gt;ã€‚ åˆå§‹åŒ–æˆå‘˜å˜é‡ï¼Œæ‰§è¡Œå®ä¾‹åŒ–ä»£ç å—ï¼Œè°ƒç”¨ç±»çš„æ„é€ æ–¹æ³•ï¼Œå¹¶æŠŠå †å†…å¯¹è±¡çš„é¦–åœ°å€èµ‹å€¼ç»™å¼•ç”¨å˜é‡ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;ç±»åŠ è½½çš„æ—¶æœº&quot;&gt;ç±»åŠ è½½çš„æ—¶æœº&lt;/h4&gt;

&lt;p&gt;å¯¹äºåˆå§‹åŒ–é˜¶æ®µï¼Œè™šæ‹Ÿæœºè§„èŒƒè§„å®šäº†æœ‰ä¸”åªæœ‰ 5 ç§æƒ…å†µå¿…é¡»ç«‹å³å¯¹ç±»è¿›è¡Œâ€œåˆå§‹åŒ–â€ï¼ˆè€ŒåŠ è½½ã€éªŒè¯ã€å‡†å¤‡è‡ªç„¶éœ€è¦åœ¨æ­¤ä¹‹å‰å¼€å§‹ï¼‰ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;é‡åˆ°newã€getstatic å’Œ putstatic æˆ– invokestatic è¿™4æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚å¯¹åº”åœºæ™¯æ˜¯ï¼šä½¿ç”¨ new å®ä¾‹åŒ–å¯¹è±¡ã€è¯»å–æˆ–è®¾ç½®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µï¼ˆè¢« final ä¿®é¥°ã€å·²åœ¨ç¼–è¯‘æœŸæŠŠç»“æœæ”¾å…¥å¸¸é‡æ± çš„é™æ€å­—æ®µé™¤å¤–ï¼‰ã€ä»¥åŠè°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•ã€‚&lt;/li&gt;
  &lt;li&gt;å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚&lt;/li&gt;
  &lt;li&gt;å½“åˆå§‹åŒ–ç±»çš„çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ï¼ˆè€Œä¸€ä¸ªæ¥å£åœ¨åˆå§‹åŒ–æ—¶ï¼Œå¹¶ä¸è¦æ±‚å…¶çˆ¶æ¥å£å…¨éƒ¨éƒ½å®Œæˆäº†åˆå§‹åŒ–ï¼‰&lt;/li&gt;
  &lt;li&gt;è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±»ï¼ˆåŒ…å« main() æ–¹æ³•çš„é‚£ä¸ªç±»ï¼‰ï¼Œ
è™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªä¸»ç±»ã€‚&lt;/li&gt;
  &lt;li&gt;å½“ä½¿ç”¨ JDK 1.7 çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ª java.lang.invoke.MethodHandle å®ä¾‹æœ€åçš„è§£æç»“æœ REF_getStaticã€REF_putStaticã€REF_invokeStatic çš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;ç¬¬5ç§æƒ…å†µï¼Œæˆ‘æš‚æ—¶çœ‹ä¸æ‡‚&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸Šè¿™ 5 ç§åœºæ™¯ä¸­çš„è¡Œä¸ºç§°ä¸ºå¯¹ä¸€ä¸ªç±»è¿›è¡Œä¸»åŠ¨å¼•ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ‰€æœ‰å¼•ç”¨ç±»çš„æ–¹å¼éƒ½ä¸ä¼šè§¦å‘åˆå§‹åŒ–ï¼Œç§°ä¸ºè¢«åŠ¨å¼•ç”¨ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–ã€‚&lt;/li&gt;
  &lt;li&gt;é€šè¿‡æ•°ç»„å®šä¹‰æ¥å¼•ç”¨ç±»ï¼Œä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–ã€‚MyClass[] cs = new MyClass[10];&lt;/li&gt;
  &lt;li&gt;å¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ç›´æ¥å¼•ç”¨åˆ°å®šä¹‰å¸¸é‡çš„ç±»ï¼Œå› æ­¤ä¸ä¼šè§¦å‘å®šä¹‰å¸¸é‡çš„ç±»çš„åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="jvmé¢è¯•é¢˜" /><summary type="html">newä¸€ä¸ªå¯¹è±¡è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ ç¡®è®¤ç±»å…ƒä¿¡æ¯æ˜¯å¦å­˜åœ¨ã€‚å½“ JVM æ¥æ”¶åˆ° new æŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆåœ¨ metaspace å†…æ£€æŸ¥éœ€è¦åˆ›å»ºçš„ç±»å…ƒä¿¡æ¯æ˜¯å¦å­˜åœ¨ã€‚ è‹¥ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨åŒäº²å§”æ´¾æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨å½“å‰ç±»åŠ è½½å™¨ä»¥ ClassLoader + åŒ…åï¼‹ç±»åä¸º Key è¿›è¡ŒæŸ¥æ‰¾å¯¹åº”çš„ class æ–‡ä»¶ã€‚ å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶ï¼Œåˆ™æŠ›å‡º ClassNotFoundException å¼‚å¸¸ ï¼Œ å¦‚æœæ‰¾åˆ°ï¼Œåˆ™è¿›è¡Œç±»åŠ è½½ï¼ˆåŠ è½½ - éªŒè¯ - å‡†å¤‡ - è§£æ - åˆå§‹åŒ–ï¼‰ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„ Class ç±»å¯¹è±¡ã€‚ åˆ†é…å¯¹è±¡å†…å­˜ã€‚ é¦–å…ˆè®¡ç®—å¯¹è±¡å ç”¨ç©ºé—´å¤§å°ï¼Œå¦‚æœå®ä¾‹æˆå‘˜å˜é‡æ˜¯å¼•ç”¨å˜é‡ï¼Œä»…åˆ†é…å¼•ç”¨å˜é‡ç©ºé—´å³å¯ï¼Œå³ 4 ä¸ªå­—èŠ‚å¤§å°ï¼Œæ¥ç€åœ¨å †ä¸­åˆ’åˆ†â€”å—å†…å­˜ç»™æ–°å¯¹è±¡ã€‚ åœ¨åˆ†é…å†…å­˜ç©ºé—´æ—¶ï¼Œéœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œæ¯”å¦‚é‡‡ç”¨ CAS (Compare And Swap) å¤±è´¥é‡è¯•ã€ åŒºåŸŸåŠ é”ç­‰æ–¹å¼ä¿è¯åˆ†é…æ“ä½œçš„åŸå­æ€§ã€‚ è®¾å®šé»˜è®¤å€¼ã€‚ æˆå‘˜å˜é‡å€¼éƒ½éœ€è¦è®¾å®šä¸ºé»˜è®¤å€¼ï¼Œ å³å„ç§ä¸åŒå½¢å¼çš„é›¶å€¼ã€‚ è®¾ç½®å¯¹è±¡å¤´ã€‚è®¾ç½®æ–°å¯¹è±¡çš„å“ˆå¸Œç ã€ GC ä¿¡æ¯ã€é”ä¿¡æ¯ã€å¯¹è±¡æ‰€å±çš„ç±»å…ƒä¿¡æ¯ç­‰ã€‚è¿™ä¸ªè¿‡ç¨‹çš„å…·ä½“è®¾ç½®æ–¹å¼å–å†³äº JVM å®ç°ã€‚ æ‰§è¡Œ init æ–¹æ³•ã€‚ åˆå§‹åŒ–æˆå‘˜å˜é‡ï¼Œæ‰§è¡Œå®ä¾‹åŒ–ä»£ç å—ï¼Œè°ƒç”¨ç±»çš„æ„é€ æ–¹æ³•ï¼Œå¹¶æŠŠå †å†…å¯¹è±¡çš„é¦–åœ°å€èµ‹å€¼ç»™å¼•ç”¨å˜é‡ã€‚ ç±»åŠ è½½çš„æ—¶æœº å¯¹äºåˆå§‹åŒ–é˜¶æ®µï¼Œè™šæ‹Ÿæœºè§„èŒƒè§„å®šäº†æœ‰ä¸”åªæœ‰ 5 ç§æƒ…å†µå¿…é¡»ç«‹å³å¯¹ç±»è¿›è¡Œâ€œåˆå§‹åŒ–â€ï¼ˆè€ŒåŠ è½½ã€éªŒè¯ã€å‡†å¤‡è‡ªç„¶éœ€è¦åœ¨æ­¤ä¹‹å‰å¼€å§‹ï¼‰ï¼š é‡åˆ°newã€getstatic å’Œ putstatic æˆ– invokestatic è¿™4æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚å¯¹åº”åœºæ™¯æ˜¯ï¼šä½¿ç”¨ new å®ä¾‹åŒ–å¯¹è±¡ã€è¯»å–æˆ–è®¾ç½®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µï¼ˆè¢« final ä¿®é¥°ã€å·²åœ¨ç¼–è¯‘æœŸæŠŠç»“æœæ”¾å…¥å¸¸é‡æ± çš„é™æ€å­—æ®µé™¤å¤–ï¼‰ã€ä»¥åŠè°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•ã€‚ å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ å½“åˆå§‹åŒ–ç±»çš„çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ï¼ˆè€Œä¸€ä¸ªæ¥å£åœ¨åˆå§‹åŒ–æ—¶ï¼Œå¹¶ä¸è¦æ±‚å…¶çˆ¶æ¥å£å…¨éƒ¨éƒ½å®Œæˆäº†åˆå§‹åŒ–ï¼‰ è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±»ï¼ˆåŒ…å« main() æ–¹æ³•çš„é‚£ä¸ªç±»ï¼‰ï¼Œ è™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªä¸»ç±»ã€‚ å½“ä½¿ç”¨ JDK 1.7 çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ª java.lang.invoke.MethodHandle å®ä¾‹æœ€åçš„è§£æç»“æœ REF_getStaticã€REF_putStaticã€REF_invokeStatic çš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ ç¬¬5ç§æƒ…å†µï¼Œæˆ‘æš‚æ—¶çœ‹ä¸æ‡‚ã€‚ ä»¥ä¸Šè¿™ 5 ç§åœºæ™¯ä¸­çš„è¡Œä¸ºç§°ä¸ºå¯¹ä¸€ä¸ªç±»è¿›è¡Œä¸»åŠ¨å¼•ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ‰€æœ‰å¼•ç”¨ç±»çš„æ–¹å¼éƒ½ä¸ä¼šè§¦å‘åˆå§‹åŒ–ï¼Œç§°ä¸ºè¢«åŠ¨å¼•ç”¨ï¼Œä¾‹å¦‚ï¼š é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–ã€‚ é€šè¿‡æ•°ç»„å®šä¹‰æ¥å¼•ç”¨ç±»ï¼Œä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–ã€‚MyClass[] cs = new MyClass[10]; å¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ç›´æ¥å¼•ç”¨åˆ°å®šä¹‰å¸¸é‡çš„ç±»ï¼Œå› æ­¤ä¸ä¼šè§¦å‘å®šä¹‰å¸¸é‡çš„ç±»çš„åˆå§‹åŒ–ã€‚</summary></entry><entry><title type="html">çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</title><link href="http://localhost:4000/jvm/classloader/context" rel="alternate" type="text/html" title="çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨" /><published>2020-06-15T00:00:00+08:00</published><updated>2020-06-15T00:00:00+08:00</updated><id>http://localhost:4000/jvm/classloader/%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8</id><content type="html" xml:base="http://localhost:4000/jvm/classloader/context">&lt;p&gt;å¦‚ä¸Šæ‰€è¯´ &lt;a href=&quot;/jvm/classloader/myself&quot;&gt;è‡ªå®šä¹‰ç±»åŠ è½½å™¨&lt;/a&gt; ï¼Œä¸ºè§£å†³åŸºç¡€ç±»æ— æ³•è°ƒç”¨ç±»åŠ è½½å™¨åŠ è½½ç”¨æˆ·æä¾›ä»£ç çš„é—®é¢˜ï¼ŒJava å¼•å…¥äº†çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆThread Context ClassLoaderï¼‰ã€‚è¿™ä¸ªç±»åŠ è½½å™¨é»˜è®¤å°±æ˜¯ Application ç±»åŠ è½½å™¨ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ java.lang.Thread.setContextClassLoaser() æ–¹æ³•è¿›è¡Œè®¾ç½®ã€‚&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Now create the class loader to use to launch the application&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AppClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAppClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extcl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;InternalError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;Could not create application class loader&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Also set the context class loader for the primordial thread.&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContextClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ClassLoader.getSystemClassLoader()&lt;/code&gt; æ–¹æ³•ä¹Ÿå¯ä»¥è·å–åˆ° Application ç±»åŠ è½½å™¨ï¼Œä½¿ç”¨å®ƒå°±å¯ä»¥åŠ è½½ç”¨æˆ·ç±»äº†å‘€ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Ÿ
å…¶å®ç›´æ¥ä½¿ç”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getSystemClassLoader()&lt;/code&gt; æ–¹æ³•è·å– AppClassLoader åŠ è½½ç±»ä¹Ÿå¯ä»¥æ»¡è¶³ä¸€äº›æƒ…å†µï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨å»åŠ è½½æŸä¸ªä½ç½®çš„ç±»æ—¶ï¼Œä¾‹å¦‚Tomcat ä½¿ç”¨çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å¹¶é AppClassLoader ï¼Œè€Œæ˜¯ Tomcat è‡ªå®šä¹‰ç±»åŠ è½½å™¨ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ Tomcat ä¸ºä¾‹ï¼Œå…¶æ¯ä¸ª Web åº”ç”¨éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ç±»åŠ è½½å™¨å®ä¾‹ï¼Œè¯¥ç±»åŠ è½½å™¨ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œé¦–å…ˆå°è¯•å»åŠ è½½æŸä¸ªç±»ï¼Œå¦‚æœæ‰¾ä¸åˆ°å†ä»£ç†ç»™çˆ¶ç±»åŠ è½½å™¨è¿™ä¸ä¸€èˆ¬ç±»åŠ è½½å™¨çš„é¡ºåºæ˜¯ç›¸åçš„ã€‚
è¿™æ˜¯ Java Servlet è§„èŒƒä¸­çš„æ¨èåšæ³•ï¼Œå…¶ç›®çš„æ˜¯ä½¿å¾— Web åº”ç”¨è‡ªå·±çš„ç±»çš„ä¼˜å…ˆçº§é«˜äº Web å®¹å™¨æä¾›çš„ç±»ã€‚&lt;/p&gt;

&lt;p&gt;æ›´å¤šå…³äº Tomcat ç±»åŠ è½½å™¨çš„çŸ¥è¯†ï¼Œè¿™é‡Œæš‚æ—¶å…ˆä¸è®²äº†ã€‚&lt;/p&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="jvm" /><category term="ç±»åŠ è½½å™¨" /><summary type="html">å¦‚ä¸Šæ‰€è¯´ è‡ªå®šä¹‰ç±»åŠ è½½å™¨ ï¼Œä¸ºè§£å†³åŸºç¡€ç±»æ— æ³•è°ƒç”¨ç±»åŠ è½½å™¨åŠ è½½ç”¨æˆ·æä¾›ä»£ç çš„é—®é¢˜ï¼ŒJava å¼•å…¥äº†çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆThread Context ClassLoaderï¼‰ã€‚è¿™ä¸ªç±»åŠ è½½å™¨é»˜è®¤å°±æ˜¯ Application ç±»åŠ è½½å™¨ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ java.lang.Thread.setContextClassLoaser() æ–¹æ³•è¿›è¡Œè®¾ç½®ã€‚ // Now create the class loader to use to launch the application try { loader = AppClassLoader.getAppClassLoader(extcl); } catch (IOException e) { throw new InternalError( &quot;Could not create application class loader&quot; ); } // Also set the context class loader for the primordial thread. Thread.currentThread().setContextClassLoader(loader); é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨ ClassLoader.getSystemClassLoader() æ–¹æ³•ä¹Ÿå¯ä»¥è·å–åˆ° Application ç±»åŠ è½½å™¨ï¼Œä½¿ç”¨å®ƒå°±å¯ä»¥åŠ è½½ç”¨æˆ·ç±»äº†å‘€ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Ÿ å…¶å®ç›´æ¥ä½¿ç”¨ getSystemClassLoader() æ–¹æ³•è·å– AppClassLoader åŠ è½½ç±»ä¹Ÿå¯ä»¥æ»¡è¶³ä¸€äº›æƒ…å†µï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨å»åŠ è½½æŸä¸ªä½ç½®çš„ç±»æ—¶ï¼Œä¾‹å¦‚Tomcat ä½¿ç”¨çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å¹¶é AppClassLoader ï¼Œè€Œæ˜¯ Tomcat è‡ªå®šä¹‰ç±»åŠ è½½å™¨ã€‚ ä»¥ Tomcat ä¸ºä¾‹ï¼Œå…¶æ¯ä¸ª Web åº”ç”¨éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ç±»åŠ è½½å™¨å®ä¾‹ï¼Œè¯¥ç±»åŠ è½½å™¨ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œé¦–å…ˆå°è¯•å»åŠ è½½æŸä¸ªç±»ï¼Œå¦‚æœæ‰¾ä¸åˆ°å†ä»£ç†ç»™çˆ¶ç±»åŠ è½½å™¨è¿™ä¸ä¸€èˆ¬ç±»åŠ è½½å™¨çš„é¡ºåºæ˜¯ç›¸åçš„ã€‚ è¿™æ˜¯ Java Servlet è§„èŒƒä¸­çš„æ¨èåšæ³•ï¼Œå…¶ç›®çš„æ˜¯ä½¿å¾— Web åº”ç”¨è‡ªå·±çš„ç±»çš„ä¼˜å…ˆçº§é«˜äº Web å®¹å™¨æä¾›çš„ç±»ã€‚ æ›´å¤šå…³äº Tomcat ç±»åŠ è½½å™¨çš„çŸ¥è¯†ï¼Œè¿™é‡Œæš‚æ—¶å…ˆä¸è®²äº†ã€‚</summary></entry><entry><title type="html">ç±»åŠ è½½å™¨</title><link href="http://localhost:4000/jvm/classloader" rel="alternate" type="text/html" title="ç±»åŠ è½½å™¨" /><published>2020-06-15T00:00:00+08:00</published><updated>2020-06-15T00:00:00+08:00</updated><id>http://localhost:4000/jvm/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8</id><content type="html" xml:base="http://localhost:4000/jvm/classloader">&lt;h3 id=&quot;ç±»åŠ è½½å™¨&quot;&gt;ç±»åŠ è½½å™¨&lt;/h3&gt;

&lt;p&gt;æŠŠå®ç°ç±»åŠ è½½é˜¶æ®µä¸­çš„â€œé€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµâ€è¿™ä¸ªåŠ¨ä½œçš„ä»£ç æ¨¡å—ç§°ä¸ºâ€œç±»åŠ è½½å™¨â€ã€‚&lt;/p&gt;

&lt;p&gt;å°† class æ–‡ä»¶äºŒè¿›åˆ¶æ•°æ®æ”¾å…¥æ–¹æ³•åŒºå†…ï¼Œç„¶ååœ¨å †å†…ï¼ˆheapï¼‰åˆ›å»ºä¸€ä¸ª java.lang.Class å¯¹è±¡ï¼ŒClass å¯¹è±¡å°è£…äº†ç±»åœ¨æ–¹æ³•åŒºå†…çš„æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”å‘å¼€å‘è€…æä¾›äº†è®¿é—®æ–¹æ³•åŒºå†…çš„æ•°æ®ç»“æ„çš„æ¥å£ã€‚&lt;/p&gt;

&lt;p&gt;ç›®å‰ç±»åŠ è½½å™¨å´åœ¨ç±»å±‚æ¬¡åˆ’åˆ†ã€OSGiã€çƒ­éƒ¨ç½²ã€ä»£ç åŠ å¯†ç­‰é¢†åŸŸéå¸¸é‡è¦ï¼Œæˆ‘ä»¬è¿è¡Œä»»ä½•ä¸€ä¸ª Java ç¨‹åºéƒ½ä¼šæ¶‰åŠåˆ°ç±»åŠ è½½å™¨ã€‚&lt;/p&gt;

&lt;h4 id=&quot;ç±»çš„å”¯ä¸€æ€§å’Œç±»åŠ è½½å™¨&quot;&gt;ç±»çš„å”¯ä¸€æ€§å’Œç±»åŠ è½½å™¨&lt;/h4&gt;

&lt;p&gt;å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½éœ€è¦ç”±åŠ è½½å®ƒçš„ç±»åŠ è½½å™¨å’Œè¿™ä¸ªç±»æœ¬èº«ä¸€åŒç¡®ç«‹å…¶åœ¨Javaè™šæ‹Ÿæœºä¸­çš„å”¯ä¸€æ€§ã€‚&lt;/p&gt;

&lt;p&gt;å³ä½¿ä¸¤ä¸ªç±»æ¥æºäºåŒä¸€ä¸ª Class æ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½å®ƒä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£è¿™ä¸¤ä¸ªç±»ä¹Ÿä¸ç›¸ç­‰ã€‚
è¿™é‡Œæ‰€æŒ‡çš„â€œç›¸ç­‰â€ï¼ŒåŒ…æ‹¬ä»£è¡¨ç±»çš„ Class å¯¹è±¡çš„ equals() æ–¹æ³•ã€ isAssignableFrom() æ–¹æ³•ã€isInstance() æ–¹æ³•çš„è¿”å›ç»“æœï¼Œä¹ŸåŒ…æ‹¬ä½¿ç”¨ instanceof å…³é”®å­—åšå¯¹è±¡æ‰€å±å…³ç³»åˆ¤å®šç­‰æƒ…å†µã€‚&lt;/p&gt;

&lt;h4 id=&quot;åŒäº²å§”æ´¾æ¨¡å‹&quot;&gt;åŒäº²å§”æ´¾æ¨¡å‹&lt;/h4&gt;

&lt;p&gt;å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½çš„è¯·æ±‚ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼Œæ¯ä¸€ä¸ªå±‚æ¬¡çš„ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œå› æ­¤æ‰€æœ‰çš„åŠ è½½è¯·æ±‚æœ€ç»ˆéƒ½åº”è¯¥ä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¸­ï¼Œåªæœ‰å½“çˆ¶åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½è¯·æ±‚ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jvm/14923529-7ca333cbae4c1edd.png&quot; alt=&quot;pic2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™é‡Œç±»åŠ è½½å™¨ä¹‹é—´çš„çˆ¶å­å…³ç³»ä¸€èˆ¬ä¸ä¼šä»¥ç»§æ‰¿ï¼ˆInheritanceï¼‰çš„å…³ç³»æ¥å®ç°ï¼Œè€Œæ˜¯éƒ½ä½¿ç”¨ç»„åˆï¼ˆCompositionï¼‰å…³ç³»æ¥å¤ç”¨çˆ¶åŠ è½½å™¨çš„ä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;Bootstrap ç±»åŠ è½½å™¨æ˜¯ç”¨ C++ å®ç°çš„ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœè·å–å®ƒçš„å¯¹è±¡ï¼Œå°†ä¼šè¿”å› nullï¼›æ‰©å±•ç±»åŠ è½½å™¨å’Œåº”ç”¨ç±»åŠ è½½å™¨æ˜¯ç‹¬ç«‹äºè™šæ‹Ÿæœºå¤–éƒ¨ï¼Œä¸º Java è¯­è¨€å®ç°çš„ï¼Œå‡ç»§æ‰¿è‡ªæŠ½è±¡ç±» java.lang.ClassLoader ï¼Œå¼€å‘è€…å¯ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªç±»åŠ è½½å™¨ã€‚&lt;/p&gt;

&lt;p&gt;Application ç±»åŠ è½½å™¨å¯¹è±¡å¯ä»¥ç”± &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ClassLoader.getSystemClassLoader()&lt;/code&gt; æ–¹æ³•çš„è¿”å›ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¹Ÿç§°å®ƒä¸ºç³»ç»Ÿç±»åŠ è½½å™¨ã€‚å®ƒè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆClassPathï¼‰ä¸Šæ‰€æŒ‡å®šçš„ç±»åº“ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰è‡ªå®šä¹‰è¿‡è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªå°±æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ã€‚&lt;/p&gt;

&lt;p&gt;åŒäº²å§”æ´¾æ¨¡å‹å¯¹äºä¿è¯ Java ç¨‹åºçš„ç¨³å®šè¿ä½œå¾ˆé‡è¦ï¼Œä¾‹å¦‚ç±» &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;java.lang.Object&lt;/code&gt;ï¼Œå®ƒå­˜æ”¾åœ¨ rt.jar ä¹‹ä¸­ï¼Œæ— è®ºå“ªä¸€ä¸ªç±»åŠ è½½å™¨è¦åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ´¾ç»™å¤„äºæ¨¡å‹æœ€é¡¶ç«¯çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œå› æ­¤ Object ç±»åœ¨ç¨‹åºçš„å„ç§ç±»åŠ è½½å™¨ç¯å¢ƒä¸­éƒ½æ˜¯åŒä¸€ä¸ªç±»ã€‚&lt;/p&gt;

&lt;p&gt;åŒäº²å§”æ´¾æ¨¡å‹çš„åŠ è½½ç±»é€»è¾‘å¯å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ä»£ç æ‘˜è‡ªã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;?&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loadClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ClassNotFoundException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// é¦–å…ˆï¼Œæ£€æŸ¥è¯·æ±‚çš„ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½è¿‡äº†&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findLoadedClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findBootstrapClassOrNull&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ClassNotFoundException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// å¦‚æœçˆ¶ç±»åŠ è½½å™¨æŠ›å‡ºClassNotFoundException&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// è¯´æ˜çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®ŒæˆåŠ è½½è¯·æ±‚&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// åœ¨çˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½çš„æ—¶å€™&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// å†è°ƒç”¨æœ¬èº«çš„findClassæ–¹æ³•æ¥è¿›è¡Œç±»åŠ è½½&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;resolveClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;ç ´ååŒäº²å§”æ´¾æ¨¡å‹&quot;&gt;ç ´ååŒäº²å§”æ´¾æ¨¡å‹&lt;/h4&gt;

&lt;p&gt;åŒäº²å§”æ´¾æ¨¡å‹ä¸»è¦å‡ºç°è¿‡ 3 è¾ƒå¤§è§„æ¨¡çš„â€œè¢«ç ´åâ€æƒ…å†µã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;åŒäº²å§”æ´¾æ¨¡å‹åœ¨å¼•å…¥ä¹‹å‰å·²ç»å­˜åœ¨ç ´åå®ƒçš„ä»£ç å­˜åœ¨äº†ã€‚
åŒäº²å§”æ´¾æ¨¡å‹åœ¨ JDK 1.2 ä¹‹åæ‰è¢«å¼•å…¥ï¼Œè€Œç±»åŠ è½½å™¨å’ŒæŠ½è±¡ç±» java.lang.ClassLoader åˆ™åœ¨ JDK 1.0 æ—¶ä»£å°±å·²ç»å­˜åœ¨ï¼ŒJDK 1.2ä¹‹åï¼Œå…¶æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ protected æ–¹æ³• findClass()ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œç”¨æˆ·å»ç»§æ‰¿ ClassLoader ç±»çš„å”¯ä¸€ç›®çš„å°±æ˜¯ä¸ºäº†é‡å†™ loadClass() æ–¹æ³•ï¼Œè€ŒåŒäº²å§”æ´¾çš„å…·ä½“é€»è¾‘å°±å®ç°åœ¨è¿™ä¸ªæ–¹æ³•ä¹‹ä¸­ï¼ŒJDK 1.2 ä¹‹åå·²ä¸æå€¡ç”¨æˆ·å†å»è¦†ç›– loadClass() æ–¹æ³•ï¼Œè€Œåº”å½“æŠŠè‡ªå·±çš„ç±»åŠ è½½é€»è¾‘å†™åˆ° findClass() æ–¹æ³•ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯æ–°å†™å‡ºæ¥çš„ç±»åŠ è½½å™¨æ˜¯ç¬¦åˆåŒäº²å§”æ´¾è§„åˆ™çš„ã€‚&lt;/li&gt;
  &lt;li&gt;åŸºç¡€ç±»æ— æ³•è°ƒç”¨ç±»åŠ è½½å™¨åŠ è½½ç”¨æˆ·æä¾›çš„ä»£ç ã€‚
åŒäº²å§”æ´¾å¾ˆå¥½åœ°è§£å†³äº†å„ä¸ªç±»åŠ è½½å™¨çš„åŸºç¡€ç±»çš„ç»Ÿä¸€é—®é¢˜ï¼ˆè¶ŠåŸºç¡€çš„ç±»ç”±è¶Šä¸Šå±‚çš„åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼‰ï¼Œä½†å¦‚æœåŸºç¡€ç±»åˆè¦è°ƒç”¨ç”¨æˆ·çš„ä»£ç ï¼Œä¾‹å¦‚ JNDI æœåŠ¡ï¼ŒJNDI ç°åœ¨å·²ç»æ˜¯ Java çš„æ ‡å‡†æœåŠ¡ï¼Œå®ƒçš„ä»£ç ç”±å¯åŠ¨ç±»åŠ è½½å™¨å»åŠ è½½ï¼ˆåœ¨ JDK 1.3 æ—¶æ”¾è¿›å»çš„ rt.jar ï¼‰ï¼Œä½† JNDI çš„ç›®çš„å°±æ˜¯å¯¹èµ„æºè¿›è¡Œé›†ä¸­ç®¡ç†å’ŒæŸ¥æ‰¾ï¼Œå®ƒéœ€è¦è°ƒç”¨ç”±ç‹¬ç«‹å‚å•†å®ç°å¹¶éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºçš„ ClassPath ä¸‹çš„ JNDI æ¥å£æä¾›è€…ï¼ˆSPI,Service Provider Interfaceï¼Œä¾‹å¦‚ JDBC é©±åŠ¨å°±æ˜¯ç”± MySQL ç­‰æ¥å£æä¾›è€…æä¾›çš„ï¼‰çš„ä»£ç ï¼Œä½†å¯åŠ¨ç±»åŠ è½½å™¨åªèƒ½åŠ è½½åŸºç¡€ç±»ï¼Œæ— æ³•åŠ è½½ç”¨æˆ·ç±»ã€‚
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ä¸ºæ­¤ Java å¼•å…¥äº†çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆThread Context ClassLoaderï¼‰ã€‚è¿™ä¸ªç±»åŠ è½½å™¨å¯ä»¥é€šè¿‡ java.lang.Thread.setContextClassLoaser() æ–¹æ³•è¿›è¡Œè®¾ç½®ï¼Œå¦‚æœåˆ›å»ºçº¿ç¨‹æ—¶è¿˜æœªè®¾ç½®ï¼Œå®ƒå°†ä¼šä»çˆ¶çº¿ç¨‹ä¸­ç»§æ‰¿ä¸€ä¸ªï¼Œå¦‚æœåœ¨åº”ç”¨ç¨‹åºçš„å…¨å±€èŒƒå›´å†…éƒ½æ²¡æœ‰è®¾ç½®è¿‡çš„è¯ï¼Œé‚£è¿™ä¸ªç±»åŠ è½½å™¨é»˜è®¤å°±æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ã€‚
å¦‚æ­¤ï¼ŒJNDI æœåŠ¡ä½¿ç”¨è¿™ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å»åŠ è½½æ‰€éœ€è¦çš„ SPI ä»£ç ï¼Œä¹Ÿå°±æ˜¯çˆ¶ç±»åŠ è½½å™¨è¯·æ±‚å­ç±»åŠ è½½å™¨å»å®Œæˆç±»åŠ è½½çš„åŠ¨ä½œï¼Œè¿™ç§è¡Œä¸ºå®é™…ä¸Šå°±æ˜¯æ‰“é€šäº†åŒäº²å§”æ´¾æ¨¡å‹çš„å±‚æ¬¡ç»“æ„æ¥é€†å‘ä½¿ç”¨ç±»åŠ è½½å™¨ï¼Œå®é™…ä¸Šå·²ç»è¿èƒŒäº†åŒäº²å§”æ´¾æ¨¡å‹çš„ä¸€èˆ¬æ€§åŸåˆ™ï¼Œä½†è¿™ä¹Ÿæ˜¯æ— å¯å¥ˆä½•çš„äº‹æƒ…ã€‚Java ä¸­æ‰€æœ‰æ¶‰åŠ SPI çš„åŠ è½½åŠ¨ä½œåŸºæœ¬ä¸Šéƒ½é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œä¾‹å¦‚ JNDIã€JDBCã€JCEã€JAXB å’Œ JBI ç­‰ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;ç”¨æˆ·å¯¹ç¨‹åºåŠ¨æ€æ€§çš„è¿½æ±‚ã€‚
ä»£ç çƒ­æ›¿æ¢ï¼ˆHotSwapï¼‰ã€æ¨¡å—çƒ­éƒ¨ç½²ï¼ˆHot Deploymentï¼‰ç­‰ï¼ŒOSGi å®ç°æ¨¡å—åŒ–çƒ­éƒ¨ç½²çš„å…³é”®åˆ™æ˜¯å®ƒè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨æœºåˆ¶çš„å®ç°ã€‚æ¯ä¸€ä¸ªç¨‹åºæ¨¡å—ï¼ˆBundleï¼‰éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œå½“éœ€è¦æ›´æ¢ä¸€ä¸ª Bundle æ—¶ï¼Œå°±æŠŠ Bundle è¿åŒç±»åŠ è½½å™¨ä¸€èµ·æ¢æ‰ä»¥å®ç°ä»£ç çš„çƒ­æ›¿æ¢ã€‚
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;åœ¨ OSGi ç¯å¢ƒä¸‹ï¼Œç±»åŠ è½½å™¨ä¸å†æ˜¯åŒäº²å§”æ´¾æ¨¡å‹ä¸­çš„æ ‘çŠ¶ç»“æ„ï¼Œè€Œæ˜¯è¿›ä¸€æ­¥å‘å±•ä¸ºæ›´åŠ å¤æ‚çš„ç½‘çŠ¶ç»“æ„ï¼Œå½“æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚æ—¶ï¼ŒOSGi å°†æŒ‰ç…§ä¸‹é¢çš„é¡ºåºè¿›è¡Œç±»æœç´¢ï¼š
1ï¼‰å°†ä»¥ java.* å¼€å¤´çš„ç±»å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨åŠ è½½ã€‚
2ï¼‰å¦åˆ™ï¼Œå°†å§”æ´¾åˆ—è¡¨åå•å†…çš„ç±»å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨åŠ è½½ã€‚
3ï¼‰å¦åˆ™ï¼Œå°† Import åˆ—è¡¨ä¸­çš„ç±»å§”æ´¾ç»™ Export è¿™ä¸ªç±»çš„ Bundle çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚
4ï¼‰å¦åˆ™ï¼ŒæŸ¥æ‰¾å½“å‰ Bundle çš„ ClassPathï¼Œä½¿ç”¨è‡ªå·±çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚
5ï¼‰å¦åˆ™ï¼ŒæŸ¥æ‰¾ç±»æ˜¯å¦åœ¨è‡ªå·±çš„ Fragment Bundle ä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™å§”æ´¾ç»™ Fragment Bundle çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚
6ï¼‰å¦åˆ™ï¼ŒæŸ¥æ‰¾ Dynamic Import åˆ—è¡¨çš„ Bundleï¼Œå§”æ´¾ç»™å¯¹åº” Bundle çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚
7ï¼‰å¦åˆ™ï¼Œç±»æŸ¥æ‰¾å¤±è´¥ã€‚
ä¸Šé¢çš„æŸ¥æ‰¾é¡ºåºä¸­åªæœ‰å¼€å¤´ä¸¤ç‚¹ä»ç„¶ç¬¦åˆåŒäº²å§”æ´¾è§„åˆ™ï¼Œå…¶ä½™çš„ç±»æŸ¥æ‰¾éƒ½æ˜¯åœ¨å¹³çº§çš„ç±»åŠ è½½å™¨ä¸­è¿›è¡Œçš„ã€‚OSGi çš„ Bundle ç±»åŠ è½½å™¨ä¹‹é—´åªæœ‰è§„åˆ™ï¼Œæ²¡æœ‰å›ºå®šçš„å§”æ´¾å…³ç³»ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="jvm" /><category term="ç±»åŠ è½½å™¨" /><summary type="html">ç±»åŠ è½½å™¨ æŠŠå®ç°ç±»åŠ è½½é˜¶æ®µä¸­çš„â€œé€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµâ€è¿™ä¸ªåŠ¨ä½œçš„ä»£ç æ¨¡å—ç§°ä¸ºâ€œç±»åŠ è½½å™¨â€ã€‚ å°† class æ–‡ä»¶äºŒè¿›åˆ¶æ•°æ®æ”¾å…¥æ–¹æ³•åŒºå†…ï¼Œç„¶ååœ¨å †å†…ï¼ˆheapï¼‰åˆ›å»ºä¸€ä¸ª java.lang.Class å¯¹è±¡ï¼ŒClass å¯¹è±¡å°è£…äº†ç±»åœ¨æ–¹æ³•åŒºå†…çš„æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”å‘å¼€å‘è€…æä¾›äº†è®¿é—®æ–¹æ³•åŒºå†…çš„æ•°æ®ç»“æ„çš„æ¥å£ã€‚ ç›®å‰ç±»åŠ è½½å™¨å´åœ¨ç±»å±‚æ¬¡åˆ’åˆ†ã€OSGiã€çƒ­éƒ¨ç½²ã€ä»£ç åŠ å¯†ç­‰é¢†åŸŸéå¸¸é‡è¦ï¼Œæˆ‘ä»¬è¿è¡Œä»»ä½•ä¸€ä¸ª Java ç¨‹åºéƒ½ä¼šæ¶‰åŠåˆ°ç±»åŠ è½½å™¨ã€‚ ç±»çš„å”¯ä¸€æ€§å’Œç±»åŠ è½½å™¨ å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½éœ€è¦ç”±åŠ è½½å®ƒçš„ç±»åŠ è½½å™¨å’Œè¿™ä¸ªç±»æœ¬èº«ä¸€åŒç¡®ç«‹å…¶åœ¨Javaè™šæ‹Ÿæœºä¸­çš„å”¯ä¸€æ€§ã€‚ å³ä½¿ä¸¤ä¸ªç±»æ¥æºäºåŒä¸€ä¸ª Class æ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½å®ƒä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£è¿™ä¸¤ä¸ªç±»ä¹Ÿä¸ç›¸ç­‰ã€‚ è¿™é‡Œæ‰€æŒ‡çš„â€œç›¸ç­‰â€ï¼ŒåŒ…æ‹¬ä»£è¡¨ç±»çš„ Class å¯¹è±¡çš„ equals() æ–¹æ³•ã€ isAssignableFrom() æ–¹æ³•ã€isInstance() æ–¹æ³•çš„è¿”å›ç»“æœï¼Œä¹ŸåŒ…æ‹¬ä½¿ç”¨ instanceof å…³é”®å­—åšå¯¹è±¡æ‰€å±å…³ç³»åˆ¤å®šç­‰æƒ…å†µã€‚ åŒäº²å§”æ´¾æ¨¡å‹ å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½çš„è¯·æ±‚ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼Œæ¯ä¸€ä¸ªå±‚æ¬¡çš„ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œå› æ­¤æ‰€æœ‰çš„åŠ è½½è¯·æ±‚æœ€ç»ˆéƒ½åº”è¯¥ä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¸­ï¼Œåªæœ‰å½“çˆ¶åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½è¯·æ±‚ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚ è¿™é‡Œç±»åŠ è½½å™¨ä¹‹é—´çš„çˆ¶å­å…³ç³»ä¸€èˆ¬ä¸ä¼šä»¥ç»§æ‰¿ï¼ˆInheritanceï¼‰çš„å…³ç³»æ¥å®ç°ï¼Œè€Œæ˜¯éƒ½ä½¿ç”¨ç»„åˆï¼ˆCompositionï¼‰å…³ç³»æ¥å¤ç”¨çˆ¶åŠ è½½å™¨çš„ä»£ç ã€‚ Bootstrap ç±»åŠ è½½å™¨æ˜¯ç”¨ C++ å®ç°çš„ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœè·å–å®ƒçš„å¯¹è±¡ï¼Œå°†ä¼šè¿”å› nullï¼›æ‰©å±•ç±»åŠ è½½å™¨å’Œåº”ç”¨ç±»åŠ è½½å™¨æ˜¯ç‹¬ç«‹äºè™šæ‹Ÿæœºå¤–éƒ¨ï¼Œä¸º Java è¯­è¨€å®ç°çš„ï¼Œå‡ç»§æ‰¿è‡ªæŠ½è±¡ç±» java.lang.ClassLoader ï¼Œå¼€å‘è€…å¯ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªç±»åŠ è½½å™¨ã€‚ Application ç±»åŠ è½½å™¨å¯¹è±¡å¯ä»¥ç”± ClassLoader.getSystemClassLoader() æ–¹æ³•çš„è¿”å›ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¹Ÿç§°å®ƒä¸ºç³»ç»Ÿç±»åŠ è½½å™¨ã€‚å®ƒè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆClassPathï¼‰ä¸Šæ‰€æŒ‡å®šçš„ç±»åº“ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰è‡ªå®šä¹‰è¿‡è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªå°±æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ã€‚ åŒäº²å§”æ´¾æ¨¡å‹å¯¹äºä¿è¯ Java ç¨‹åºçš„ç¨³å®šè¿ä½œå¾ˆé‡è¦ï¼Œä¾‹å¦‚ç±» java.lang.Objectï¼Œå®ƒå­˜æ”¾åœ¨ rt.jar ä¹‹ä¸­ï¼Œæ— è®ºå“ªä¸€ä¸ªç±»åŠ è½½å™¨è¦åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ´¾ç»™å¤„äºæ¨¡å‹æœ€é¡¶ç«¯çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œå› æ­¤ Object ç±»åœ¨ç¨‹åºçš„å„ç§ç±»åŠ è½½å™¨ç¯å¢ƒä¸­éƒ½æ˜¯åŒä¸€ä¸ªç±»ã€‚ åŒäº²å§”æ´¾æ¨¡å‹çš„åŠ è½½ç±»é€»è¾‘å¯å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š // ä»£ç æ‘˜è‡ªã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ protected synchronized Class&amp;lt;?&amp;gt; loadClass(String name, boolean resolve) throws ClassNotFoundException { // é¦–å…ˆï¼Œæ£€æŸ¥è¯·æ±‚çš„ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½è¿‡äº† Class c = findLoadedClass(name); if (c == null) { try { if (parent != null) { c = parent.loadClass(name, false); } else { c = findBootstrapClassOrNull(name); } } catch (ClassNotFoundException e) { // å¦‚æœçˆ¶ç±»åŠ è½½å™¨æŠ›å‡ºClassNotFoundException // è¯´æ˜çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®ŒæˆåŠ è½½è¯·æ±‚ } if (c == null) { // åœ¨çˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½çš„æ—¶å€™ // å†è°ƒç”¨æœ¬èº«çš„findClassæ–¹æ³•æ¥è¿›è¡Œç±»åŠ è½½ c = findClass(name); } } if (resolve) { resolveClass(c); } return c; } ç ´ååŒäº²å§”æ´¾æ¨¡å‹ åŒäº²å§”æ´¾æ¨¡å‹ä¸»è¦å‡ºç°è¿‡ 3 è¾ƒå¤§è§„æ¨¡çš„â€œè¢«ç ´åâ€æƒ…å†µã€‚ åŒäº²å§”æ´¾æ¨¡å‹åœ¨å¼•å…¥ä¹‹å‰å·²ç»å­˜åœ¨ç ´åå®ƒçš„ä»£ç å­˜åœ¨äº†ã€‚ åŒäº²å§”æ´¾æ¨¡å‹åœ¨ JDK 1.2 ä¹‹åæ‰è¢«å¼•å…¥ï¼Œè€Œç±»åŠ è½½å™¨å’ŒæŠ½è±¡ç±» java.lang.ClassLoader åˆ™åœ¨ JDK 1.0 æ—¶ä»£å°±å·²ç»å­˜åœ¨ï¼ŒJDK 1.2ä¹‹åï¼Œå…¶æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ protected æ–¹æ³• findClass()ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œç”¨æˆ·å»ç»§æ‰¿ ClassLoader ç±»çš„å”¯ä¸€ç›®çš„å°±æ˜¯ä¸ºäº†é‡å†™ loadClass() æ–¹æ³•ï¼Œè€ŒåŒäº²å§”æ´¾çš„å…·ä½“é€»è¾‘å°±å®ç°åœ¨è¿™ä¸ªæ–¹æ³•ä¹‹ä¸­ï¼ŒJDK 1.2 ä¹‹åå·²ä¸æå€¡ç”¨æˆ·å†å»è¦†ç›– loadClass() æ–¹æ³•ï¼Œè€Œåº”å½“æŠŠè‡ªå·±çš„ç±»åŠ è½½é€»è¾‘å†™åˆ° findClass() æ–¹æ³•ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯æ–°å†™å‡ºæ¥çš„ç±»åŠ è½½å™¨æ˜¯ç¬¦åˆåŒäº²å§”æ´¾è§„åˆ™çš„ã€‚ åŸºç¡€ç±»æ— æ³•è°ƒç”¨ç±»åŠ è½½å™¨åŠ è½½ç”¨æˆ·æä¾›çš„ä»£ç ã€‚ åŒäº²å§”æ´¾å¾ˆå¥½åœ°è§£å†³äº†å„ä¸ªç±»åŠ è½½å™¨çš„åŸºç¡€ç±»çš„ç»Ÿä¸€é—®é¢˜ï¼ˆè¶ŠåŸºç¡€çš„ç±»ç”±è¶Šä¸Šå±‚çš„åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼‰ï¼Œä½†å¦‚æœåŸºç¡€ç±»åˆè¦è°ƒç”¨ç”¨æˆ·çš„ä»£ç ï¼Œä¾‹å¦‚ JNDI æœåŠ¡ï¼ŒJNDI ç°åœ¨å·²ç»æ˜¯ Java çš„æ ‡å‡†æœåŠ¡ï¼Œå®ƒçš„ä»£ç ç”±å¯åŠ¨ç±»åŠ è½½å™¨å»åŠ è½½ï¼ˆåœ¨ JDK 1.3 æ—¶æ”¾è¿›å»çš„ rt.jar ï¼‰ï¼Œä½† JNDI çš„ç›®çš„å°±æ˜¯å¯¹èµ„æºè¿›è¡Œé›†ä¸­ç®¡ç†å’ŒæŸ¥æ‰¾ï¼Œå®ƒéœ€è¦è°ƒç”¨ç”±ç‹¬ç«‹å‚å•†å®ç°å¹¶éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºçš„ ClassPath ä¸‹çš„ JNDI æ¥å£æä¾›è€…ï¼ˆSPI,Service Provider Interfaceï¼Œä¾‹å¦‚ JDBC é©±åŠ¨å°±æ˜¯ç”± MySQL ç­‰æ¥å£æä¾›è€…æä¾›çš„ï¼‰çš„ä»£ç ï¼Œä½†å¯åŠ¨ç±»åŠ è½½å™¨åªèƒ½åŠ è½½åŸºç¡€ç±»ï¼Œæ— æ³•åŠ è½½ç”¨æˆ·ç±»ã€‚ ä¸ºæ­¤ Java å¼•å…¥äº†çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆThread Context ClassLoaderï¼‰ã€‚è¿™ä¸ªç±»åŠ è½½å™¨å¯ä»¥é€šè¿‡ java.lang.Thread.setContextClassLoaser() æ–¹æ³•è¿›è¡Œè®¾ç½®ï¼Œå¦‚æœåˆ›å»ºçº¿ç¨‹æ—¶è¿˜æœªè®¾ç½®ï¼Œå®ƒå°†ä¼šä»çˆ¶çº¿ç¨‹ä¸­ç»§æ‰¿ä¸€ä¸ªï¼Œå¦‚æœåœ¨åº”ç”¨ç¨‹åºçš„å…¨å±€èŒƒå›´å†…éƒ½æ²¡æœ‰è®¾ç½®è¿‡çš„è¯ï¼Œé‚£è¿™ä¸ªç±»åŠ è½½å™¨é»˜è®¤å°±æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ã€‚ å¦‚æ­¤ï¼ŒJNDI æœåŠ¡ä½¿ç”¨è¿™ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å»åŠ è½½æ‰€éœ€è¦çš„ SPI ä»£ç ï¼Œä¹Ÿå°±æ˜¯çˆ¶ç±»åŠ è½½å™¨è¯·æ±‚å­ç±»åŠ è½½å™¨å»å®Œæˆç±»åŠ è½½çš„åŠ¨ä½œï¼Œè¿™ç§è¡Œä¸ºå®é™…ä¸Šå°±æ˜¯æ‰“é€šäº†åŒäº²å§”æ´¾æ¨¡å‹çš„å±‚æ¬¡ç»“æ„æ¥é€†å‘ä½¿ç”¨ç±»åŠ è½½å™¨ï¼Œå®é™…ä¸Šå·²ç»è¿èƒŒäº†åŒäº²å§”æ´¾æ¨¡å‹çš„ä¸€èˆ¬æ€§åŸåˆ™ï¼Œä½†è¿™ä¹Ÿæ˜¯æ— å¯å¥ˆä½•çš„äº‹æƒ…ã€‚Java ä¸­æ‰€æœ‰æ¶‰åŠ SPI çš„åŠ è½½åŠ¨ä½œåŸºæœ¬ä¸Šéƒ½é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œä¾‹å¦‚ JNDIã€JDBCã€JCEã€JAXB å’Œ JBI ç­‰ã€‚ ç”¨æˆ·å¯¹ç¨‹åºåŠ¨æ€æ€§çš„è¿½æ±‚ã€‚ ä»£ç çƒ­æ›¿æ¢ï¼ˆHotSwapï¼‰ã€æ¨¡å—çƒ­éƒ¨ç½²ï¼ˆHot Deploymentï¼‰ç­‰ï¼ŒOSGi å®ç°æ¨¡å—åŒ–çƒ­éƒ¨ç½²çš„å…³é”®åˆ™æ˜¯å®ƒè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨æœºåˆ¶çš„å®ç°ã€‚æ¯ä¸€ä¸ªç¨‹åºæ¨¡å—ï¼ˆBundleï¼‰éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œå½“éœ€è¦æ›´æ¢ä¸€ä¸ª Bundle æ—¶ï¼Œå°±æŠŠ Bundle è¿åŒç±»åŠ è½½å™¨ä¸€èµ·æ¢æ‰ä»¥å®ç°ä»£ç çš„çƒ­æ›¿æ¢ã€‚ åœ¨ OSGi ç¯å¢ƒä¸‹ï¼Œç±»åŠ è½½å™¨ä¸å†æ˜¯åŒäº²å§”æ´¾æ¨¡å‹ä¸­çš„æ ‘çŠ¶ç»“æ„ï¼Œè€Œæ˜¯è¿›ä¸€æ­¥å‘å±•ä¸ºæ›´åŠ å¤æ‚çš„ç½‘çŠ¶ç»“æ„ï¼Œå½“æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚æ—¶ï¼ŒOSGi å°†æŒ‰ç…§ä¸‹é¢çš„é¡ºåºè¿›è¡Œç±»æœç´¢ï¼š 1ï¼‰å°†ä»¥ java.* å¼€å¤´çš„ç±»å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨åŠ è½½ã€‚ 2ï¼‰å¦åˆ™ï¼Œå°†å§”æ´¾åˆ—è¡¨åå•å†…çš„ç±»å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨åŠ è½½ã€‚ 3ï¼‰å¦åˆ™ï¼Œå°† Import åˆ—è¡¨ä¸­çš„ç±»å§”æ´¾ç»™ Export è¿™ä¸ªç±»çš„ Bundle çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚ 4ï¼‰å¦åˆ™ï¼ŒæŸ¥æ‰¾å½“å‰ Bundle çš„ ClassPathï¼Œä½¿ç”¨è‡ªå·±çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚ 5ï¼‰å¦åˆ™ï¼ŒæŸ¥æ‰¾ç±»æ˜¯å¦åœ¨è‡ªå·±çš„ Fragment Bundle ä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™å§”æ´¾ç»™ Fragment Bundle çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚ 6ï¼‰å¦åˆ™ï¼ŒæŸ¥æ‰¾ Dynamic Import åˆ—è¡¨çš„ Bundleï¼Œå§”æ´¾ç»™å¯¹åº” Bundle çš„ç±»åŠ è½½å™¨åŠ è½½ã€‚ 7ï¼‰å¦åˆ™ï¼Œç±»æŸ¥æ‰¾å¤±è´¥ã€‚ ä¸Šé¢çš„æŸ¥æ‰¾é¡ºåºä¸­åªæœ‰å¼€å¤´ä¸¤ç‚¹ä»ç„¶ç¬¦åˆåŒäº²å§”æ´¾è§„åˆ™ï¼Œå…¶ä½™çš„ç±»æŸ¥æ‰¾éƒ½æ˜¯åœ¨å¹³çº§çš„ç±»åŠ è½½å™¨ä¸­è¿›è¡Œçš„ã€‚OSGi çš„ Bundle ç±»åŠ è½½å™¨ä¹‹é—´åªæœ‰è§„åˆ™ï¼Œæ²¡æœ‰å›ºå®šçš„å§”æ´¾å…³ç³»ã€‚</summary></entry><entry><title type="html">æ·±å…¥ç†è§£Javaç±»åŠ è½½</title><link href="http://localhost:4000/jvm/classloader/deep" rel="alternate" type="text/html" title="æ·±å…¥ç†è§£Javaç±»åŠ è½½" /><published>2020-06-15T00:00:00+08:00</published><updated>2020-06-15T00:00:00+08:00</updated><id>http://localhost:4000/jvm/classloader/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E7%B1%BB%E5%8A%A0%E8%BD%BD</id><content type="html" xml:base="http://localhost:4000/jvm/classloader/deep">&lt;h3 id=&quot;javaè™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶&quot;&gt;Javaè™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶&lt;/h3&gt;

&lt;p&gt;è™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä» Class æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è½¬æ¢è§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„ Java ç±»å‹ï¼Œè¿™å°±æ˜¯è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨Javaè¯­è¨€é‡Œé¢ï¼Œç±»å‹çš„åŠ è½½ã€è¿æ¥å’Œåˆå§‹åŒ–è¿‡ç¨‹éƒ½æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å®Œæˆçš„&lt;/p&gt;

&lt;h4 id=&quot;ç±»åŠ è½½çš„è¿‡ç¨‹&quot;&gt;ç±»åŠ è½½çš„è¿‡ç¨‹&lt;/h4&gt;

&lt;p&gt;ç±»çš„ä¸ªç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jvm/14923529-ac753500687cf9d2.png&quot; alt=&quot;pic1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸ºæ”¯æŒè¿è¡Œæ—¶ç»‘å®šï¼Œè§£æè¿‡ç¨‹åœ¨æŸäº›æƒ…å†µä¸‹å¯åœ¨åˆå§‹åŒ–ä¹‹åå†å¼€å§‹ï¼Œé™¤è§£æè¿‡ç¨‹å¤–çš„å…¶ä»–åŠ è½½è¿‡ç¨‹å¿…é¡»æŒ‰ç…§å¦‚å›¾é¡ºåºå¼€å§‹ã€‚&lt;/p&gt;

&lt;h4 id=&quot;åŠ è½½&quot;&gt;åŠ è½½&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;é€šè¿‡å…¨é™å®šç±»åæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚&lt;/li&gt;
  &lt;li&gt;å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚&lt;/li&gt;
  &lt;li&gt;åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„ java.lang.Class å¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;éªŒè¯&quot;&gt;éªŒè¯&lt;/h4&gt;

&lt;p&gt;éªŒè¯æ˜¯è¿æ¥é˜¶æ®µçš„ç¬¬ä¸€æ­¥ï¼Œè¿™ä¸€é˜¶æ®µçš„ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿ Class æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ–‡ä»¶æ ¼å¼éªŒè¯ï¼šå¦‚æ˜¯å¦ä»¥é­”æ•° 0xCAFEBABE å¼€å¤´ã€ä¸»ã€æ¬¡ç‰ˆæœ¬å·æ˜¯å¦åœ¨å½“å‰è™šæ‹Ÿæœºå¤„ç†èŒƒå›´ä¹‹å†…ã€å¸¸é‡åˆç†æ€§éªŒè¯ç­‰ã€‚
æ­¤é˜¶æ®µä¿è¯è¾“å…¥çš„å­—èŠ‚æµèƒ½æ­£ç¡®åœ°è§£æå¹¶å­˜å‚¨äºæ–¹æ³•åŒºä¹‹å†…ï¼Œæ ¼å¼ä¸Šç¬¦åˆæè¿°ä¸€ä¸ª Javaç±»å‹ä¿¡æ¯çš„è¦æ±‚ã€‚&lt;/li&gt;
  &lt;li&gt;å…ƒæ•°æ®éªŒè¯ï¼šæ˜¯å¦å­˜åœ¨çˆ¶ç±»ï¼Œçˆ¶ç±»çš„ç»§æ‰¿é“¾æ˜¯å¦æ­£ç¡®ï¼ŒæŠ½è±¡ç±»æ˜¯å¦å®ç°äº†å…¶çˆ¶ç±»æˆ–æ¥å£ä¹‹ä¸­è¦æ±‚å®ç°çš„æ‰€æœ‰æ–¹æ³•ï¼Œå­—æ®µã€æ–¹æ³•æ˜¯å¦ä¸çˆ¶ç±»äº§ç”ŸçŸ›ç›¾ç­‰ã€‚
ç¬¬äºŒé˜¶æ®µï¼Œä¿è¯ä¸å­˜åœ¨ä¸ç¬¦åˆ Java è¯­è¨€è§„èŒƒçš„å…ƒæ•°æ®ä¿¡æ¯ã€‚&lt;/li&gt;
  &lt;li&gt;å­—èŠ‚ç éªŒè¯ï¼šé€šè¿‡æ•°æ®æµå’Œæ§åˆ¶æµåˆ†æï¼Œç¡®å®šç¨‹åºè¯­ä¹‰æ˜¯åˆæ³•çš„ã€ç¬¦åˆé€»è¾‘çš„ã€‚ä¾‹å¦‚ä¿è¯è·³è½¬æŒ‡ä»¤ä¸ä¼šè·³è½¬åˆ°æ–¹æ³•ä½“ä»¥å¤–çš„å­—èŠ‚ç æŒ‡ä»¤ä¸Šã€‚
ç¬¦å·å¼•ç”¨éªŒè¯ï¼šåœ¨è§£æé˜¶æ®µä¸­å‘ç”Ÿï¼Œä¿è¯å¯ä»¥å°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;å¯ä»¥è€ƒè™‘ä½¿ç”¨ -Xverify:none å‚æ•°æ¥å…³é—­å¤§éƒ¨åˆ†çš„ç±»éªŒè¯æªæ–½ï¼Œä»¥ç¼©çŸ­è™šæ‹Ÿæœºç±»åŠ è½½çš„æ—¶é—´ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;å‡†å¤‡&quot;&gt;å‡†å¤‡&lt;/h3&gt;

&lt;p&gt;ä¸º &lt;strong&gt;ç±»å˜é‡&lt;/strong&gt; åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼ï¼Œè¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ã€‚&lt;/p&gt;

&lt;h4 id=&quot;è§£æ&quot;&gt;è§£æ&lt;/h4&gt;

&lt;p&gt;è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚
è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ã€æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦ 7 ç±»ç¬¦å·å¼•ç”¨è¿›è¡Œã€‚&lt;/p&gt;

&lt;h4 id=&quot;åˆå§‹åŒ–&quot;&gt;åˆå§‹åŒ–&lt;/h4&gt;

&lt;p&gt;åˆ°åˆå§‹åŒ–é˜¶æ®µï¼Œæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„ Java ç¨‹åºä»£ç ï¼Œæ­¤é˜¶æ®µæ˜¯æ‰§è¡Œ &amp;lt;clinit&amp;gt;() æ–¹æ³•çš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;&amp;lt;clinit&amp;gt;() æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨æŒ‰è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºï¼Œä¾æ¬¡è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ &lt;strong&gt;ç±»å˜é‡&lt;/strong&gt; çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ã€‚ï¼ˆä¸åŒ…æ‹¬æ„é€ å™¨ä¸­çš„è¯­å¥ã€‚æ„é€ å™¨æ˜¯åˆå§‹åŒ–å¯¹è±¡çš„ï¼Œç±»åŠ è½½å®Œæˆåï¼Œåˆ›å»ºå¯¹è±¡æ—¶å€™å°†è°ƒç”¨çš„ &amp;lt;init&amp;gt;() æ–¹æ³•æ¥åˆå§‹åŒ–å¯¹è±¡ï¼‰&lt;/p&gt;

&lt;p&gt;é™æ€è¯­å¥å—ä¸­åªèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨é™æ€è¯­å¥å—ä¹‹å‰çš„å˜é‡ï¼Œå®šä¹‰åœ¨å®ƒä¹‹åçš„å˜é‡ï¼Œåœ¨å‰é¢çš„é™æ€è¯­å¥å—å¯ä»¥èµ‹å€¼ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®ï¼Œå¦‚ä¸‹ç¨‹åºï¼š&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// ç»™å˜é‡èµ‹å€¼å¯ä»¥æ­£å¸¸ç¼–è¯‘é€šè¿‡&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// è¿™å¥ç¼–è¯‘å™¨ä¼šæç¤º&quot;éæ³•å‘å‰å¼•ç”¨&quot;&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&amp;lt;clinit&amp;gt;() ä¸éœ€è¦æ˜¾å¼è°ƒç”¨çˆ¶ç±»ï¼ˆæ¥å£é™¤å¤–ï¼Œæ¥å£ä¸éœ€è¦è°ƒç”¨çˆ¶æ¥å£çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œåªæœ‰ä½¿ç”¨åˆ°çˆ¶æ¥å£ä¸­çš„é™æ€å˜é‡æ—¶æ‰éœ€è¦è°ƒç”¨ï¼‰çš„åˆå§‹åŒ–æ–¹æ³• &amp;lt;clinit&amp;gt;()ï¼Œè™šæ‹Ÿæœºä¼šä¿è¯åœ¨å­ç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿå°±æ„å‘³ç€çˆ¶ç±»ä¸­å®šä¹‰çš„é™æ€è¯­å¥å—è¦ä¼˜å…ˆäºå­ç±»çš„å˜é‡èµ‹å€¼æ“ä½œã€‚&lt;/p&gt;

&lt;p&gt;&amp;lt;clinit&amp;gt;() æ–¹æ³•å¯¹äºç±»æˆ–æ¥å£æ¥è¯´å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­æ²¡æœ‰é™æ€è¯­å¥å—ï¼Œä¹Ÿæ²¡æœ‰å¯¹å˜é‡çš„èµ‹å€¼æ“ä½œï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å¯ä»¥ä¸ä¸ºè¿™ä¸ªç±»ç”Ÿæˆ &amp;lt;clinit&amp;gt;() æ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¢«æ­£ç¡®åœ°åŠ é”ã€åŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å»åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹éƒ½éœ€è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œ &amp;lt;clinit&amp;gt;() æ–¹æ³•å®Œæ¯•ã€‚&lt;/p&gt;</content><author><name>javaç‰›ç‰›</name><email>king101125s@gmail.com</email></author><category term="post" /><category term="jvm" /><category term="ç±»åŠ è½½" /><summary type="html">Javaè™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶ è™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä» Class æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è½¬æ¢è§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„ Java ç±»å‹ï¼Œè¿™å°±æ˜¯è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶ã€‚ åœ¨Javaè¯­è¨€é‡Œé¢ï¼Œç±»å‹çš„åŠ è½½ã€è¿æ¥å’Œåˆå§‹åŒ–è¿‡ç¨‹éƒ½æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å®Œæˆçš„ ç±»åŠ è½½çš„è¿‡ç¨‹ ç±»çš„ä¸ªç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹å›¾ï¼š ä¸ºæ”¯æŒè¿è¡Œæ—¶ç»‘å®šï¼Œè§£æè¿‡ç¨‹åœ¨æŸäº›æƒ…å†µä¸‹å¯åœ¨åˆå§‹åŒ–ä¹‹åå†å¼€å§‹ï¼Œé™¤è§£æè¿‡ç¨‹å¤–çš„å…¶ä»–åŠ è½½è¿‡ç¨‹å¿…é¡»æŒ‰ç…§å¦‚å›¾é¡ºåºå¼€å§‹ã€‚ åŠ è½½ é€šè¿‡å…¨é™å®šç±»åæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚ åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„ java.lang.Class å¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚ éªŒè¯ éªŒè¯æ˜¯è¿æ¥é˜¶æ®µçš„ç¬¬ä¸€æ­¥ï¼Œè¿™ä¸€é˜¶æ®µçš„ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿ Class æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚ æ–‡ä»¶æ ¼å¼éªŒè¯ï¼šå¦‚æ˜¯å¦ä»¥é­”æ•° 0xCAFEBABE å¼€å¤´ã€ä¸»ã€æ¬¡ç‰ˆæœ¬å·æ˜¯å¦åœ¨å½“å‰è™šæ‹Ÿæœºå¤„ç†èŒƒå›´ä¹‹å†…ã€å¸¸é‡åˆç†æ€§éªŒè¯ç­‰ã€‚ æ­¤é˜¶æ®µä¿è¯è¾“å…¥çš„å­—èŠ‚æµèƒ½æ­£ç¡®åœ°è§£æå¹¶å­˜å‚¨äºæ–¹æ³•åŒºä¹‹å†…ï¼Œæ ¼å¼ä¸Šç¬¦åˆæè¿°ä¸€ä¸ª Javaç±»å‹ä¿¡æ¯çš„è¦æ±‚ã€‚ å…ƒæ•°æ®éªŒè¯ï¼šæ˜¯å¦å­˜åœ¨çˆ¶ç±»ï¼Œçˆ¶ç±»çš„ç»§æ‰¿é“¾æ˜¯å¦æ­£ç¡®ï¼ŒæŠ½è±¡ç±»æ˜¯å¦å®ç°äº†å…¶çˆ¶ç±»æˆ–æ¥å£ä¹‹ä¸­è¦æ±‚å®ç°çš„æ‰€æœ‰æ–¹æ³•ï¼Œå­—æ®µã€æ–¹æ³•æ˜¯å¦ä¸çˆ¶ç±»äº§ç”ŸçŸ›ç›¾ç­‰ã€‚ ç¬¬äºŒé˜¶æ®µï¼Œä¿è¯ä¸å­˜åœ¨ä¸ç¬¦åˆ Java è¯­è¨€è§„èŒƒçš„å…ƒæ•°æ®ä¿¡æ¯ã€‚ å­—èŠ‚ç éªŒè¯ï¼šé€šè¿‡æ•°æ®æµå’Œæ§åˆ¶æµåˆ†æï¼Œç¡®å®šç¨‹åºè¯­ä¹‰æ˜¯åˆæ³•çš„ã€ç¬¦åˆé€»è¾‘çš„ã€‚ä¾‹å¦‚ä¿è¯è·³è½¬æŒ‡ä»¤ä¸ä¼šè·³è½¬åˆ°æ–¹æ³•ä½“ä»¥å¤–çš„å­—èŠ‚ç æŒ‡ä»¤ä¸Šã€‚ ç¬¦å·å¼•ç”¨éªŒè¯ï¼šåœ¨è§£æé˜¶æ®µä¸­å‘ç”Ÿï¼Œä¿è¯å¯ä»¥å°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ã€‚ å¯ä»¥è€ƒè™‘ä½¿ç”¨ -Xverify:none å‚æ•°æ¥å…³é—­å¤§éƒ¨åˆ†çš„ç±»éªŒè¯æªæ–½ï¼Œä»¥ç¼©çŸ­è™šæ‹Ÿæœºç±»åŠ è½½çš„æ—¶é—´ã€‚ å‡†å¤‡ ä¸º ç±»å˜é‡ åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼ï¼Œè¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ã€‚ è§£æ è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ã€æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦ 7 ç±»ç¬¦å·å¼•ç”¨è¿›è¡Œã€‚ åˆå§‹åŒ– åˆ°åˆå§‹åŒ–é˜¶æ®µï¼Œæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„ Java ç¨‹åºä»£ç ï¼Œæ­¤é˜¶æ®µæ˜¯æ‰§è¡Œ &amp;lt;clinit&amp;gt;() æ–¹æ³•çš„è¿‡ç¨‹ã€‚ &amp;lt;clinit&amp;gt;() æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨æŒ‰è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºï¼Œä¾æ¬¡è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ ç±»å˜é‡ çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ã€‚ï¼ˆä¸åŒ…æ‹¬æ„é€ å™¨ä¸­çš„è¯­å¥ã€‚æ„é€ å™¨æ˜¯åˆå§‹åŒ–å¯¹è±¡çš„ï¼Œç±»åŠ è½½å®Œæˆåï¼Œåˆ›å»ºå¯¹è±¡æ—¶å€™å°†è°ƒç”¨çš„ &amp;lt;init&amp;gt;() æ–¹æ³•æ¥åˆå§‹åŒ–å¯¹è±¡ï¼‰ é™æ€è¯­å¥å—ä¸­åªèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨é™æ€è¯­å¥å—ä¹‹å‰çš„å˜é‡ï¼Œå®šä¹‰åœ¨å®ƒä¹‹åçš„å˜é‡ï¼Œåœ¨å‰é¢çš„é™æ€è¯­å¥å—å¯ä»¥èµ‹å€¼ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®ï¼Œå¦‚ä¸‹ç¨‹åºï¼š public class Test { static { // ç»™å˜é‡èµ‹å€¼å¯ä»¥æ­£å¸¸ç¼–è¯‘é€šè¿‡ i = 0; // è¿™å¥ç¼–è¯‘å™¨ä¼šæç¤º&quot;éæ³•å‘å‰å¼•ç”¨&quot; System.out.println(i); } static int i = 1; } &amp;lt;clinit&amp;gt;() ä¸éœ€è¦æ˜¾å¼è°ƒç”¨çˆ¶ç±»ï¼ˆæ¥å£é™¤å¤–ï¼Œæ¥å£ä¸éœ€è¦è°ƒç”¨çˆ¶æ¥å£çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œåªæœ‰ä½¿ç”¨åˆ°çˆ¶æ¥å£ä¸­çš„é™æ€å˜é‡æ—¶æ‰éœ€è¦è°ƒç”¨ï¼‰çš„åˆå§‹åŒ–æ–¹æ³• &amp;lt;clinit&amp;gt;()ï¼Œè™šæ‹Ÿæœºä¼šä¿è¯åœ¨å­ç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿå°±æ„å‘³ç€çˆ¶ç±»ä¸­å®šä¹‰çš„é™æ€è¯­å¥å—è¦ä¼˜å…ˆäºå­ç±»çš„å˜é‡èµ‹å€¼æ“ä½œã€‚ &amp;lt;clinit&amp;gt;() æ–¹æ³•å¯¹äºç±»æˆ–æ¥å£æ¥è¯´å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­æ²¡æœ‰é™æ€è¯­å¥å—ï¼Œä¹Ÿæ²¡æœ‰å¯¹å˜é‡çš„èµ‹å€¼æ“ä½œï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å¯ä»¥ä¸ä¸ºè¿™ä¸ªç±»ç”Ÿæˆ &amp;lt;clinit&amp;gt;() æ–¹æ³•ã€‚ è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¢«æ­£ç¡®åœ°åŠ é”ã€åŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å»åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªç±»çš„ &amp;lt;clinit&amp;gt;() æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹éƒ½éœ€è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œ &amp;lt;clinit&amp;gt;() æ–¹æ³•å®Œæ¯•ã€‚</summary></entry></feed>