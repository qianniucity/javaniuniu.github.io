---
title: 152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„
permalink: /leetcode/2020/0503/003/03
tags: leetcode è´ªå¿ƒ åŠ¨æ€è§„åˆ’
key: leetcode-2020-0503-003-03
modify_date: 2020-05-18
---
- __éš¾åº¦__ï¼š`ä¸­ç­‰`{:.warning}
- __æœ¬é¢˜æ¶‰åŠç®—æ³•__ï¼š `è´ªå¿ƒ`{:.success} `åŠ¨æ€è§„åˆ’`{:.success}
- __æ€è·¯__ï¼š `è´ªå¿ƒ`{:.info} `åŠ¨æ€è§„åˆ’`{:.info}
- __ç±»ä¼¼é¢˜å‹__:

---

### é¢˜ç›® [152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„](https://leetcode-cn.com/problems/maximum-product-subarray/)
ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums`Â ï¼Œè¯·ä½ æ‰¾å‡ºæ•°ç»„ä¸­ä¹˜ç§¯æœ€å¤§çš„è¿ç»­å­æ•°ç»„ï¼ˆè¯¥å­æ•°ç»„ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°å­—ï¼‰ã€‚

### ç¤ºä¾‹ 1:
```
è¾“å…¥: [2,3,-2,4]
è¾“å‡º: 6
è§£é‡Š:Â å­æ•°ç»„ [2,3] æœ‰æœ€å¤§ä¹˜ç§¯ 6ã€‚
```
### ç¤ºä¾‹ 2:
```
è¾“å…¥: [-2,0,-1]
è¾“å‡º: 0
è§£é‡Š:Â ç»“æœä¸èƒ½ä¸º 2, å› ä¸º [-2,-1] ä¸æ˜¯å­æ•°ç»„ã€‚
```




### æ–¹æ³•ä¸€ åŠ¨æ€è§„åˆ’
- __è§£é¢˜æ€è·¯__:
    - å¦‚æœ *æ•°ç»„* ä¸­ä¸åŒ…å«è´Ÿæ•°ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ªæœ€å¤§å€¼
    - å½“å‡ºç°è´Ÿæ•°çš„æ—¶å€™ ï¼Œæˆ‘ä»¬å¯ä»¥å†ç»´æŠ¤ä¸€ä¸ªæœ€å°å€¼ï¼Œ
    - é€šè¿‡ç»´æŠ¤æœ€å¤§å€¼æœ€å°å€¼ï¼Œå¯ä»¥ä¿è¯å½“å‰ä¹˜ç§¯ä¸‹ï¼Œæœ€å¤§ä¸æœ€å°å€¼
- __ç®—æ³•æµç¨‹__ï¼š
    - é€šè¿‡åŠ¨æ€è§„åˆ’ï¼Œè®°å½•æ¯æ¬¡ä¹˜ç§¯ä¸‹çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œå¹¶åœ¨å½“å‰éå†ç»“æŸå‰åˆ¤æ–­__æœ€å¤§å€¼__
- __å¤æ‚åº¦åˆ†æ__ï¼š
    - æ—¶é—´å¤æ‚åº¦ $O(N)$ ï¼Œ$N$ ä¸ºæ•°ç»„çš„é•¿åº¦
    - ç©ºé—´å¤æ‚åº¦ $O(N)$ï¼Œ æˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªé•¿åº¦ä¸º $N$ æ•°ç»„ï¼Œè®°å½•æœ€å¤§å€¼å’Œæœ€å°å€¼
#### python
```python
class Solution(object):
    def maxProduct(self, nums):
        le = len(nums)
        if nums is None:
            return 0
        if le == 1:
            return nums[0]

        res = nums[0]
        dp_max ,dp_min = [0] * le ,[0] * le
        dp_max[0] = nums[0]
        dp_min[0] = nums[0]
        for i in range(1,le):
            if nums[i] >= 0:
                dp_max[i] = max(dp_max[i-1] * nums[i],nums[i])
                dp_min[i] = min(dp_min[i-1] * nums[i],nums[i])
            else:
                dp_max[i] = max(dp_min[i-1] * nums[i],nums[i])
                dp_min[i] = min(dp_max[i-1] * nums[i],nums[i])
            res = max(dp_max[i],res)
        return res
```
#### java
```java
class Solution {
    public int maxProduct(int[] nums) {
        int len = nums.length;
        int[] dp_max = new int[len];
        int[] dp_min = new int[len];
        int ans = nums[0];
        dp_max[0] = nums[0];
        dp_min[0] = nums[0];

        for(int i=1;i<len;i++) {
            if (nums[i] >=0) {
                dp_max[i] = Math.max(dp_max[i-1] * nums[i],nums[i]);
                dp_min[i] = Math.min(dp_min[i-1] * nums[i],nums[i]);
            }else {
                dp_max[i] = Math.max(dp_min[i-1] * nums[i],nums[i]);
                dp_min[i] = Math.min(dp_max[i-1] * nums[i],nums[i]);
            }
            ans = Math.max(dp_max[i],ans);
        }
        return ans;

    }
}
```

### è´ªå¿ƒç®—æ³•
- __ç®€åŒ–æ€è·¯__ï¼š
    - æˆ‘ä»¬åªéœ€è¦è®°å½•æ¯æ¬¡éå†çš„æœ€å¤§å€¼æœ€å°å€¼ï¼Œå¹¶æ›¿æ¢åŸæ¥çš„æœ€å¤§å€¼å’Œæœ€å°å€¼
- __å¤æ‚åº¦åˆ†æ__ï¼š
    - æ—¶é—´å¤æ‚åº¦ $O(N)$ ï¼Œ$N$ ä¸ºæ•°ç»„çš„é•¿åº¦
    - ç©ºé—´å¤æ‚åº¦ $O(1)$ï¼Œ æˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªé•¿åº¦ä¸º $N$ æ•°ç»„ï¼Œè®°å½•æœ€å¤§å€¼å’Œæœ€å°å€¼
#### python
```python
class Solution:
    def maxProduct(self, nums: List[int]) -> int:
        imax ,imin= 1,1
        ans = nums[0]
        for num in nums:
            if num < 0:
                imax ,imin = imin, imax
            imax = max(imax * num,num)
            imin = min(imin * num,num)
            ans = max(imax,ans)
        return ans
```
#### java
```java
class Solution {
    public int maxProduct(int[] nums) {
        int imax = 1,imin = 1 ,ans = nums[0];
        for (int num:nums) {
            if (num<0){
                int temp = imax;
                imax = imin;
                imin = temp;
            }
            imax = Math.max(imax * num,num);
            imin = Math.min(imin * num,num);
            ans = Math.max(imax,ans);
        }
        return ans;

    }
}
```




- __å¦‚æœä½ è§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµğŸ‘æ”¯æŒ__
- __å¦‚æœæœ‰ç–‘æƒ‘æˆ–è€…è¡¨è¾¾ä¸åˆ°ä½çš„é¢åœ°æ–¹ ï¼Œè¯·åœ¨ä¸‹é¢ğŸ‘‡è¯„è®ºåŒºæŒ‡å‡º__
