I"é<p>é¦–å…ˆè´´ä¸Šä»£ç </p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginVO</span> <span class="o">{</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@IsMobile</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">mobile</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Length</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">32</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IsMobileValidator</span> <span class="kd">implements</span> <span class="nc">ConstraintValidator</span><span class="o">&lt;</span><span class="nc">IsMobile</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">require</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">IsMobile</span> <span class="n">constraintAnnotation</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">require</span> <span class="o">=</span> <span class="n">constraintAnnotation</span><span class="o">.</span><span class="na">required</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span><span class="o">,</span> <span class="nc">ConstraintValidatorContext</span> <span class="n">constraintValidatorContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">require</span><span class="o">){</span>
            <span class="k">return</span> <span class="nc">ValidatorUtils</span><span class="o">.</span><span class="na">isMobile</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span><span class="k">else</span> <span class="o">{</span>
           <span class="k">if</span> <span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">s</span><span class="o">))</span> <span class="o">{</span>
               <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
           <span class="o">}</span><span class="k">else</span> <span class="o">{</span>
               <span class="k">return</span> <span class="nc">ValidatorUtils</span><span class="o">.</span><span class="na">isMobile</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
           <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span>
        <span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{</span><span class="nc">IsMobileValidator</span><span class="o">.</span><span class="na">class</span><span class="o">}</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">IsMobile</span> <span class="o">{</span>

    <span class="kt">boolean</span> <span class="nf">required</span><span class="o">()</span> <span class="k">default</span> <span class="kc">true</span><span class="o">;</span>

    <span class="nc">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">"æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®"</span><span class="o">;</span>

    <span class="nc">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>


<span class="o">}</span>
</code></pre></div></div>
<p>```java
public class ValidatorUtils {</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private static final Pattern mobile_pattern = Pattern.compile("1\\d{10}");

public static boolean isMobile(String src) {
    if (StringUtils.isEmpty(src)) {
        return false;
    }
    Matcher m = mobile_pattern.matcher(src);
    return m.matches();
} } LoginVOç±»ä¸ºä¸€ä¸ªæ™®é€šçš„å®ä½“ç±»ï¼Œå…¶ä¸­çš„mobileå±æ€§æ·»åŠ äº†è‡ªå®šä¹‰æ³¨è§£ã€‚ IsMobileç±»ä¸ºè‡ªå®šä¹‰çš„å­—æ®µæ³¨è§£ï¼Œæœªäº†è§£è¿‡æ³¨è§£çš„åŒå­¦è¯·è‡ªè¡Œç™¾åº¦ï¼Œåœ¨æ­¤ä¸åšåŸºç¡€ä»‹ç»ã€‚è¯¥è‡ªå®šä¹‰æ³¨è§£ç±»ä¸­ç”¨åˆ°äº†å››ç§å…ƒæ³¨è§£ï¼Œæœ€åä¸€ä¸ª@ConstraintæŒ‡å®šäº†æ ¡éªŒç±»ï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥çš„IsMobileValidatorç±»ã€‚å€¼å¾—ä¸€æçš„æ˜¯é™¤äº†è‡ªå®šä¹‰çš„messageã€requireå±æ€§å¤–ï¼Œä¸‹é¢çš„groupså’Œpayloadä¹Ÿæ˜¯å¿…é¡»æ·»åŠ çš„ã€‚ ValidatorUtilsä¸ºä¸€ä¸ªå·¥å…·ç±»ï¼Œç®€å•æ ¡éªŒäº†æ˜¯å¦ä¸ºæ‰‹æœºå·ï¼Œæ²¡æœ‰äº†è§£è¿‡çš„å¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„ä¸€ç¯‡åšæ–‡ï¼šhttps://blog.csdn.net/qq_38439885/article/details/80230753 IsMobileValidatorä¸ºè‡ªå®šä¹‰æ³¨è§£çš„æ ¡éªŒç±»ã€‚ æ ¡éªŒç±»éœ€è¦å®ç°ConstraintValidatoræ¥å£ã€‚ æ¥å£ä½¿ç”¨äº†æ³›å‹ï¼Œéœ€è¦æŒ‡å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ç±»ï¼Œç¬¬äºŒä¸ªä¸ºéœ€è¦æ ¡éªŒçš„æ•°æ®ç±»å‹ã€‚ å®ç°æ¥å£åè¦overrideä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºinitializeæ–¹æ³•å’ŒisValidæ–¹æ³•ã€‚å…¶ä¸­initializeä¸ºåˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥åœ¨é‡Œé¢åšä¸€äº›åˆå§‹åŒ–æ“ä½œï¼ŒisValidæ–¹æ³•å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆéœ€è¦çš„æ ¡éªŒæ–¹æ³•äº†ã€‚å¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­å®ç°å…·ä½“çš„æ ¡éªŒæ­¥éª¤ã€‚æœ¬ç¤ºä¾‹ä¸­è¿›è¡Œäº†ç®€å•çš„æ‰‹æœºå·æ ¡éªŒã€‚
</code></pre></div></div>

<p>å®Œæˆè¿™å‡ éƒ¨åˆ†ä¹‹åï¼Œä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£å°±å®Œæˆå•¦ï¼Œä¸è¦å¿˜è®°åœ¨ä½¿ç”¨çš„æ—¶å€™åŠ ä¸Š@Validæ³¨è§£å¼€å¯validæ ¡éªŒã€‚</p>

<p>é‚£ä¹ˆå¦‚ä½•è·å–åœ¨æ³¨è§£ä¸­å®šä¹‰çš„messageä¿¡æ¯å‘¢ï¼Ÿ</p>

<p>åœ¨validæ ¡éªŒä¸­ï¼Œå¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œä¼šäº§ç”ŸBindExceptionå¼‚å¸¸ï¼Œæ•æ‰åˆ°å¼‚å¸¸åå¯ä»¥è·å–åˆ°defaultMessageä¹Ÿå°±æ˜¯è‡ªå®šä¹‰æ³¨è§£ä¸­å®šä¹‰çš„å†…å®¹ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BindException ex = (BindException)e;
List&lt;ObjectError&gt; errors = ex.getAllErrors();
ObjectError error = errors.get(0);
String msg = error.getDefaultMessage(); â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œhhswayã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_38439885/article/details/81227063
</code></pre></div></div>
:ET