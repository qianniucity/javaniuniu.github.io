I"¦<h5 id="ä¸€å¥è¯ç®€ä»‹">ä¸€å¥è¯ç®€ä»‹</h5>
<p>JAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶</p>

<h5 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</h5>
<ul>
  <li>åœ¨æ—¥å¸¸çš„ç¬¬ä¸‰æ–¹åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°æŸä¸ªç±»çš„æŸä¸ªæˆå‘˜å˜é‡ã€æ–¹æ³•æˆ–æ˜¯å±æ€§æ˜¯ç§æœ‰çš„æˆ–æ˜¯åªå¯¹ç³»ç»Ÿåº”ç”¨å¼€æ”¾ï¼Œè¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨Javaçš„åå°„æœºåˆ¶é€šè¿‡åå°„æ¥è·å–æ‰€éœ€çš„ç§æœ‰æˆå‘˜æˆ–æ˜¯æ–¹æ³•</li>
  <li>ä¸»è¦åº”ç”¨äºæ¡†æ¶ä¸­</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">javaniuniu</span><span class="o">.</span><span class="na">scshorlsweb</span><span class="o">.</span><span class="na">system</span><span class="o">.</span><span class="na">utils</span><span class="o">.</span><span class="na">reflect</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.lang3.StringUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.lang3.Validate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.reflect.Field</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.InvocationTargetException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Method</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Modifier</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.ParameterizedType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Type</span><span class="o">;</span>

<span class="cm">/**
 * åå°„å·¥å…·ç±».
 *
 * æä¾›è°ƒç”¨getter/setteræ–¹æ³•, è®¿é—®ç§æœ‰å˜é‡, è°ƒç”¨ç§æœ‰æ–¹æ³•, è·å–æ³›å‹ç±»å‹Class, è¢«AOPè¿‡çš„çœŸå®ç±»ç­‰å·¥å…·å‡½æ•°.
 * //TODO åå°„å·¥å…·ç±»
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Reflections</span>
<span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">SETTER_PREFIX</span> <span class="o">=</span> <span class="s">"set"</span><span class="o">;</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">GETTER_PREFIX</span> <span class="o">=</span> <span class="s">"get"</span><span class="o">;</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">CGLIB_CLASS_SEPARATOR</span> <span class="o">=</span> <span class="s">"$$"</span><span class="o">;</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">Reflections</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

	<span class="cm">/**
	 * è°ƒç”¨Getteræ–¹æ³•.
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Object</span> <span class="nf">invokeGetter</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="nc">String</span> <span class="n">propertyName</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">getterMethodName</span> <span class="o">=</span> <span class="no">GETTER_PREFIX</span> <span class="o">+</span> <span class="nc">StringUtils</span><span class="o">.</span><span class="na">capitalize</span><span class="o">(</span><span class="n">propertyName</span><span class="o">);</span>
		<span class="k">return</span> <span class="nf">invokeMethod</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">getterMethodName</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Class</span><span class="o">[]</span> <span class="o">{},</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]</span> <span class="o">{});</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * è°ƒç”¨Setteræ–¹æ³•, ä»…åŒ¹é…æ–¹æ³•åã€‚
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">invokeSetter</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="nc">String</span> <span class="n">propertyName</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">setterMethodName</span> <span class="o">=</span> <span class="no">SETTER_PREFIX</span> <span class="o">+</span> <span class="nc">StringUtils</span><span class="o">.</span><span class="na">capitalize</span><span class="o">(</span><span class="n">propertyName</span><span class="o">);</span>
		<span class="n">invokeMethodByName</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">setterMethodName</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]</span> <span class="o">{</span> <span class="n">value</span> <span class="o">});</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * ç›´æ¥è¯»å–å¯¹è±¡å±æ€§å€¼, æ— è§†private/protectedä¿®é¥°ç¬¦, ä¸ç»è¿‡getterå‡½æ•°.
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Object</span> <span class="nf">getFieldValue</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">getAccessibleField</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">fieldName</span><span class="o">);</span>

		<span class="k">if</span> <span class="o">(</span><span class="n">field</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Could not find field ["</span> <span class="o">+</span> <span class="n">fieldName</span> <span class="o">+</span> <span class="s">"] on target ["</span> <span class="o">+</span> <span class="n">obj</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>
		<span class="o">}</span>

		<span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">obj</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"ä¸å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸{}"</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * ç›´æ¥è®¾ç½®å¯¹è±¡å±æ€§å€¼, æ— è§†private/protectedä¿®é¥°ç¬¦, ä¸ç»è¿‡setterå‡½æ•°.
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setFieldValue</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">fieldName</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">getAccessibleField</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">fieldName</span><span class="o">);</span>

		<span class="k">if</span> <span class="o">(</span><span class="n">field</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Could not find field ["</span> <span class="o">+</span> <span class="n">fieldName</span> <span class="o">+</span> <span class="s">"] on target ["</span> <span class="o">+</span> <span class="n">obj</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>
		<span class="o">}</span>

		<span class="k">try</span> <span class="o">{</span>
			<span class="n">field</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"ä¸å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸:{}"</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * ç›´æ¥è°ƒç”¨å¯¹è±¡æ–¹æ³•, æ— è§†private/protectedä¿®é¥°ç¬¦.
	 * ç”¨äºä¸€æ¬¡æ€§è°ƒç”¨çš„æƒ…å†µï¼Œå¦åˆ™åº”ä½¿ç”¨getAccessibleMethod()å‡½æ•°è·å¾—Methodååå¤è°ƒç”¨.
	 * åŒæ—¶åŒ¹é…æ–¹æ³•å+å‚æ•°ç±»å‹ï¼Œ
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Object</span> <span class="nf">invokeMethod</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">methodName</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">parameterTypes</span><span class="o">,</span>
                                      <span class="kd">final</span> <span class="nc">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">getAccessibleMethod</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">methodName</span><span class="o">,</span> <span class="n">parameterTypes</span><span class="o">);</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">method</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Could not find method ["</span> <span class="o">+</span> <span class="n">methodName</span> <span class="o">+</span> <span class="s">"] on target ["</span> <span class="o">+</span> <span class="n">obj</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>
		<span class="o">}</span>

		<span class="k">try</span> <span class="o">{</span>
			<span class="k">return</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="nf">convertReflectionExceptionToUnchecked</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * ç›´æ¥è°ƒç”¨å¯¹è±¡æ–¹æ³•, æ— è§†private/protectedä¿®é¥°ç¬¦ï¼Œ
	 * ç”¨äºä¸€æ¬¡æ€§è°ƒç”¨çš„æƒ…å†µï¼Œå¦åˆ™åº”ä½¿ç”¨getAccessibleMethodByName()å‡½æ•°è·å¾—Methodååå¤è°ƒç”¨.
	 * åªåŒ¹é…å‡½æ•°åï¼Œå¦‚æœæœ‰å¤šä¸ªåŒåå‡½æ•°è°ƒç”¨ç¬¬ä¸€ä¸ªã€‚
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Object</span> <span class="nf">invokeMethodByName</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">methodName</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">getAccessibleMethodByName</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">methodName</span><span class="o">);</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">method</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Could not find method ["</span> <span class="o">+</span> <span class="n">methodName</span> <span class="o">+</span> <span class="s">"] on target ["</span> <span class="o">+</span> <span class="n">obj</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>
		<span class="o">}</span>

		<span class="k">try</span> <span class="o">{</span>
			<span class="k">return</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="nf">convertReflectionExceptionToUnchecked</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * å¾ªç¯å‘ä¸Šè½¬å‹, è·å–å¯¹è±¡çš„DeclaredField, å¹¶å¼ºåˆ¶è®¾ç½®ä¸ºå¯è®¿é—®.
	 *
	 * å¦‚å‘ä¸Šè½¬å‹åˆ°Objectä»æ— æ³•æ‰¾åˆ°, è¿”å›null.
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Field</span> <span class="nf">getAccessibleField</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Validate</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="s">"object can't be null"</span><span class="o">);</span>
		<span class="nc">Validate</span><span class="o">.</span><span class="na">notBlank</span><span class="o">(</span><span class="n">fieldName</span><span class="o">,</span> <span class="s">"fieldName can't be blank"</span><span class="o">);</span>
		<span class="k">for</span> <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">superClass</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span> <span class="n">superClass</span> <span class="o">!=</span> <span class="nc">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span> <span class="n">superClass</span> <span class="o">=</span> <span class="n">superClass</span><span class="o">.</span><span class="na">getSuperclass</span><span class="o">())</span> <span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="nc">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">superClass</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
				<span class="n">makeAccessible</span><span class="o">(</span><span class="n">field</span><span class="o">);</span>
				<span class="k">return</span> <span class="n">field</span><span class="o">;</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NoSuchFieldException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span><span class="c1">// NOSONAR</span>
				<span class="c1">// Fieldä¸åœ¨å½“å‰ç±»å®šä¹‰,ç»§ç»­å‘ä¸Šè½¬å‹</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * å¾ªç¯å‘ä¸Šè½¬å‹, è·å–å¯¹è±¡çš„DeclaredMethod,å¹¶å¼ºåˆ¶è®¾ç½®ä¸ºå¯è®¿é—®.
	 * å¦‚å‘ä¸Šè½¬å‹åˆ°Objectä»æ— æ³•æ‰¾åˆ°, è¿”å›null.
	 * åŒ¹é…å‡½æ•°å+å‚æ•°ç±»å‹ã€‚
	 *
	 * ç”¨äºæ–¹æ³•éœ€è¦è¢«å¤šæ¬¡è°ƒç”¨çš„æƒ…å†µ. å…ˆä½¿ç”¨æœ¬å‡½æ•°å…ˆå–å¾—Method,ç„¶åè°ƒç”¨Method.invoke(Object obj, Object... args)
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Method</span> <span class="nf">getAccessibleMethod</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">methodName</span><span class="o">,</span>
                                             <span class="kd">final</span> <span class="nc">Class</span><span class="o">&lt;?&gt;...</span> <span class="n">parameterTypes</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Validate</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="s">"object can't be null"</span><span class="o">);</span>
		<span class="nc">Validate</span><span class="o">.</span><span class="na">notBlank</span><span class="o">(</span><span class="n">methodName</span><span class="o">,</span> <span class="s">"methodName can't be blank"</span><span class="o">);</span>

		<span class="k">for</span> <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">searchType</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span> <span class="n">searchType</span> <span class="o">!=</span> <span class="nc">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span> <span class="n">searchType</span> <span class="o">=</span> <span class="n">searchType</span><span class="o">.</span><span class="na">getSuperclass</span><span class="o">())</span> <span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="nc">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">searchType</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="n">methodName</span><span class="o">,</span> <span class="n">parameterTypes</span><span class="o">);</span>
				<span class="n">makeAccessible</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>
				<span class="k">return</span> <span class="n">method</span><span class="o">;</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NoSuchMethodException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// Methodä¸åœ¨å½“å‰ç±»å®šä¹‰,ç»§ç»­å‘ä¸Šè½¬å‹</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * å¾ªç¯å‘ä¸Šè½¬å‹, è·å–å¯¹è±¡çš„DeclaredMethod,å¹¶å¼ºåˆ¶è®¾ç½®ä¸ºå¯è®¿é—®.
	 * å¦‚å‘ä¸Šè½¬å‹åˆ°Objectä»æ— æ³•æ‰¾åˆ°, è¿”å›null.
	 * åªåŒ¹é…å‡½æ•°åã€‚
	 *
	 * ç”¨äºæ–¹æ³•éœ€è¦è¢«å¤šæ¬¡è°ƒç”¨çš„æƒ…å†µ. å…ˆä½¿ç”¨æœ¬å‡½æ•°å…ˆå–å¾—Method,ç„¶åè°ƒç”¨Method.invoke(Object obj, Object... args)
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Method</span> <span class="nf">getAccessibleMethodByName</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">methodName</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Validate</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="s">"object can't be null"</span><span class="o">);</span>
		<span class="nc">Validate</span><span class="o">.</span><span class="na">notBlank</span><span class="o">(</span><span class="n">methodName</span><span class="o">,</span> <span class="s">"methodName can't be blank"</span><span class="o">);</span>

		<span class="k">for</span> <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">searchType</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span> <span class="n">searchType</span> <span class="o">!=</span> <span class="nc">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span> <span class="n">searchType</span> <span class="o">=</span> <span class="n">searchType</span><span class="o">.</span><span class="na">getSuperclass</span><span class="o">())</span> <span class="o">{</span>
			<span class="nc">Method</span><span class="o">[]</span> <span class="n">methods</span> <span class="o">=</span> <span class="n">searchType</span><span class="o">.</span><span class="na">getDeclaredMethods</span><span class="o">();</span>
			<span class="k">for</span> <span class="o">(</span><span class="nc">Method</span> <span class="n">method</span> <span class="o">:</span> <span class="n">methods</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">methodName</span><span class="o">))</span> <span class="o">{</span>
					<span class="n">makeAccessible</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>
					<span class="k">return</span> <span class="n">method</span><span class="o">;</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * æ”¹å˜private/protectedçš„æ–¹æ³•ä¸ºpublicï¼Œå°½é‡ä¸è°ƒç”¨å®é™…æ”¹åŠ¨çš„è¯­å¥ï¼Œé¿å…JDKçš„SecurityManageræŠ±æ€¨ã€‚
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">makeAccessible</span><span class="o">(</span><span class="nc">Method</span> <span class="n">method</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">((!</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">isPublic</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getModifiers</span><span class="o">())</span> <span class="o">||</span> <span class="o">!</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">isPublic</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getDeclaringClass</span><span class="o">().</span><span class="na">getModifiers</span><span class="o">()))</span>
				<span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">method</span><span class="o">.</span><span class="na">isAccessible</span><span class="o">())</span> <span class="o">{</span>
			<span class="n">method</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * æ”¹å˜private/protectedçš„æˆå‘˜å˜é‡ä¸ºpublicï¼Œå°½é‡ä¸è°ƒç”¨å®é™…æ”¹åŠ¨çš„è¯­å¥ï¼Œé¿å…JDKçš„SecurityManageræŠ±æ€¨ã€‚
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">makeAccessible</span><span class="o">(</span><span class="nc">Field</span> <span class="n">field</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">((!</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">isPublic</span><span class="o">(</span><span class="n">field</span><span class="o">.</span><span class="na">getModifiers</span><span class="o">())</span> <span class="o">||</span> <span class="o">!</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">isPublic</span><span class="o">(</span><span class="n">field</span><span class="o">.</span><span class="na">getDeclaringClass</span><span class="o">().</span><span class="na">getModifiers</span><span class="o">())</span> <span class="o">||</span> <span class="nc">Modifier</span>
				<span class="o">.</span><span class="na">isFinal</span><span class="o">(</span><span class="n">field</span><span class="o">.</span><span class="na">getModifiers</span><span class="o">()))</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">field</span><span class="o">.</span><span class="na">isAccessible</span><span class="o">())</span> <span class="o">{</span>
			<span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * é€šè¿‡åå°„, è·å¾—Classå®šä¹‰ä¸­å£°æ˜çš„æ³›å‹å‚æ•°çš„ç±»å‹, æ³¨æ„æ³›å‹å¿…é¡»å®šä¹‰åœ¨çˆ¶ç±»å¤„
	 * å¦‚æ— æ³•æ‰¾åˆ°, è¿”å›Object.class.
	 * eg.
	 * public UserDao extends HibernateDao&lt;User&gt;
	 *
	 * @param clazz The class to introspect
	 * @return the first generic declaration, or Object.class if cannot be determined
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getClassGenricType</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Class</span> <span class="n">clazz</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nf">getClassGenricType</span><span class="o">(</span><span class="n">clazz</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getClassGenricType</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Type</span> <span class="n">type</span><span class="o">){</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="k">instanceof</span> <span class="nc">ParameterizedType</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">ParameterizedType</span> <span class="n">paramType</span> <span class="o">=</span> <span class="o">(</span><span class="nc">ParameterizedType</span><span class="o">)</span> <span class="n">type</span><span class="o">;</span>
            <span class="nc">Type</span><span class="o">[]</span> <span class="n">argTypes</span> <span class="o">=</span> <span class="n">paramType</span><span class="o">.</span><span class="na">getActualTypeArguments</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">argTypes</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">logger</span><span class="o">.</span><span class="na">isDebugEnabled</span><span class="o">()){</span>
                    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Generic type is: {}"</span><span class="o">,</span><span class="n">argTypes</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
                <span class="o">}</span>
                <span class="k">return</span> <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;)</span> <span class="n">argTypes</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;)</span> <span class="n">type</span><span class="o">;</span>
    <span class="o">}</span>

	<span class="cm">/**
	 * é€šè¿‡åå°„, è·å¾—Classå®šä¹‰ä¸­å£°æ˜çš„çˆ¶ç±»çš„æ³›å‹å‚æ•°çš„ç±»å‹.
	 * å¦‚æ— æ³•æ‰¾åˆ°, è¿”å›Object.class.
	 *
	 * å¦‚public UserDao extends HibernateDao&lt;User,Long&gt;
	 *
	 * @param clazz clazz The class to introspect
	 * @param index the Index of the generic ddeclaration,start from 0.
	 * @return the index generic declaration, or Object.class if cannot be determined
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Class</span> <span class="nf">getClassGenricType</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Class</span> <span class="n">clazz</span><span class="o">,</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>

		<span class="nc">Type</span> <span class="n">genType</span> <span class="o">=</span> <span class="n">clazz</span><span class="o">.</span><span class="na">getGenericSuperclass</span><span class="o">();</span>

		<span class="k">if</span> <span class="o">(!(</span><span class="n">genType</span> <span class="k">instanceof</span> <span class="nc">ParameterizedType</span><span class="o">))</span> <span class="o">{</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="n">clazz</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"'s superclass not ParameterizedType"</span><span class="o">);</span>
			<span class="k">return</span> <span class="nc">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
		<span class="o">}</span>

		<span class="nc">Type</span><span class="o">[]</span> <span class="n">params</span> <span class="o">=</span> <span class="o">((</span><span class="nc">ParameterizedType</span><span class="o">)</span> <span class="n">genType</span><span class="o">).</span><span class="na">getActualTypeArguments</span><span class="o">();</span>

		<span class="k">if</span> <span class="o">((</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">params</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">))</span> <span class="o">{</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Index: "</span> <span class="o">+</span> <span class="n">index</span> <span class="o">+</span> <span class="s">", Size of "</span> <span class="o">+</span> <span class="n">clazz</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"'s Parameterized Type: "</span>
					<span class="o">+</span> <span class="n">params</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
			<span class="k">return</span> <span class="nc">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="k">if</span> <span class="o">(!(</span><span class="n">params</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="k">instanceof</span> <span class="nc">Class</span><span class="o">))</span> <span class="o">{</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="n">clazz</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" not set the actual class on superclass generic parameter"</span><span class="o">);</span>
			<span class="k">return</span> <span class="nc">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
		<span class="o">}</span>

		<span class="k">return</span> <span class="o">(</span><span class="nc">Class</span><span class="o">)</span> <span class="n">params</span><span class="o">[</span><span class="n">index</span><span class="o">];</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">getUserClass</span><span class="o">(</span><span class="nc">Object</span> <span class="n">instance</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Validate</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">instance</span><span class="o">,</span> <span class="s">"Instance must not be null"</span><span class="o">);</span>
		<span class="nc">Class</span> <span class="n">clazz</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
		<span class="k">if</span> <span class="o">((</span><span class="n">clazz</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">clazz</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="no">CGLIB_CLASS_SEPARATOR</span><span class="o">))</span> <span class="o">{</span>
			<span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">superClass</span> <span class="o">=</span> <span class="n">clazz</span><span class="o">.</span><span class="na">getSuperclass</span><span class="o">();</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">superClass</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nc">Object</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">superClass</span><span class="o">))</span> <span class="o">{</span>
				<span class="k">return</span> <span class="n">superClass</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">clazz</span><span class="o">;</span>

	<span class="o">}</span>

	<span class="cm">/**
	 * å°†åå°„æ—¶çš„checked exceptionè½¬æ¢ä¸ºunchecked exception.
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">RuntimeException</span> <span class="nf">convertReflectionExceptionToUnchecked</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">((</span><span class="n">e</span> <span class="k">instanceof</span> <span class="nc">IllegalAccessException</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span><span class="n">e</span> <span class="k">instanceof</span> <span class="nc">IllegalArgumentException</span><span class="o">)</span>
				<span class="o">||</span> <span class="o">(</span><span class="n">e</span> <span class="k">instanceof</span> <span class="nc">NoSuchMethodException</span><span class="o">))</span> <span class="o">{</span>
			<span class="k">return</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="k">instanceof</span> <span class="nc">InvocationTargetException</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">return</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(((</span><span class="nc">InvocationTargetException</span><span class="o">)</span> <span class="n">e</span><span class="o">).</span><span class="na">getTargetException</span><span class="o">());</span>
		<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="k">instanceof</span> <span class="nc">RuntimeException</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">return</span> <span class="o">(</span><span class="nc">RuntimeException</span><span class="o">)</span> <span class="n">e</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Unexpected Checked Exception."</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
	<span class="o">}</span>
	<span class="kd">static</span> <span class="kd">class</span> <span class="nc">Users</span><span class="o">{</span>
		<span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
		<span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"minp"</span><span class="o">;</span>
		<span class="kd">private</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>

			<span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
		<span class="o">}</span>
<span class="c1">//</span>
<span class="c1">//		private void setId(int i) {</span>
<span class="c1">//			id =i;</span>
<span class="c1">//		}</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">invokeGetter</span><span class="o">(</span><span class="k">new</span> <span class="nc">Users</span><span class="o">(),</span><span class="s">"id"</span><span class="o">);</span>
<span class="c1">//		getAccessibleMethod(new Users(),"getId",null);</span>
<span class="c1">//</span>
<span class="c1">//		getUserClass(new Users());</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p><strong>å‚è€ƒé“¾æ¥</strong></p>
<ul>
  <li><a href="https://www.jianshu.com/p/9be58ee20dee">Javaé«˜çº§ç‰¹æ€§â€”â€”åå°„</a></li>
  <li><a href="https://blog.csdn.net/qsbbl/article/details/85801571">ã€javaåå°„ã€‘åå°„æ˜¯å•¥ï¼Ÿæ˜¯å¹²å•¥ç”¨çš„ï¼Ÿ</a></li>
</ul>
:ET