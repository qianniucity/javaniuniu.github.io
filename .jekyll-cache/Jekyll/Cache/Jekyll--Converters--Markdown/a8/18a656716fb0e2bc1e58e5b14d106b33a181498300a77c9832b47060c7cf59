I"qŞ<h2 id="ä¸€å‚æ•°æ ¡éªŒ">ä¸€ã€å‚æ•°æ ¡éªŒ</h2>
<p>åœ¨å¼€å‘ä¸­ç»å¸¸éœ€è¦å†™ä¸€äº›å­—æ®µæ ¡éªŒçš„ä»£ç ï¼Œæ¯”å¦‚å­—æ®µéç©ºï¼Œå­—æ®µé•¿åº¦é™åˆ¶ï¼Œé‚®ç®±æ ¼å¼éªŒè¯ç­‰ç­‰ï¼Œå†™è¿™äº›ä¸ä¸šåŠ¡é€»è¾‘å…³ç³»ä¸å¤§çš„ä»£ç ä¸ªäººæ„Ÿè§‰æœ‰ä¸¤ä¸ªéº»çƒ¦ï¼š</p>

<ul>
  <li>éªŒè¯ä»£ç ç¹çï¼Œé‡å¤åŠ³åŠ¨</li>
  <li>æ–¹æ³•å†…ä»£ç æ˜¾å¾—å†—é•¿</li>
  <li>æ¯æ¬¡è¦çœ‹å“ªäº›å‚æ•°éªŒè¯æ˜¯å¦å®Œæ•´ï¼Œéœ€è¦å»ç¿»é˜…éªŒè¯é€»è¾‘ä»£ç 
hibernate validator <a href="http://hibernate.org/validator/documentation/">ï¼ˆå®˜æ–¹æ–‡æ¡£ï¼‰</a>æä¾›äº†ä¸€å¥—æ¯”è¾ƒå®Œå–„ã€ä¾¿æ·çš„éªŒè¯å®ç°æ–¹å¼ã€‚</li>
</ul>

<p>spring-boot-starter-webåŒ…é‡Œé¢æœ‰hibernate-validatoråŒ…ï¼Œä¸éœ€è¦å¼•ç”¨hibernate validatorä¾èµ–ã€‚</p>

<h2 id="äºŒhibernate-validatoræ ¡éªŒdemo">äºŒã€hibernate validatoræ ¡éªŒdemo</h2>
<p>å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„demoï¼Œæ·»åŠ äº†Validatorçš„æ³¨è§£ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.NotBlank</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.AssertFalse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Pattern</span><span class="o">;</span>
<span class="n">å¤åˆ¶ä»£ç </span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DemoModel</span> <span class="o">{</span>
    <span class="nd">@NotBlank</span><span class="o">(</span><span class="n">message</span><span class="o">=</span><span class="s">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">userName</span><span class="o">;</span>

    <span class="nd">@NotBlank</span><span class="o">(</span><span class="n">message</span><span class="o">=</span><span class="s">"å¹´é¾„ä¸èƒ½ä¸ºç©º"</span><span class="o">)</span>
    <span class="nd">@Pattern</span><span class="o">(</span><span class="n">regexp</span><span class="o">=</span><span class="s">"^[0-9]{1,2}$"</span><span class="o">,</span><span class="n">message</span><span class="o">=</span><span class="s">"å¹´é¾„ä¸æ­£ç¡®"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@AssertFalse</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">"å¿…é¡»ä¸ºfalse"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Boolean</span> <span class="n">isFalse</span><span class="o">;</span>
    <span class="cm">/**
     * å¦‚æœæ˜¯ç©ºï¼Œåˆ™ä¸æ ¡éªŒï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™æ ¡éªŒ
     */</span>
    <span class="nd">@Pattern</span><span class="o">(</span><span class="n">regexp</span><span class="o">=</span><span class="s">"^[0-9]{4}-[0-9]{2}-[0-9]{2}$"</span><span class="o">,</span><span class="n">message</span><span class="o">=</span><span class="s">"å‡ºç”Ÿæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">birthday</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>POSTæ¥å£éªŒè¯ï¼ŒBindingResultæ˜¯éªŒè¯ä¸é€šè¿‡çš„ç»“æœé›†åˆï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo2"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo2</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nd">@Valid</span> <span class="nc">DemoModel</span> <span class="n">demo</span><span class="o">,</span> <span class="nc">BindingResult</span> <span class="n">result</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">()){</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">ObjectError</span> <span class="n">error</span> <span class="o">:</span> <span class="n">result</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">error</span><span class="o">.</span><span class="na">getDefaultMessage</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>POSTè¯·æ±‚ä¼ å…¥çš„å‚æ•°ï¼š{â€œuserNameâ€:â€ddâ€,â€ageâ€:120,â€isFalseâ€:true,â€birthdayâ€:â€21010-21-12â€}</p>

<p>è¾“å‡ºç»“æœï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å‡ºç”Ÿæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®
å¿…é¡»ä¸ºfalse
å¹´é¾„ä¸æ­£ç¡®
</code></pre></div></div>

<p>å‚æ•°éªŒè¯éå¸¸æ–¹ä¾¿ï¼Œå­—æ®µä¸Šæ³¨è§£+éªŒè¯ä¸é€šè¿‡æç¤ºä¿¡æ¯å³å¯ä»£æ›¿æ‰‹å†™ä¸€å¤§å †çš„éç©ºå’Œå­—æ®µé™åˆ¶éªŒè¯ä»£ç ã€‚ä¸‹é¢æ·±å…¥äº†è§£ä¸‹å‚æ•°æ ¡éªŒçš„ç©æ³•ã€‚</p>

<p>æœ¬æ–‡åœ°å€ï¼šhttp://www.cnblogs.com/mr-yang-localhost/p/7812038.html</p>

<h2 id="ä¸‰hibernateçš„æ ¡éªŒæ¨¡å¼">ä¸‰ã€hibernateçš„æ ¡éªŒæ¨¡å¼</h2>
<p>ç»†å¿ƒçš„è¯»è€…è‚¯å®šå‘ç°äº†ï¼šä¸Šé¢ä¾‹å­ä¸­ä¸€æ¬¡æ€§è¿”å›äº†æ‰€æœ‰éªŒè¯ä¸é€šè¿‡çš„é›†åˆï¼Œé€šå¸¸æŒ‰é¡ºåºéªŒè¯åˆ°ç¬¬ä¸€ä¸ªå­—æ®µä¸ç¬¦åˆéªŒè¯è¦æ±‚æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥æ‹’ç»è¯·æ±‚äº†ã€‚Hibernate Validatoræœ‰ä»¥ä¸‹ä¸¤ç§éªŒè¯æ¨¡å¼ï¼š</p>

<p>è¿”å›ç›®å½•</p>
<h3 id="1æ™®é€šæ¨¡å¼é»˜è®¤æ˜¯è¿™ä¸ªæ¨¡å¼">1ã€æ™®é€šæ¨¡å¼ï¼ˆé»˜è®¤æ˜¯è¿™ä¸ªæ¨¡å¼ï¼‰</h3>
<p>æ™®é€šæ¨¡å¼(ä¼šæ ¡éªŒå®Œæ‰€æœ‰çš„å±æ€§ï¼Œç„¶åè¿”å›æ‰€æœ‰çš„éªŒè¯å¤±è´¥ä¿¡æ¯)</p>

<h3 id="2å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼">2ã€å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼</h3>
<p>å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼(åªè¦æœ‰ä¸€ä¸ªéªŒè¯å¤±è´¥ï¼Œåˆ™è¿”å›)</p>

<p>ä¸¤ç§éªŒè¯æ¨¡å¼é…ç½®æ–¹å¼ï¼šï¼ˆ<a href="https://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#section-provider-specific-settings">å‚è€ƒå®˜æ–¹æ–‡æ¡£</a>ï¼‰</p>

<p>failFastï¼štrue  å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼    false æ™®é€šæ¨¡å¼</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ValidatorFactory</span> <span class="n">validatorFactory</span> <span class="o">=</span> <span class="nc">Validation</span><span class="o">.</span><span class="na">byProvider</span><span class="o">(</span> <span class="nc">HibernateValidator</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span>
        <span class="o">.</span><span class="na">configure</span><span class="o">()</span>
        <span class="o">.</span><span class="na">failFast</span><span class="o">(</span> <span class="kc">true</span> <span class="o">)</span>
        <span class="o">.</span><span class="na">buildValidatorFactory</span><span class="o">();</span>
<span class="nc">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">validatorFactory</span><span class="o">.</span><span class="na">getValidator</span><span class="o">();</span>
</code></pre></div></div>
<p>å’Œ ï¼ˆhibernate.validator.fail_fastï¼štrue  å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼    false æ™®é€šæ¨¡å¼ï¼‰</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ValidatorFactory</span> <span class="n">validatorFactory</span> <span class="o">=</span> <span class="nc">Validation</span><span class="o">.</span><span class="na">byProvider</span><span class="o">(</span> <span class="nc">HibernateValidator</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span>
        <span class="o">.</span><span class="na">configure</span><span class="o">()</span>
        <span class="o">.</span><span class="na">addProperty</span><span class="o">(</span> <span class="s">"hibernate.validator.fail_fast"</span><span class="o">,</span> <span class="s">"true"</span> <span class="o">)</span>
        <span class="o">.</span><span class="na">buildValidatorFactory</span><span class="o">();</span>
<span class="nc">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">validatorFactory</span><span class="o">.</span><span class="na">getValidator</span><span class="o">();</span>
</code></pre></div></div>

<h2 id="å››hibernateçš„ä¸¤ç§æ ¡éªŒ">å››ã€hibernateçš„ä¸¤ç§æ ¡éªŒ</h2>
<p>é…ç½®hibernate Validatorä¸ºå¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ValidatorConfiguration</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Validator</span> <span class="nf">validator</span><span class="o">(){</span>
        <span class="nc">ValidatorFactory</span> <span class="n">validatorFactory</span> <span class="o">=</span> <span class="nc">Validation</span><span class="o">.</span><span class="na">byProvider</span><span class="o">(</span> <span class="nc">HibernateValidator</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span>
                <span class="o">.</span><span class="na">configure</span><span class="o">()</span>
                <span class="o">.</span><span class="na">addProperty</span><span class="o">(</span> <span class="s">"hibernate.validator.fail_fast"</span><span class="o">,</span> <span class="s">"true"</span> <span class="o">)</span>
                <span class="o">.</span><span class="na">buildValidatorFactory</span><span class="o">();</span>
        <span class="nc">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">validatorFactory</span><span class="o">.</span><span class="na">getValidator</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">validator</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="1è¯·æ±‚å‚æ•°æ ¡éªŒ">1ã€è¯·æ±‚å‚æ•°æ ¡éªŒ</h3>
<p>å¦‚demoé‡Œç¤ºä¾‹çš„ï¼ŒéªŒè¯è¯·æ±‚å‚æ•°æ—¶ï¼Œåœ¨@RequestBody DemoModel demoä¹‹é—´åŠ æ³¨è§£ @Validï¼Œç„¶ååé¢åŠ BindindResultå³å¯ï¼›å¤šä¸ªå‚æ•°çš„ï¼Œå¯ä»¥åŠ å¤šä¸ª@Validå’ŒBindingResultï¼Œå¦‚ï¼š</p>

<p>public void test()(@RequestBody @Valid DemoModel demo, BindingResult result)</p>

<p>public void test()(@RequestBody @Valid DemoModel demo, BindingResult result,@RequestBody @Valid DemoModel demo2, BindingResult result2)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo2"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo2</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nd">@Valid</span> <span class="nc">DemoModel</span> <span class="n">demo</span><span class="o">,</span> <span class="nc">BindingResult</span> <span class="n">result</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">()){</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">ObjectError</span> <span class="n">error</span> <span class="o">:</span> <span class="n">result</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">error</span><span class="o">.</span><span class="na">getDefaultMessage</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<h3 id="2getå‚æ•°æ ¡éªŒrequestparamå‚æ•°æ ¡éªŒ">2ã€GETå‚æ•°æ ¡éªŒ(@RequestParamå‚æ•°æ ¡éªŒ)</h3>
<p>ä½¿ç”¨æ ¡éªŒbeançš„æ–¹å¼ï¼Œæ²¡æœ‰åŠæ³•æ ¡éªŒRequestParamçš„å†…å®¹ï¼Œä¸€èˆ¬åœ¨å¤„ç†Getè¯·æ±‚(æˆ–å‚æ•°æ¯”è¾ƒå°‘)çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/demo3"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo3</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"grade"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">grade</span><span class="o">,</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"classroom"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="kt">int</span> <span class="n">classroom</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">grade</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">classroom</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>
<p>ä½¿ç”¨@Validæ³¨è§£ï¼Œå¯¹RequestParamå¯¹åº”çš„å‚æ•°è¿›è¡Œæ³¨è§£ï¼Œæ˜¯æ— æ•ˆçš„ï¼Œéœ€è¦ä½¿ç”¨@Validatedæ³¨è§£æ¥ä½¿å¾—éªŒè¯ç”Ÿæ•ˆã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<h4 id="aæ­¤æ—¶éœ€è¦ä½¿ç”¨methodvalidationpostprocessor-çš„bean">a.æ­¤æ—¶éœ€è¦ä½¿ç”¨MethodValidationPostProcessor çš„Beanï¼š</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MethodValidationPostProcessor</span> <span class="nf">methodValidationPostProcessor</span><span class="o">()</span> <span class="o">{</span>
<span class="err">ã€€ã€€ã€€ã€€</span>  <span class="cm">/**é»˜è®¤æ˜¯æ™®é€šæ¨¡å¼ï¼Œä¼šè¿”å›æ‰€æœ‰çš„éªŒè¯ä¸é€šè¿‡ä¿¡æ¯é›†åˆ*/</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">MethodValidationPostProcessor</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></div></div>
<p>æˆ– å¯å¯¹MethodValidationPostProcessor è¿›è¡Œè®¾ç½®Validatorï¼ˆå› ä¸ºæ­¤æ—¶ä¸æ˜¯ç”¨çš„Validatorè¿›è¡ŒéªŒè¯ï¼ŒValidatorçš„é…ç½®ä¸èµ·ä½œç”¨ï¼‰</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MethodValidationPostProcessor</span> <span class="nf">methodValidationPostProcessor</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">MethodValidationPostProcessor</span> <span class="n">postProcessor</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MethodValidationPostProcessor</span><span class="o">();</span>
<span class="err">ã€€ã€€ã€€ã€€ã€€</span><span class="cm">/**è®¾ç½®validatoræ¨¡å¼ä¸ºå¿«é€Ÿå¤±è´¥è¿”å›*/</span>
        <span class="n">postProcessor</span><span class="o">.</span><span class="na">setValidator</span><span class="o">(</span><span class="n">validator</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">postProcessor</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">Validator</span> <span class="nf">validator</span><span class="o">(){</span>
        <span class="nc">ValidatorFactory</span> <span class="n">validatorFactory</span> <span class="o">=</span> <span class="nc">Validation</span><span class="o">.</span><span class="na">byProvider</span><span class="o">(</span> <span class="nc">HibernateValidator</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span>
                <span class="o">.</span><span class="na">configure</span><span class="o">()</span>
                <span class="o">.</span><span class="na">addProperty</span><span class="o">(</span> <span class="s">"hibernate.validator.fail_fast"</span><span class="o">,</span> <span class="s">"true"</span> <span class="o">)</span>
                <span class="o">.</span><span class="na">buildValidatorFactory</span><span class="o">();</span>
        <span class="nc">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">validatorFactory</span><span class="o">.</span><span class="na">getValidator</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">validator</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>

<h4 id="bæ–¹æ³•æ‰€åœ¨çš„controllerä¸ŠåŠ æ³¨è§£validated">b.æ–¹æ³•æ‰€åœ¨çš„Controllerä¸ŠåŠ æ³¨è§£@Validated</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/validation"</span><span class="o">)</span>
<span class="nd">@RestController</span>
<span class="nd">@Validated</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ValidationController</span> <span class="o">{</span>
    <span class="cm">/**å¦‚æœåªæœ‰å°‘æ•°å¯¹è±¡ï¼Œç›´æ¥æŠŠå‚æ•°å†™åˆ°Controllerå±‚ï¼Œç„¶ååœ¨Controllerå±‚è¿›è¡ŒéªŒè¯å°±å¯ä»¥äº†ã€‚*/</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/demo3"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo3</span><span class="o">(</span><span class="nd">@Range</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">9</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"å¹´çº§åªèƒ½ä»1-9"</span><span class="o">)</span>
                      <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"grade"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
                      <span class="kt">int</span> <span class="n">grade</span><span class="o">,</span>
                      <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"ç­çº§æœ€å°åªèƒ½1"</span><span class="o">)</span>
                      <span class="nd">@Max</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">99</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"ç­çº§æœ€å¤§åªèƒ½99"</span><span class="o">)</span>
                      <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"classroom"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
                      <span class="kt">int</span> <span class="n">classroom</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">grade</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">classroom</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="cè¿”å›éªŒè¯ä¿¡æ¯æç¤º">c.è¿”å›éªŒè¯ä¿¡æ¯æç¤º</h4>

<p>å¯ä»¥çœ‹åˆ°ï¼šéªŒè¯ä¸é€šè¿‡æ—¶ï¼ŒæŠ›å‡ºäº†ConstraintViolationExceptionå¼‚å¸¸ï¼Œä½¿ç”¨åŒä¸€æ•è·å¼‚å¸¸å¤„ç†ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ControllerAdvice</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="o">{</span>

    <span class="nd">@ExceptionHandler</span>
    <span class="nd">@ResponseBody</span>
    <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">BAD_REQUEST</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">ValidationException</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">exception</span> <span class="k">instanceof</span> <span class="nc">ConstraintViolationException</span><span class="o">){</span>
            <span class="nc">ConstraintViolationException</span> <span class="n">exs</span> <span class="o">=</span> <span class="o">(</span><span class="nc">ConstraintViolationException</span><span class="o">)</span> <span class="n">exception</span><span class="o">;</span>

            <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">violations</span> <span class="o">=</span> <span class="n">exs</span><span class="o">.</span><span class="na">getConstraintViolations</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">ConstraintViolation</span><span class="o">&lt;?&gt;</span> <span class="n">item</span> <span class="o">:</span> <span class="n">violations</span><span class="o">)</span> <span class="o">{</span>
<span class="err">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span><span class="cm">/**æ‰“å°éªŒè¯ä¸é€šè¿‡çš„ä¿¡æ¯*/</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">"bad request, "</span> <span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="déªŒè¯">d.éªŒè¯</h4>

<p>æµè§ˆå™¨æœåŠ¡è¯·æ±‚åœ°å€ï¼šhttp://localhost:8080/validation/demo3?grade=18&amp;classroom=888</p>

<p>æ²¡æœ‰é…ç½®å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¹´çº§åªèƒ½ä»1-9
ç­çº§æœ€å¤§åªèƒ½99
</code></pre></div></div>
<p>é…ç½®äº†å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¹´çº§åªèƒ½ä»1-9
</code></pre></div></div>
<p>æµè§ˆå™¨æœåŠ¡è¯·æ±‚åœ°å€ï¼šhttp://localhost:8080/validation/demo3?grade=0&amp;classroom=0</p>

<p>æ²¡æœ‰é…ç½®å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¹´çº§åªèƒ½ä»1-9
ç­çº§æœ€å°åªèƒ½1
</code></pre></div></div>
<p>é…ç½®äº†å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¹´çº§åªèƒ½ä»1-9
</code></pre></div></div>

<h3 id="3modelæ ¡éªŒ">3ã€modelæ ¡éªŒ</h3>
<p>å¾…æ ¡éªŒçš„modelï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo2</span> <span class="o">{</span>
    <span class="nd">@Length</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">5</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">17</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"lengthé•¿åº¦åœ¨[5,17]ä¹‹é—´"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">length</span><span class="o">;</span>

    <span class="cm">/**@Sizeä¸èƒ½éªŒè¯Integerï¼Œé€‚ç”¨äºString, Collection, Map and arrays*/</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">3</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"sizeåœ¨[1,3]ä¹‹é—´"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@Range</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">150</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">250</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"rangeåœ¨[150,250]ä¹‹é—´"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">high</span><span class="o">;</span>

    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">3</span><span class="o">,</span><span class="n">max</span> <span class="o">=</span> <span class="mi">5</span><span class="o">,</span><span class="n">message</span> <span class="o">=</span> <span class="s">"listçš„Sizeåœ¨[3,5]"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>éªŒè¯modelï¼Œä»¥ä¸‹å…¨éƒ¨éªŒè¯é€šè¿‡ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Validator</span> <span class="n">validator</span><span class="o">;</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo3"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo3</span><span class="o">(){</span>
        <span class="nc">Demo2</span> <span class="n">demo2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Demo2</span><span class="o">();</span>
        <span class="n">demo2</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="s">"111"</span><span class="o">);</span>
        <span class="n">demo2</span><span class="o">.</span><span class="na">setHigh</span><span class="o">(</span><span class="mi">150</span><span class="o">);</span>
        <span class="n">demo2</span><span class="o">.</span><span class="na">setLength</span><span class="o">(</span><span class="s">"ABCDE"</span><span class="o">);</span>
        <span class="n">demo2</span><span class="o">.</span><span class="na">setList</span><span class="o">(</span><span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;());</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Demo2</span><span class="o">&gt;&gt;</span> <span class="n">violationSet</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">demo2</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Demo2</span><span class="o">&gt;</span> <span class="n">model</span> <span class="o">:</span> <span class="n">violationSet</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">model</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<h3 id="4å¯¹è±¡çº§è”æ ¡éªŒ">4ã€å¯¹è±¡çº§è”æ ¡éªŒ</h3>
<p>å¯¹è±¡å†…éƒ¨åŒ…å«å¦ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå±æ€§ï¼Œå±æ€§ä¸ŠåŠ @Validï¼Œå¯ä»¥éªŒè¯ä½œä¸ºå±æ€§çš„å¯¹è±¡å†…éƒ¨çš„éªŒè¯ï¼šï¼ˆéªŒè¯Demo2ç¤ºä¾‹æ—¶ï¼Œå¯ä»¥éªŒè¯Demo2çš„å­—æ®µï¼‰</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo2</span> <span class="o">{</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">3</span><span class="o">,</span><span class="n">max</span> <span class="o">=</span> <span class="mi">5</span><span class="o">,</span><span class="n">message</span> <span class="o">=</span> <span class="s">"listçš„Sizeåœ¨[3,5]"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Valid</span>
    <span class="kd">private</span> <span class="nc">Demo3</span> <span class="n">demo3</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo3</span> <span class="o">{</span>
    <span class="nd">@Length</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">5</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">17</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"lengthé•¿åº¦åœ¨[5,17]ä¹‹é—´"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">extField</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>çº§è”æ ¡éªŒï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="cm">/**å‰é¢é…ç½®äº†å¿«é€Ÿå¤±è´¥è¿”å›çš„Bean*/</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Validator</span> <span class="n">validator</span><span class="o">;</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo3"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo3</span><span class="o">(){</span>
        <span class="nc">Demo2</span> <span class="n">demo2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Demo2</span><span class="o">();</span>
        <span class="n">demo2</span><span class="o">.</span><span class="na">setList</span><span class="o">(</span><span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;());</span>

        <span class="nc">Demo3</span> <span class="n">demo3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Demo3</span><span class="o">();</span>
        <span class="n">demo3</span><span class="o">.</span><span class="na">setExtField</span><span class="o">(</span><span class="s">"22"</span><span class="o">);</span>
        <span class="n">demo2</span><span class="o">.</span><span class="na">setDemo3</span><span class="o">(</span><span class="n">demo3</span><span class="o">);</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Demo2</span><span class="o">&gt;&gt;</span> <span class="n">violationSet</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">demo2</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Demo2</span><span class="o">&gt;</span> <span class="n">model</span> <span class="o">:</span> <span class="n">violationSet</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">model</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>å¯ä»¥æ ¡éªŒDemo3çš„extFieldå­—æ®µã€‚</p>

<h3 id="5åˆ†ç»„æ ¡éªŒ">5ã€åˆ†ç»„æ ¡éªŒ</h3>
<p>ç»“è®ºï¼šåˆ†ç»„é¡ºåºæ ¡éªŒæ—¶ï¼ŒæŒ‰æŒ‡å®šçš„åˆ†ç»„å…ˆåé¡ºåºè¿›è¡ŒéªŒè¯ï¼Œå‰é¢çš„éªŒè¯ä¸é€šè¿‡ï¼Œåé¢çš„åˆ†ç»„å°±ä¸è¡ŒéªŒè¯ã€‚</p>

<p>æœ‰è¿™æ ·ä¸€ç§åœºæ™¯ï¼Œæ–°å¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™ï¼Œä¸éœ€è¦éªŒè¯userIdï¼ˆå› ä¸ºç³»ç»Ÿç”Ÿæˆï¼‰ï¼›ä¿®æ”¹çš„æ—¶å€™éœ€è¦éªŒè¯userIdï¼Œè¿™æ—¶å€™å¯ç”¨ç”¨æˆ·åˆ°validatorçš„åˆ†ç»„éªŒè¯åŠŸèƒ½ã€‚</p>

<p>è®¾ç½®validatorä¸ºæ™®é€šéªŒè¯æ¨¡å¼ï¼ˆâ€hibernate.validator.fail_fastâ€, â€œfalseâ€ï¼‰ï¼Œç”¨åˆ°çš„éªŒè¯GroupAã€GroupBå’Œmodelï¼š</p>

<p>GroupAã€GroupBï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">GroupA</span> <span class="o">{</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">GroupB</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>
<p>éªŒè¯modelï¼šPerson</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
    <span class="nd">@NotBlank</span>
    <span class="nd">@Range</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span><span class="n">max</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">,</span><span class="n">message</span> <span class="o">=</span> <span class="s">"å¿…é¡»å¤§äº0"</span><span class="o">,</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span><span class="nc">GroupA</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="cm">/**ç”¨æˆ·id*/</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">userId</span><span class="o">;</span>
    <span class="nd">@NotBlank</span>
    <span class="nd">@Length</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">4</span><span class="o">,</span><span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">,</span><span class="n">message</span> <span class="o">=</span> <span class="s">"å¿…é¡»åœ¨[4,20]"</span><span class="o">,</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span><span class="nc">GroupB</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="cm">/**ç”¨æˆ·å*/</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">userName</span><span class="o">;</span>
    <span class="nd">@NotBlank</span>
    <span class="nd">@Range</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span><span class="n">max</span> <span class="o">=</span> <span class="mi">100</span><span class="o">,</span><span class="n">message</span> <span class="o">=</span> <span class="s">"å¹´é¾„å¿…é¡»åœ¨[0,100]"</span><span class="o">,</span><span class="n">groups</span><span class="o">={</span><span class="nc">Default</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="cm">/**å¹´é¾„*/</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">age</span><span class="o">;</span>
    <span class="nd">@Range</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span><span class="n">max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span><span class="n">message</span> <span class="o">=</span> <span class="s">"æ€§åˆ«å¿…é¡»åœ¨[0,2]"</span><span class="o">,</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span><span class="nc">GroupB</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="cm">/**æ€§åˆ« 0ï¼šæœªçŸ¥ï¼›1ï¼šç”·ï¼›2ï¼šå¥³*/</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">sex</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>å¦‚ä¸ŠPersonæ‰€ç¤ºï¼Œ3ä¸ªåˆ†ç»„åˆ†åˆ«éªŒè¯å­—æ®µå¦‚ä¸‹ï¼š</p>

<ul>
  <li>GroupAéªŒè¯å­—æ®µuserIdï¼›</li>
  <li>GroupBéªŒè¯å­—æ®µuserNameã€sexï¼›</li>
  <li>DefaultéªŒè¯å­—æ®µage(Defaultæ˜¯Validatorè‡ªå¸¦çš„é»˜è®¤åˆ†ç»„)</li>
</ul>

<h4 id="aåˆ†ç»„">aã€åˆ†ç»„</h4>

<p>åªéªŒè¯GroupAã€GroupBæ ‡è®°çš„åˆ†ç»„ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo5"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo5</span><span class="o">(){</span>
    <span class="nc">Person</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">();</span>
    <span class="cm">/**GroupAéªŒè¯ä¸é€šè¿‡*/</span>
    <span class="n">p</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(-</span><span class="mi">12</span><span class="o">);</span>
    <span class="cm">/**GroupAéªŒè¯é€šè¿‡*/</span>
    <span class="c1">//p.setUserId(12);</span>
    <span class="n">p</span><span class="o">.</span><span class="na">setUserName</span><span class="o">(</span><span class="s">"a"</span><span class="o">);</span>
    <span class="n">p</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="mi">110</span><span class="o">);</span>
    <span class="n">p</span><span class="o">.</span><span class="na">setSex</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
    <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Person</span><span class="o">&gt;&gt;</span> <span class="n">validate</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="nc">GroupA</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">GroupB</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Person</span><span class="o">&gt;</span> <span class="n">item</span> <span class="o">:</span> <span class="n">validate</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>æˆ–</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo6"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo6</span><span class="o">(</span><span class="nd">@Validated</span><span class="o">({</span><span class="nc">GroupA</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">GroupB</span><span class="o">.</span><span class="na">class</span><span class="o">})</span> <span class="nc">Person</span> <span class="n">p</span><span class="o">,</span> <span class="nc">BindingResult</span> <span class="n">result</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">()){</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ObjectError</span><span class="o">&gt;</span> <span class="n">allErrors</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">ObjectError</span> <span class="n">error</span> <span class="o">:</span> <span class="n">allErrors</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">error</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<p><strong>GroupAã€GroupBã€Defaultéƒ½éªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</strong></p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ConstraintViolationImpl{interpolatedMessage='å¿…é¡»åœ¨[4,20]', propertyPath=userName, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='å¿…é¡»åœ¨[4,20]'}
ConstraintViolationImpl{interpolatedMessage='å¿…é¡»å¤§äº0', propertyPath=userId, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='å¿…é¡»å¤§äº0'}
ConstraintViolationImpl{interpolatedMessage='æ€§åˆ«å¿…é¡»åœ¨[0,2]', propertyPath=sex, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='æ€§åˆ«å¿…é¡»åœ¨[0,2]'}
</code></pre></div></div>
<p><strong>GroupAéªŒè¯é€šè¿‡ã€GroupBã€DefaultéªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</strong></p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ConstraintViolationImpl{interpolatedMessage='å¿…é¡»åœ¨[4,20]', propertyPath=userName, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='å¿…é¡»åœ¨[4,20]'}
ConstraintViolationImpl{interpolatedMessage='æ€§åˆ«å¿…é¡»åœ¨[0,2]', propertyPath=sex, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='æ€§åˆ«å¿…é¡»åœ¨[0,2]'}
</code></pre></div></div>

<h4 id="bç»„åºåˆ—">bã€ç»„åºåˆ—</h4>

<p>é™¤äº†æŒ‰ç»„æŒ‡å®šæ˜¯å¦éªŒè¯ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šç»„çš„éªŒè¯é¡ºåºï¼Œå‰é¢ç»„éªŒè¯ä¸é€šè¿‡çš„ï¼Œåé¢ç»„ä¸è¿›è¡ŒéªŒè¯ï¼š</p>

<p>æŒ‡å®šç»„çš„åºåˆ—ï¼ˆGroupAã€‹GroupBã€‹Defaultï¼‰ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GroupSequence</span><span class="o">({</span><span class="nc">GroupA</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">GroupB</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Default</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">GroupOrder</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>
<p>æµ‹è¯•demoï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo7"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo7</span><span class="o">(){</span>
        <span class="nc">Person</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">();</span>
        <span class="cm">/**GroupAéªŒè¯ä¸é€šè¿‡*/</span>
        <span class="c1">//p.setUserId(-12);</span>
        <span class="cm">/**GroupAéªŒè¯é€šè¿‡*/</span>
        <span class="n">p</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>
        <span class="n">p</span><span class="o">.</span><span class="na">setUserName</span><span class="o">(</span><span class="s">"a"</span><span class="o">);</span>
        <span class="n">p</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="mi">110</span><span class="o">);</span>
        <span class="n">p</span><span class="o">.</span><span class="na">setSex</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Person</span><span class="o">&gt;&gt;</span> <span class="n">validate</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="nc">GroupOrder</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="nc">Person</span><span class="o">&gt;</span> <span class="n">item</span> <span class="o">:</span> <span class="n">validate</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>æˆ–</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/demo8"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demo8</span><span class="o">(</span><span class="nd">@Validated</span><span class="o">({</span><span class="nc">GroupOrder</span><span class="o">.</span><span class="na">class</span><span class="o">})</span> <span class="nc">Person</span> <span class="n">p</span><span class="o">,</span> <span class="nc">BindingResult</span> <span class="n">result</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">()){</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ObjectError</span><span class="o">&gt;</span> <span class="n">allErrors</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">ObjectError</span> <span class="n">error</span> <span class="o">:</span> <span class="n">allErrors</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">error</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<p><strong>GroupAã€GroupBã€Defaultéƒ½éªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</strong></p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ConstraintViolationImpl{interpolatedMessage='å¿…é¡»å¤§äº0', propertyPath=userId, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='å¿…é¡»å¤§äº0'}
</code></pre></div></div>
<p><strong>GroupAéªŒè¯é€šè¿‡ã€GroupBã€DefaultéªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</strong></p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ConstraintViolationImpl{interpolatedMessage='å¿…é¡»åœ¨[4,20]', propertyPath=userName, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='å¿…é¡»åœ¨[4,20]'}
ConstraintViolationImpl{interpolatedMessage='æ€§åˆ«å¿…é¡»åœ¨[0,2]', propertyPath=sex, rootBeanClass=class validator.demo.project.model.Person, messageTemplate='æ€§åˆ«å¿…é¡»åœ¨[0,2]'}
</code></pre></div></div>
<p>ç»“è®ºï¼š<em>åˆ†ç»„é¡ºåºæ ¡éªŒæ—¶ï¼ŒæŒ‰æŒ‡å®šçš„åˆ†ç»„å…ˆåé¡ºåºè¿›è¡ŒéªŒè¯ï¼Œå‰é¢çš„éªŒè¯ä¸é€šè¿‡ï¼Œåé¢çš„åˆ†ç»„å°±ä¸è¡ŒéªŒè¯ã€‚</em></p>

<h2 id="äº”è‡ªå®šä¹‰éªŒè¯å™¨">äº”ã€è‡ªå®šä¹‰éªŒè¯å™¨</h2>
<p>ä¸€èˆ¬æƒ…å†µï¼Œè‡ªå®šä¹‰éªŒè¯å¯ä»¥è§£å†³å¾ˆå¤šé—®é¢˜ã€‚ä½†ä¹Ÿæœ‰æ— æ³•æ»¡è¶³æƒ…å†µçš„æ—¶å€™ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°validatorçš„æ¥å£ï¼Œè‡ªå®šä¹‰è‡ªå·±éœ€è¦çš„éªŒè¯å™¨ã€‚</p>

<p>å¦‚ä¸‹æ‰€ç¤ºï¼Œå®ç°äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„å¤§å°å†™éªŒè¯å™¨ï¼š</p>

<p>å¤åˆ¶ä»£ç 
public enum CaseMode {
    UPPER,
    LOWER;
}</p>

<p>@Target( { ElementType.METHOD, ElementType.FIELD, ElementType.ANNOTATION_TYPE })
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = CheckCaseValidator.class)
@Documented
public @interface CheckCase {
    String message() default â€œâ€;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Class&lt;?&gt;[] groups() default {};

Class&lt;? extends Payload&gt;[] payload() default {};

CaseMode value(); }
</code></pre></div></div>

<p>public class CheckCaseValidator implements ConstraintValidator&lt;CheckCase, String&gt; {
    private CaseMode caseMode;
    public void initialize(CheckCase checkCase) {
        this.caseMode = checkCase.value();
    }</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean isValid(String s, ConstraintValidatorContext constraintValidatorContext) {
    if (s == null) {
        return true;
    }

    if (caseMode == CaseMode.UPPER) {
        return s.equals(s.toUpperCase());
    } else {
        return s.equals(s.toLowerCase());
    }
} } å¤åˆ¶ä»£ç  è¦éªŒè¯çš„Modelï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    public class Demo{
        @CheckCase(value = CaseMode.LOWER,message = â€œuserNameå¿…é¡»æ˜¯å°å†™â€)
        private String userName;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }
} å¤åˆ¶ä»£ç  validatoré…ç½®ï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    @Bean
    public Validator validator(){
        ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
                .configure()
                .addProperty( â€œhibernate.validator.fail_fastâ€, â€œtrueâ€ )
                .buildValidatorFactory();
        Validator validator = validatorFactory.getValidator();</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    return validator;
} å¤åˆ¶ä»£ç  éªŒè¯æµ‹è¯•ï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    @RequestMapping(â€œ/demo4â€)
    public void demo4(){
        Demo demo = new Demo();
        demo.setUserName(â€œuserNameâ€);
        Set&lt;ConstraintViolation<Demo>&gt; validate = validator.validate(demo);
        for (ConstraintViolation<Demo> dem : validate) {
            System.out.println(dem.getMessage());
        }
    }
å¤åˆ¶ä»£ç 
è¾“å‡ºç»“æœï¼š</Demo></Demo></p>

<p>userNameå¿…é¡»æ˜¯å°å†™</p>

<p>è¿”å›ç›®å½•
å…­ã€å¸¸è§çš„æ³¨è§£
  Bean Validation ä¸­å†…ç½®çš„ constraint   <br />
@Null   è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º null   <br />
@NotNull    è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ä¸º null   <br />
@AssertTrue     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º true   <br />
@AssertFalse    è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º false   <br />
@Min(value)     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼   <br />
@Max(value)     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼   <br />
@DecimalMin(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼   <br />
@DecimalMax(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼   <br />
@Size(max=, min=)   è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…   <br />
@Digits (integer, fraction)     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…   <br />
@Past   è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ   <br />
@Future     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ   <br />
@Pattern(regex=,flag=)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼   <br />
Hibernate Validator é™„åŠ çš„ constraint   <br />
@NotBlank(message =)   éªŒè¯å­—ç¬¦ä¸²énullï¼Œä¸”é•¿åº¦å¿…é¡»å¤§äº0   <br />
@Email  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ç®±åœ°å€   <br />
@Length(min=,max=)  è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…   <br />
@NotEmpty   è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¿…é¡»éç©º   <br />
@Range(min=,max=,message=)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…</p>

<p>//å¤§äº0.01ï¼Œä¸åŒ…å«0.01
@NotNull
@DecimalMin(value = â€œ0.01â€, inclusive = false)
private Integer greaterThan;</p>

<p>//å¤§äºç­‰äº0.01
@NotNull
@DecimalMin(value = â€œ0.01â€, inclusive = true)
private BigDecimal greatOrEqualThan;</p>

<p>@Length(min = 1, max = 20, message = â€œmessageä¸èƒ½ä¸ºç©ºâ€)
//ä¸èƒ½å°†Lengthé”™ç”¨æˆRange
//@Range(min = 1, max = 20, message = â€œmessageä¸èƒ½ä¸ºç©ºâ€)
private String message;</p>
:ET