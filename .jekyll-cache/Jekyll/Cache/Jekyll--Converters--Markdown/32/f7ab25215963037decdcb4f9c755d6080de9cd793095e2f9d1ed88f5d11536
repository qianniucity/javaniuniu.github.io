I"¬Y<h2 id="ä¸€å‚æ•°æ ¡éªŒ">ä¸€ã€å‚æ•°æ ¡éªŒ</h2>
<p>åœ¨å¼€å‘ä¸­ç»å¸¸éœ€è¦å†™ä¸€äº›å­—æ®µæ ¡éªŒçš„ä»£ç ï¼Œæ¯”å¦‚å­—æ®µéç©ºï¼Œå­—æ®µé•¿åº¦é™åˆ¶ï¼Œé‚®ç®±æ ¼å¼éªŒè¯ç­‰ç­‰ï¼Œå†™è¿™äº›ä¸ä¸šåŠ¡é€»è¾‘å…³ç³»ä¸å¤§çš„ä»£ç ä¸ªäººæ„Ÿè§‰æœ‰ä¸¤ä¸ªéº»çƒ¦ï¼š</p>

<ul>
  <li>éªŒè¯ä»£ç ç¹çï¼Œé‡å¤åŠ³åŠ¨</li>
  <li>æ–¹æ³•å†…ä»£ç æ˜¾å¾—å†—é•¿</li>
  <li>æ¯æ¬¡è¦çœ‹å“ªäº›å‚æ•°éªŒè¯æ˜¯å¦å®Œæ•´ï¼Œéœ€è¦å»ç¿»é˜…éªŒè¯é€»è¾‘ä»£ç 
hibernate validator <a href="http://hibernate.org/validator/documentation/">ï¼ˆå®˜æ–¹æ–‡æ¡£ï¼‰</a>æä¾›äº†ä¸€å¥—æ¯”è¾ƒå®Œå–„ã€ä¾¿æ·çš„éªŒè¯å®ç°æ–¹å¼ã€‚</li>
</ul>

<p>spring-boot-starter-webåŒ…é‡Œé¢æœ‰hibernate-validatoråŒ…ï¼Œä¸éœ€è¦å¼•ç”¨hibernate validatorä¾èµ–ã€‚</p>

<p>è¿”å›ç›®å½•
äºŒã€hibernate validatoræ ¡éªŒdemo
 å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„demoï¼Œæ·»åŠ äº†Validatorçš„æ³¨è§£ï¼š</p>

<p>import org.hibernate.validator.constraints.NotBlank;</p>

<p>import javax.validation.constraints.AssertFalse;
import javax.validation.constraints.Pattern;
å¤åˆ¶ä»£ç 
@Getter
@Setter
@NoArgsConstructor
public class DemoModel {
    @NotBlank(message=â€ç”¨æˆ·åä¸èƒ½ä¸ºç©ºâ€)
    private String userName;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@NotBlank(message="å¹´é¾„ä¸èƒ½ä¸ºç©º")
@Pattern(regexp="^[0-9]{1,2}$",message="å¹´é¾„ä¸æ­£ç¡®")
private String age;

@AssertFalse(message = "å¿…é¡»ä¸ºfalse")
private Boolean isFalse;
/**
 * å¦‚æœæ˜¯ç©ºï¼Œåˆ™ä¸æ ¡éªŒï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™æ ¡éªŒ
 */
@Pattern(regexp="^[0-9]{4}-[0-9]{2}-[0-9]{2}$",message="å‡ºç”Ÿæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®")
private String birthday; } å¤åˆ¶ä»£ç  POSTæ¥å£éªŒè¯ï¼ŒBindingResultæ˜¯éªŒè¯ä¸é€šè¿‡çš„ç»“æœé›†åˆï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    @RequestMapping(â€œ/demo2â€)
    public void demo2(@RequestBody @Valid DemoModel demo, BindingResult result){
        if(result.hasErrors()){
            for (ObjectError error : result.getAllErrors()) {
                System.out.println(error.getDefaultMessage());
            }
        }
    }
å¤åˆ¶ä»£ç 
POSTè¯·æ±‚ä¼ å…¥çš„å‚æ•°ï¼š{â€œuserNameâ€:â€ddâ€,â€ageâ€:120,â€isFalseâ€:true,â€birthdayâ€:â€21010-21-12â€}</p>

<p>è¾“å‡ºç»“æœï¼š</p>

<p>å‡ºç”Ÿæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®
å¿…é¡»ä¸ºfalse
å¹´é¾„ä¸æ­£ç¡®</p>

<p>å‚æ•°éªŒè¯éå¸¸æ–¹ä¾¿ï¼Œå­—æ®µä¸Šæ³¨è§£+éªŒè¯ä¸é€šè¿‡æç¤ºä¿¡æ¯å³å¯ä»£æ›¿æ‰‹å†™ä¸€å¤§å †çš„éç©ºå’Œå­—æ®µé™åˆ¶éªŒè¯ä»£ç ã€‚ä¸‹é¢æ·±å…¥äº†è§£ä¸‹å‚æ•°æ ¡éªŒçš„ç©æ³•ã€‚</p>

<p>æœ¬æ–‡åœ°å€ï¼šhttp://www.cnblogs.com/mr-yang-localhost/p/7812038.html</p>

<p>è¿”å›ç›®å½•
ä¸‰ã€hibernateçš„æ ¡éªŒæ¨¡å¼
ç»†å¿ƒçš„è¯»è€…è‚¯å®šå‘ç°äº†ï¼šä¸Šé¢ä¾‹å­ä¸­ä¸€æ¬¡æ€§è¿”å›äº†æ‰€æœ‰éªŒè¯ä¸é€šè¿‡çš„é›†åˆï¼Œé€šå¸¸æŒ‰é¡ºåºéªŒè¯åˆ°ç¬¬ä¸€ä¸ªå­—æ®µä¸ç¬¦åˆéªŒè¯è¦æ±‚æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥æ‹’ç»è¯·æ±‚äº†ã€‚Hibernate Validatoræœ‰ä»¥ä¸‹ä¸¤ç§éªŒè¯æ¨¡å¼ï¼š</p>

<p>è¿”å›ç›®å½•
1ã€æ™®é€šæ¨¡å¼ï¼ˆé»˜è®¤æ˜¯è¿™ä¸ªæ¨¡å¼ï¼‰
ã€€ã€€æ™®é€šæ¨¡å¼(ä¼šæ ¡éªŒå®Œæ‰€æœ‰çš„å±æ€§ï¼Œç„¶åè¿”å›æ‰€æœ‰çš„éªŒè¯å¤±è´¥ä¿¡æ¯)</p>

<p>è¿”å›ç›®å½•
2ã€å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼
ã€€ã€€å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼(åªè¦æœ‰ä¸€ä¸ªéªŒè¯å¤±è´¥ï¼Œåˆ™è¿”å›)</p>

<p>ä¸¤ç§éªŒè¯æ¨¡å¼é…ç½®æ–¹å¼ï¼šï¼ˆå‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼‰</p>

<p>failFastï¼štrue  å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼    false æ™®é€šæ¨¡å¼</p>

<p>ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
        .configure()
        .failFast( true )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();
å’Œ ï¼ˆhibernate.validator.fail_fastï¼štrue  å¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼    false æ™®é€šæ¨¡å¼ï¼‰</p>

<p>ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
        .configure()
        .addProperty( â€œhibernate.validator.fail_fastâ€, â€œtrueâ€ )
        .buildValidatorFactory();
Validator validator = validatorFactory.getValidator();
è¿”å›ç›®å½•
å››ã€hibernateçš„ä¸¤ç§æ ¡éªŒ
é…ç½®hibernate Validatorä¸ºå¿«é€Ÿå¤±è´¥è¿”å›æ¨¡å¼ï¼š</p>

<p>å¤åˆ¶ä»£ç 
@Configuration
public class ValidatorConfiguration {
    @Bean
    public Validator validator(){
        ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
                .configure()
                .addProperty( â€œhibernate.validator.fail_fastâ€, â€œtrueâ€ )
                .buildValidatorFactory();
        Validator validator = validatorFactory.getValidator();</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    return validator;
} } å¤åˆ¶ä»£ç  è¿”å›ç›®å½• 1ã€è¯·æ±‚å‚æ•°æ ¡éªŒ å¦‚demoé‡Œç¤ºä¾‹çš„ï¼ŒéªŒè¯è¯·æ±‚å‚æ•°æ—¶ï¼Œåœ¨@RequestBody DemoModel demoä¹‹é—´åŠ æ³¨è§£ @Validï¼Œç„¶ååé¢åŠ BindindResultå³å¯ï¼›å¤šä¸ªå‚æ•°çš„ï¼Œå¯ä»¥åŠ å¤šä¸ª@Validå’ŒBindingResultï¼Œå¦‚ï¼š
</code></pre></div></div>

<p>public void test()(@RequestBody @Valid DemoModel demo, BindingResult result)</p>

<p>public void test()(@RequestBody @Valid DemoModel demo, BindingResult result,@RequestBody @Valid DemoModel demo2, BindingResult result2)</p>

<p>å¤åˆ¶ä»£ç 
    @RequestMapping(â€œ/demo2â€)
    public void demo2(@RequestBody @Valid DemoModel demo, BindingResult result){
        if(result.hasErrors()){
            for (ObjectError error : result.getAllErrors()) {
                System.out.println(error.getDefaultMessage());
            }
        }
    }
å¤åˆ¶ä»£ç 
è¿”å›ç›®å½•
2ã€GETå‚æ•°æ ¡éªŒ(@RequestParamå‚æ•°æ ¡éªŒ)
ä½¿ç”¨æ ¡éªŒbeançš„æ–¹å¼ï¼Œæ²¡æœ‰åŠæ³•æ ¡éªŒRequestParamçš„å†…å®¹ï¼Œä¸€èˆ¬åœ¨å¤„ç†Getè¯·æ±‚(æˆ–å‚æ•°æ¯”è¾ƒå°‘)çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@RequestMapping(value = "/demo3", method = RequestMethod.GET)
public void demo3(@RequestParam(name = "grade", required = true) int grade,@RequestParam(name = "classroom", required = true) int classroom) {
    System.out.println(grade + "," + classroom);
} ä½¿ç”¨@Validæ³¨è§£ï¼Œå¯¹RequestParamå¯¹åº”çš„å‚æ•°è¿›è¡Œæ³¨è§£ï¼Œæ˜¯æ— æ•ˆçš„ï¼Œéœ€è¦ä½¿ç”¨@Validatedæ³¨è§£æ¥ä½¿å¾—éªŒè¯ç”Ÿæ•ˆã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š
</code></pre></div></div>

<p>è¿”å›ç›®å½•
a.æ­¤æ—¶éœ€è¦ä½¿ç”¨MethodValidationPostProcessor çš„Beanï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Bean
public MethodValidationPostProcessor methodValidationPostProcessor() { ã€€ã€€ã€€ã€€  /**é»˜è®¤æ˜¯æ™®é€šæ¨¡å¼ï¼Œä¼šè¿”å›æ‰€æœ‰çš„éªŒè¯ä¸é€šè¿‡ä¿¡æ¯é›†åˆ*/
    return new MethodValidationPostProcessor();
} æˆ– å¯å¯¹MethodValidationPostProcessor è¿›è¡Œè®¾ç½®Validatorï¼ˆå› ä¸ºæ­¤æ—¶ä¸æ˜¯ç”¨çš„Validatorè¿›è¡ŒéªŒè¯ï¼ŒValidatorçš„é…ç½®ä¸èµ·ä½œç”¨ï¼‰
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    @Bean
    public MethodValidationPostProcessor methodValidationPostProcessor() {
        MethodValidationPostProcessor postProcessor = new MethodValidationPostProcessor();
ã€€ã€€ã€€ã€€ã€€/<em>*è®¾ç½®validatoræ¨¡å¼ä¸ºå¿«é€Ÿå¤±è´¥è¿”å›</em>/
        postProcessor.setValidator(validator());
        return postProcessor;
    }</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Bean
public Validator validator(){
    ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
            .configure()
            .addProperty( "hibernate.validator.fail_fast", "true" )
            .buildValidatorFactory();
    Validator validator = validatorFactory.getValidator();

    return validator;
} å¤åˆ¶ä»£ç  è¿”å›ç›®å½• b.æ–¹æ³•æ‰€åœ¨çš„Controllerä¸ŠåŠ æ³¨è§£@Validated
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
@RequestMapping(â€œ/validationâ€)
@RestController
@Validated
public class ValidationController {
    /<em>*å¦‚æœåªæœ‰å°‘æ•°å¯¹è±¡ï¼Œç›´æ¥æŠŠå‚æ•°å†™åˆ°Controllerå±‚ï¼Œç„¶ååœ¨Controllerå±‚è¿›è¡ŒéªŒè¯å°±å¯ä»¥äº†ã€‚</em>/
    @RequestMapping(value = â€œ/demo3â€, method = RequestMethod.GET)
    public void demo3(@Range(min = 1, max = 9, message = â€œå¹´çº§åªèƒ½ä»1-9â€)
                      @RequestParam(name = â€œgradeâ€, required = true)
                      int grade,
                      @Min(value = 1, message = â€œç­çº§æœ€å°åªèƒ½1â€)
                      @Max(value = 99, message = â€œç­çº§æœ€å¤§åªèƒ½99â€)
                      @RequestParam(name = â€œclassroomâ€, required = true)
                      int classroom) {
        System.out.println(grade + â€œ,â€ + classroom);
    }
}
å¤åˆ¶ä»£ç 
è¿”å›ç›®å½•
c.è¿”å›éªŒè¯ä¿¡æ¯æç¤º</p>

<p>å¯ä»¥çœ‹åˆ°ï¼šéªŒè¯ä¸é€šè¿‡æ—¶ï¼ŒæŠ›å‡ºäº†ConstraintViolationExceptionå¼‚å¸¸ï¼Œä½¿ç”¨åŒä¸€æ•è·å¼‚å¸¸å¤„ç†ï¼š</p>

<p>å¤åˆ¶ä»£ç 
@ControllerAdvice
@Component
public class GlobalExceptionHandler {</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@ExceptionHandler
@ResponseBody
@ResponseStatus(HttpStatus.BAD_REQUEST)
public String handle(ValidationException exception) {
    if(exception instanceof ConstraintViolationException){
        ConstraintViolationException exs = (ConstraintViolationException) exception;

        Set&lt;ConstraintViolation&lt;?&gt;&gt; violations = exs.getConstraintViolations();
        for (ConstraintViolation&lt;?&gt; item : violations) { ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€/**æ‰“å°éªŒè¯ä¸é€šè¿‡çš„ä¿¡æ¯*/
            System.out.println(item.getMessage());
        }
    }
    return "bad request, " ;
} } å¤åˆ¶ä»£ç  è¿”å›ç›®å½• d.éªŒè¯
</code></pre></div></div>

<p>æµè§ˆå™¨æœåŠ¡è¯·æ±‚åœ°å€ï¼šhttp://localhost:8080/validation/demo3?grade=18&amp;classroom=888</p>

<p>æ²¡æœ‰é…ç½®å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<p>å¹´çº§åªèƒ½ä»1-9
ç­çº§æœ€å¤§åªèƒ½99
é…ç½®äº†å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<p>å¹´çº§åªèƒ½ä»1-9</p>

<p>æµè§ˆå™¨æœåŠ¡è¯·æ±‚åœ°å€ï¼šhttp://localhost:8080/validation/demo3?grade=0&amp;classroom=0</p>

<p>æ²¡æœ‰é…ç½®å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<p>å¹´çº§åªèƒ½ä»1-9
ç­çº§æœ€å°åªèƒ½1
é…ç½®äº†å¿«é€Ÿå¤±è´¥è¿”å›çš„MethodValidationPostProcessor æ—¶è¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<p>å¹´çº§åªèƒ½ä»1-9</p>

<p>è¿”å›ç›®å½•
3ã€modelæ ¡éªŒ
å¾…æ ¡éªŒçš„modelï¼š</p>

<p>å¤åˆ¶ä»£ç 
@Data
public class Demo2 {
    @Length(min = 5, max = 17, message = â€œlengthé•¿åº¦åœ¨[5,17]ä¹‹é—´â€)
    private String length;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/**@Sizeä¸èƒ½éªŒè¯Integerï¼Œé€‚ç”¨äºString, Collection, Map and arrays*/
@Size(min = 1, max = 3, message = "sizeåœ¨[1,3]ä¹‹é—´")
private String age;

@Range(min = 150, max = 250, message = "rangeåœ¨[150,250]ä¹‹é—´")
private int high;

@Size(min = 3,max = 5,message = "listçš„Sizeåœ¨[3,5]")
private List&lt;String&gt; list; } å¤åˆ¶ä»£ç  éªŒè¯modelï¼Œä»¥ä¸‹å…¨éƒ¨éªŒè¯é€šè¿‡ï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    @Autowired
    private Validator validator;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@RequestMapping("/demo3")
public void demo3(){
    Demo2 demo2 = new Demo2();
    demo2.setAge("111");
    demo2.setHigh(150);
    demo2.setLength("ABCDE");
    demo2.setList(new ArrayList&lt;String&gt;());
    Set&lt;ConstraintViolation&lt;Demo2&gt;&gt; violationSet = validator.validate(demo2);
    for (ConstraintViolation&lt;Demo2&gt; model : violationSet) {
        System.out.println(model.getMessage());
    }
} å¤åˆ¶ä»£ç  è¿”å›ç›®å½• 4ã€å¯¹è±¡çº§è”æ ¡éªŒ å¯¹è±¡å†…éƒ¨åŒ…å«å¦ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå±æ€§ï¼Œå±æ€§ä¸ŠåŠ @Validï¼Œå¯ä»¥éªŒè¯ä½œä¸ºå±æ€§çš„å¯¹è±¡å†…éƒ¨çš„éªŒè¯ï¼šï¼ˆéªŒè¯Demo2ç¤ºä¾‹æ—¶ï¼Œå¯ä»¥éªŒè¯Demo2çš„å­—æ®µï¼‰
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
@Data
public class Demo2 {
    @Size(min = 3,max = 5,message = â€œlistçš„Sizeåœ¨[3,5]â€)
    private List<String> list;</String></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@NotNull
@Valid
private Demo3 demo3; }
</code></pre></div></div>

<p>@Data
public class Demo3 {
    @Length(min = 5, max = 17, message = â€œlengthé•¿åº¦åœ¨[5,17]ä¹‹é—´â€)
    private String extField;
}
å¤åˆ¶ä»£ç 
çº§è”æ ¡éªŒï¼š
å¤åˆ¶ä»£ç 
    /<em>*å‰é¢é…ç½®äº†å¿«é€Ÿå¤±è´¥è¿”å›çš„Bean</em>/
    @Autowired
    private Validator validator;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@RequestMapping("/demo3")
public void demo3(){
    Demo2 demo2 = new Demo2();
    demo2.setList(new ArrayList&lt;String&gt;());

    Demo3 demo3 = new Demo3();
    demo3.setExtField("22");
    demo2.setDemo3(demo3);
    Set&lt;ConstraintViolation&lt;Demo2&gt;&gt; violationSet = validator.validate(demo2);
    for (ConstraintViolation&lt;Demo2&gt; model : violationSet) {
        System.out.println(model.getMessage());
    }
} å¤åˆ¶ä»£ç  å¯ä»¥æ ¡éªŒDemo3çš„extFieldå­—æ®µã€‚ è¿”å›ç›®å½• 5ã€åˆ†ç»„æ ¡éªŒ ç»“è®ºï¼šåˆ†ç»„é¡ºåºæ ¡éªŒæ—¶ï¼ŒæŒ‰æŒ‡å®šçš„åˆ†ç»„å…ˆåé¡ºåºè¿›è¡ŒéªŒè¯ï¼Œå‰é¢çš„éªŒè¯ä¸é€šè¿‡ï¼Œåé¢çš„åˆ†ç»„å°±ä¸è¡ŒéªŒè¯ã€‚
</code></pre></div></div>

<p>æœ‰è¿™æ ·ä¸€ç§åœºæ™¯ï¼Œæ–°å¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™ï¼Œä¸éœ€è¦éªŒè¯userIdï¼ˆå› ä¸ºç³»ç»Ÿç”Ÿæˆï¼‰ï¼›ä¿®æ”¹çš„æ—¶å€™éœ€è¦éªŒè¯userIdï¼Œè¿™æ—¶å€™å¯ç”¨ç”¨æˆ·åˆ°validatorçš„åˆ†ç»„éªŒè¯åŠŸèƒ½ã€‚</p>

<p>è®¾ç½®validatorä¸ºæ™®é€šéªŒè¯æ¨¡å¼ï¼ˆâ€hibernate.validator.fail_fastâ€, â€œfalseâ€ï¼‰ï¼Œç”¨åˆ°çš„éªŒè¯GroupAã€GroupBå’Œmodelï¼š</p>

<p>GroupAã€GroupBï¼š</p>

<p>public interface GroupA {
}</p>

<p>public interface GroupB {
}
éªŒè¯modelï¼šPerson</p>

<p>View Code
å¦‚ä¸ŠPersonæ‰€ç¤ºï¼Œ3ä¸ªåˆ†ç»„åˆ†åˆ«éªŒè¯å­—æ®µå¦‚ä¸‹ï¼š</p>

<p>GroupAéªŒè¯å­—æ®µuserIdï¼›
GroupBéªŒè¯å­—æ®µuserNameã€sexï¼›
DefaultéªŒè¯å­—æ®µage(Defaultæ˜¯Validatorè‡ªå¸¦çš„é»˜è®¤åˆ†ç»„)
è¿”å›ç›®å½•
aã€åˆ†ç»„</p>

<p>åªéªŒè¯GroupAã€GroupBæ ‡è®°çš„åˆ†ç»„ï¼š</p>

<p>å¤åˆ¶ä»£ç 
@RequestMapping(â€œ/demo5â€)
public void demo5(){
    Person p = new Person();
    /<em>*GroupAéªŒè¯ä¸é€šè¿‡</em>/
    p.setUserId(-12);
    /<em>*GroupAéªŒè¯é€šè¿‡</em>/
    //p.setUserId(12);
    p.setUserName(â€œaâ€);
    p.setAge(110);
    p.setSex(5);
    Set&lt;ConstraintViolation<Person>&gt; validate = validator.validate(p, GroupA.class, GroupB.class);
    for (ConstraintViolation<Person> item : validate) {
        System.out.println(item);
    }
}
å¤åˆ¶ä»£ç 
æˆ–</Person></Person></p>

<p>å¤åˆ¶ä»£ç 
    @RequestMapping(â€œ/demo6â€)
    public void demo6(@Validated({GroupA.class, GroupB.class}) Person p, BindingResult result){
        if(result.hasErrors()){
            List<ObjectError> allErrors = result.getAllErrors();
            for (ObjectError error : allErrors) {
                System.out.println(error);
            }
        }
    }
å¤åˆ¶ä»£ç 
GroupAã€GroupBã€Defaultéƒ½éªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</ObjectError></p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>ConstraintViolationImpl{interpolatedMessage=â€™å¿…é¡»åœ¨[4,20]â€™, propertyPath=userName, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™å¿…é¡»åœ¨[4,20]â€™}
ConstraintViolationImpl{interpolatedMessage=â€™å¿…é¡»å¤§äº0â€™, propertyPath=userId, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™å¿…é¡»å¤§äº0â€™}
ConstraintViolationImpl{interpolatedMessage=â€™æ€§åˆ«å¿…é¡»åœ¨[0,2]â€™, propertyPath=sex, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™æ€§åˆ«å¿…é¡»åœ¨[0,2]â€™}</p>

<p>GroupAéªŒè¯é€šè¿‡ã€GroupBã€DefaultéªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>ConstraintViolationImpl{interpolatedMessage=â€™å¿…é¡»åœ¨[4,20]â€™, propertyPath=userName, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™å¿…é¡»åœ¨[4,20]â€™}
ConstraintViolationImpl{interpolatedMessage=â€™æ€§åˆ«å¿…é¡»åœ¨[0,2]â€™, propertyPath=sex, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™æ€§åˆ«å¿…é¡»åœ¨[0,2]â€™}</p>

<p>è¿”å›ç›®å½•
bã€ç»„åºåˆ—</p>

<p>é™¤äº†æŒ‰ç»„æŒ‡å®šæ˜¯å¦éªŒè¯ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šç»„çš„éªŒè¯é¡ºåºï¼Œå‰é¢ç»„éªŒè¯ä¸é€šè¿‡çš„ï¼Œåé¢ç»„ä¸è¿›è¡ŒéªŒè¯ï¼š</p>

<p>æŒ‡å®šç»„çš„åºåˆ—ï¼ˆGroupAã€‹GroupBã€‹Defaultï¼‰ï¼š</p>

<p>@GroupSequence({GroupA.class, GroupB.class, Default.class})
public interface GroupOrder {
}
æµ‹è¯•demoï¼š</p>

<p>å¤åˆ¶ä»£ç 
    @RequestMapping(â€œ/demo7â€)
    public void demo7(){
        Person p = new Person();
        /<em>*GroupAéªŒè¯ä¸é€šè¿‡</em>/
        //p.setUserId(-12);
        /<em>*GroupAéªŒè¯é€šè¿‡</em>/
        p.setUserId(12);
        p.setUserName(â€œaâ€);
        p.setAge(110);
        p.setSex(5);
        Set&lt;ConstraintViolation<Person>&gt; validate = validator.validate(p, GroupOrder.class);
        for (ConstraintViolation<Person> item : validate) {
            System.out.println(item);
        }
    }
å¤åˆ¶ä»£ç 
æˆ–</Person></Person></p>

<p>å¤åˆ¶ä»£ç 
    @RequestMapping(â€œ/demo8â€)
    public void demo8(@Validated({GroupOrder.class}) Person p, BindingResult result){
        if(result.hasErrors()){
            List<ObjectError> allErrors = result.getAllErrors();
            for (ObjectError error : allErrors) {
                System.out.println(error);
            }
        }
    }
å¤åˆ¶ä»£ç 
GroupAã€GroupBã€Defaultéƒ½éªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</ObjectError></p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>ConstraintViolationImpl{interpolatedMessage=â€™å¿…é¡»å¤§äº0â€™, propertyPath=userId, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™å¿…é¡»å¤§äº0â€™}</p>

<p>GroupAéªŒè¯é€šè¿‡ã€GroupBã€DefaultéªŒè¯ä¸é€šè¿‡çš„æƒ…å†µï¼š</p>

<p>éªŒè¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p>ConstraintViolationImpl{interpolatedMessage=â€™å¿…é¡»åœ¨[4,20]â€™, propertyPath=userName, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™å¿…é¡»åœ¨[4,20]â€™}
ConstraintViolationImpl{interpolatedMessage=â€™æ€§åˆ«å¿…é¡»åœ¨[0,2]â€™, propertyPath=sex, rootBeanClass=class validator.demo.project.model.Person, messageTemplate=â€™æ€§åˆ«å¿…é¡»åœ¨[0,2]â€™}</p>

<p>ç»“è®ºï¼šåˆ†ç»„é¡ºåºæ ¡éªŒæ—¶ï¼ŒæŒ‰æŒ‡å®šçš„åˆ†ç»„å…ˆåé¡ºåºè¿›è¡ŒéªŒè¯ï¼Œå‰é¢çš„éªŒè¯ä¸é€šè¿‡ï¼Œåé¢çš„åˆ†ç»„å°±ä¸è¡ŒéªŒè¯ã€‚</p>

<p>è¿”å›ç›®å½•
äº”ã€è‡ªå®šä¹‰éªŒè¯å™¨
ä¸€èˆ¬æƒ…å†µï¼Œè‡ªå®šä¹‰éªŒè¯å¯ä»¥è§£å†³å¾ˆå¤šé—®é¢˜ã€‚ä½†ä¹Ÿæœ‰æ— æ³•æ»¡è¶³æƒ…å†µçš„æ—¶å€™ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°validatorçš„æ¥å£ï¼Œè‡ªå®šä¹‰è‡ªå·±éœ€è¦çš„éªŒè¯å™¨ã€‚</p>

<p>å¦‚ä¸‹æ‰€ç¤ºï¼Œå®ç°äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„å¤§å°å†™éªŒè¯å™¨ï¼š</p>

<p>å¤åˆ¶ä»£ç 
public enum CaseMode {
    UPPER,
    LOWER;
}</p>

<p>@Target( { ElementType.METHOD, ElementType.FIELD, ElementType.ANNOTATION_TYPE })
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = CheckCaseValidator.class)
@Documented
public @interface CheckCase {
    String message() default â€œâ€;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Class&lt;?&gt;[] groups() default {};

Class&lt;? extends Payload&gt;[] payload() default {};

CaseMode value(); }
</code></pre></div></div>

<p>public class CheckCaseValidator implements ConstraintValidator&lt;CheckCase, String&gt; {
    private CaseMode caseMode;
    public void initialize(CheckCase checkCase) {
        this.caseMode = checkCase.value();
    }</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean isValid(String s, ConstraintValidatorContext constraintValidatorContext) {
    if (s == null) {
        return true;
    }

    if (caseMode == CaseMode.UPPER) {
        return s.equals(s.toUpperCase());
    } else {
        return s.equals(s.toLowerCase());
    }
} } å¤åˆ¶ä»£ç  è¦éªŒè¯çš„Modelï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    public class Demo{
        @CheckCase(value = CaseMode.LOWER,message = â€œuserNameå¿…é¡»æ˜¯å°å†™â€)
        private String userName;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }
} å¤åˆ¶ä»£ç  validatoré…ç½®ï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    @Bean
    public Validator validator(){
        ValidatorFactory validatorFactory = Validation.byProvider( HibernateValidator.class )
                .configure()
                .addProperty( â€œhibernate.validator.fail_fastâ€, â€œtrueâ€ )
                .buildValidatorFactory();
        Validator validator = validatorFactory.getValidator();</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    return validator;
} å¤åˆ¶ä»£ç  éªŒè¯æµ‹è¯•ï¼š
</code></pre></div></div>

<p>å¤åˆ¶ä»£ç 
    @RequestMapping(â€œ/demo4â€)
    public void demo4(){
        Demo demo = new Demo();
        demo.setUserName(â€œuserNameâ€);
        Set&lt;ConstraintViolation<Demo>&gt; validate = validator.validate(demo);
        for (ConstraintViolation<Demo> dem : validate) {
            System.out.println(dem.getMessage());
        }
    }
å¤åˆ¶ä»£ç 
è¾“å‡ºç»“æœï¼š</Demo></Demo></p>

<p>userNameå¿…é¡»æ˜¯å°å†™</p>

<p>è¿”å›ç›®å½•
å…­ã€å¸¸è§çš„æ³¨è§£
  Bean Validation ä¸­å†…ç½®çš„ constraint   <br />
@Null   è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º null   <br />
@NotNull    è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ä¸º null   <br />
@AssertTrue     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º true   <br />
@AssertFalse    è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º false   <br />
@Min(value)     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼   <br />
@Max(value)     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼   <br />
@DecimalMin(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼   <br />
@DecimalMax(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼   <br />
@Size(max=, min=)   è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…   <br />
@Digits (integer, fraction)     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…   <br />
@Past   è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ   <br />
@Future     è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ   <br />
@Pattern(regex=,flag=)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼   <br />
Hibernate Validator é™„åŠ çš„ constraint   <br />
@NotBlank(message =)   éªŒè¯å­—ç¬¦ä¸²énullï¼Œä¸”é•¿åº¦å¿…é¡»å¤§äº0   <br />
@Email  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ç®±åœ°å€   <br />
@Length(min=,max=)  è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…   <br />
@NotEmpty   è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¿…é¡»éç©º   <br />
@Range(min=,max=,message=)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…</p>

<p>//å¤§äº0.01ï¼Œä¸åŒ…å«0.01
@NotNull
@DecimalMin(value = â€œ0.01â€, inclusive = false)
private Integer greaterThan;</p>

<p>//å¤§äºç­‰äº0.01
@NotNull
@DecimalMin(value = â€œ0.01â€, inclusive = true)
private BigDecimal greatOrEqualThan;</p>

<p>@Length(min = 1, max = 20, message = â€œmessageä¸èƒ½ä¸ºç©ºâ€)
//ä¸èƒ½å°†Lengthé”™ç”¨æˆRange
//@Range(min = 1, max = 20, message = â€œmessageä¸èƒ½ä¸ºç©ºâ€)
private String message;</p>
:ET