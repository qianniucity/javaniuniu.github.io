I"$<h2 id="题目-按摩师">题目 <a href="https://leetcode-cn.com/problems/the-masseuse-lcci/">按摩师</a></h2>
<p>一个有名的按摩师会收到源源不断的预约请求，每个预约都可以选择接或不接。在每次预约服务之间要有休息时间，因此她不能接受相邻的预约。给定一个预约请求序列，替按摩师找到最优的预约集合（总预约时间最长），返回总的分钟数。</p>

<h2 id="示例">示例</h2>
<h3 id="示例-1">示例 1：</h3>

<p>输入： [1,2,3,1] <br />
输出： 4 <br />
解释： 选择 1 号预约和 3 号预约，总时长 = 1 + 3 = 4。</p>
<h3 id="示例-2">示例 2：</h3>

<p>输入： [2,7,9,3,1] <br />
输出： 12  <br />
解释： 选择 1 号预约、 3 号预约和 5 号预约，总时长 = 2 + 9 + 1 = 12。</p>
<h3 id="示例-3">示例 3：</h3>

<p>输入： [2,1,4,5,3,1,1,3] <br />
输出： 12  <br />
解释： 选择 1 号预约、 3 号预约、 5 号预约和 8 号预约，总时长 = 2 + 4 + 3 + 3 = 12。</p>

<h2 id="自己的思路">自己的思路</h2>

<h2 id="自己的代码">自己的代码</h2>

<h3 id="用时">用时</h3>

<h2 id="官方解题思路">官方解题思路</h2>
<h3 id="方法一设计二维状态变量">方法一：设计二维状态变量</h3>
<h4 id="第-1-步设计状态">第 1 步：设计状态</h4>
<p>「状态」这个词可以理解为「记录了求解问题到了哪一个阶段」。</p>

<p>由于当前这一天有按摩师有两种选择：（1）接预约；（2）不接预约。但根据题意，今天是否接预约，是受到昨天影响的。为了消除这种影响，我们在状态数组要设置这个维度。</p>

<ul>
  <li><em>dp[i][0]</em> 表示：区间 [0，i] 里接受预约请求，并且下标为 i 的这一天不接受预约的最大时长；</li>
  <li><em>dp[i][1]</em> 表示：区间 [0，i] 里接受预约请求，并且下标为 i 的这一天接受预约的最大时长。</li>
</ul>

<p>说明：这个定义是 <em>有前缀性质的，即当前的状态值考虑了（或者说综合了）之前的相关的状态值，第 2 维保存了当前最优值的决策，这种通过增加维度，消除后效性的操作在「动态规划」问题里是非常常见的。</em></p>

<p>无后效性的理解：1、后面的决策不会影响到前面的决策； 2、之前的状态怎么来的并不重要。</p>

<p>一般的情况是，只要有约束，就可以增加一个维度消除这种约束带来的影响，再具体一点说，就是把「状态」定义得清楚、准确，「状态转移方程」就容易得到了。「力扣」的几道股票问题基本都是这个思路，而且设置状态的思想和这道题是完全一致的。</p>

<h4 id="第-2-步状态转移方程">第 2 步：状态转移方程</h4>
<p>「状态转移方程」可以理解为「不同阶段之间的联系」。</p>

<ul>
  <li>
    <p>今天只和昨天的状态相关，依然是分类讨论：</p>
  </li>
  <li>
    <p>今天不接受预约：或者是昨天不接受预约，或者是昨天接受了预约，取二者最大值，即：<em>dp[i][0] = max(dp[i - 1][0], dp[i - 1][1])</em>；
今天接受预约：只需要从昨天不接受预约转移而来，加上今天的时常，即：<em>dp[i][1] = dp[i - 1][0] + nums[i]</em>。</p>
    <h4 id="第-3-步考虑初始化">第 3 步：考虑初始化</h4>
    <p>从第 2 天开始，每天的状态值只与前一天有关，因此第 1 天就只好老老实实算了。好在不难判断：<em>dp[0][0] = 0 与 dp[0][1] = nums[0]</em>；</p>
  </li>
</ul>

<p>这里有一种技巧，可以把状态数组多设置一行，这样可以减少对第 1 天的初始化，这样的代码把第 1 天的情况考虑了进去，但编码的时候要注意状态数组下标的设置， 请见题解最后的「参考代码 3」。</p>

<h4 id="第-4-步考虑输出">第 4 步：考虑输出</h4>
<p>由于状态值的定义是前缀性质的，因此最后一天的状态值就考虑了之前所有的天数的情况。按摩师最后一天可以接受预约，也可以不接受预约，取二者最大值。</p>

<h4 id="第-5-步考虑是否可以状态压缩">第 5 步：考虑是否可以状态压缩</h4>
<p>由于今天只参考昨天的值，状态可以压缩，可以使用「滚动数组」完成，状态压缩的代码丢失了一定可读性，也会给编码增加一点点难度，请见题解后的「参考代码 4」。</p>

<h2 id="官方代码">官方代码</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">massage</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">nums</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">nums</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">nums</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="o">}</span>

        <span class="c1">// dp[i][0]：区间 [0, i] 里接受预约请求，并且下标为 i 的这一天不接受预约的最大时长</span>
        <span class="c1">// dp[i][1]：区间 [0, i] 里接受预约请求，并且下标为 i 的这一天接受预约的最大时长</span>
        <span class="kt">int</span><span class="o">[][]</span> <span class="n">dp</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">len</span><span class="o">][</span><span class="mi">2</span><span class="o">];</span>
        <span class="n">dp</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">dp</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">nums</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">dp</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">dp</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="mi">0</span><span class="o">],</span> <span class="n">dp</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="mi">1</span><span class="o">]);</span>
            <span class="n">dp</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">dp</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="n">nums</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">dp</span><span class="o">[</span><span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="mi">0</span><span class="o">],</span> <span class="n">dp</span><span class="o">[</span><span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="o">][</span><span class="mi">1</span><span class="o">]);</span>
    <span class="o">}</span>


<span class="o">}</span>
</code></pre></div></div>

<h2 id="复杂度分析">复杂度分析</h2>
<p>-</p>
:ET