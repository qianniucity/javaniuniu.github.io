I"–<p>åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œä½¿ç”¨@Autowiredæ³¨è§£æ˜¯ï¼Œå‘ç°IDEæŠ¥çš„ä¸€ä¸ªè­¦å‘Šï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="language-txt">Spring Team recommends "Always use constructor based dependency injection in your beans. Always use assertions for mandatory dependencies".
</code></pre>
<p>ç¿»è¯‘ï¼šSpringå»ºè®®â€æ€»æ˜¯åœ¨æ‚¨çš„beanä¸­ä½¿ç”¨æ„é€ å‡½æ•°å»ºç«‹ä¾èµ–æ³¨å…¥ã€‚æ€»æ˜¯ä½¿ç”¨æ–­è¨€å¼ºåˆ¶ä¾èµ–â€ã€‚</p>

<p>è¿™æ®µä»£ç è­¦å‘ŠåŸæ¥çš„å†™æ³•æ˜¯ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">EnterpriseDbService</span> <span class="n">service</span><span class="o">;</span>
</code></pre></div></div>

<p>å»ºè®®åå†™æˆä¸‹é¢çš„æ ·å­ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">final</span> <span class="nc">EnterpriseDbService</span> <span class="n">service</span><span class="o">;</span>

<span class="nd">@Autowired</span>
<span class="kd">public</span> <span class="nf">EnterpriseDbController</span><span class="o">(</span><span class="nc">EnterpriseDbService</span> <span class="n">service</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">this</span><span class="o">.</span><span class="na">service</span> <span class="o">=</span> <span class="n">service</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å¥‡æ€ªï¼Œä¸ºä½•ä¼šæœ‰è¿™æ ·çš„å»ºè®®ã€‚?
æˆ‘ä»¬çŸ¥é“ï¼š@Autowired å¯ä»¥å¯¹æˆå‘˜å˜é‡ã€æ–¹æ³•ä»¥åŠæ„é€ å‡½æ•°è¿›è¡Œæ³¨é‡Šã€‚é‚£ä¹ˆå¯¹æˆå‘˜å˜é‡å’Œæ„é€ å‡½æ•°è¿›è¡Œæ³¨é‡Šåˆæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>

<p>@Autowiredæ³¨å…¥beanï¼Œç›¸å½“äºåœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®beanï¼Œå¹¶ä¸”ä½¿ç”¨setteræ³¨å…¥ã€‚è€Œå¯¹æ„é€ å‡½æ•°è¿›è¡Œæ³¨é‡Šï¼Œå°±ç›¸å½“äºæ˜¯ä½¿ç”¨æ„é€ å‡½æ•°è¿›è¡Œä¾èµ–æ³¨å…¥äº†å§ã€‚è«éæ˜¯è¿™ä¸¤ç§æ³¨å…¥æ–¹æ³•çš„ä¸åŒã€‚</p>

<p>ä»¥ä¸‹æ˜¯ï¼š@Autowiredå’Œæ„é€ æ–¹æ³•æ‰§è¡Œçš„é¡ºåºè§£æ</p>

<p>å…ˆçœ‹ä¸€æ®µä»£ç ï¼Œä¸‹é¢çš„ä»£ç èƒ½è¿è¡ŒæˆåŠŸå—ï¼Ÿ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
<span class="kd">private</span> <span class="nc">String</span> <span class="n">school</span><span class="o">;</span>

<span class="kd">public</span> <span class="nf">UserAccountServiceImpl</span><span class="o">(){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">school</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="na">getSchool</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ç­”æ¡ˆæ˜¯ä¸èƒ½ã€‚</p>

<p>å› ä¸ºJavaç±»ä¼šå…ˆæ‰§è¡Œæ„é€ æ–¹æ³•ï¼Œç„¶åå†ç»™æ³¨è§£äº†@Autowired çš„useræ³¨å…¥å€¼ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œæ„é€ æ–¹æ³•çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>

<p>æŠ¥é”™ä¿¡æ¯å¯èƒ½ä¼šåƒä¸‹é¢ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">ã€€ã€€</span><span class="nc">Exception</span> <span class="n">in</span> <span class="n">thread</span> <span class="s">"main"</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">beans</span><span class="o">.</span><span class="na">factory</span><span class="o">.</span><span class="na">BeanCreationException</span><span class="o">:</span> <span class="nc">Error</span> <span class="n">creating</span> <span class="n">bean</span> <span class="n">with</span> <span class="n">name</span> <span class="err">'</span><span class="o">...</span><span class="err">'</span> <span class="n">defined</span> <span class="n">in</span> <span class="n">file</span> <span class="o">[....</span><span class="na">class</span><span class="o">]:</span> <span class="nc">Instantiation</span> <span class="n">of</span> <span class="n">bean</span> <span class="n">failed</span><span class="o">;</span> <span class="n">nested</span> <span class="n">exception</span> <span class="n">is</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">beans</span><span class="o">.</span><span class="na">BeanInstantiationException</span><span class="o">:</span> <span class="nc">Failed</span> <span class="n">to</span> <span class="n">instantiate</span> <span class="o">[...]:</span> <span class="nc">Constructor</span> <span class="n">threw</span> <span class="n">exception</span><span class="o">;</span> <span class="n">nested</span> <span class="n">exception</span> <span class="n">is</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">NullPointerException</span>
</code></pre></div></div>
<p>æŠ¥é”™ä¿¡æ¯è¯´ï¼šåˆ›å»ºBeanæ—¶å‡ºé”™ï¼Œå‡ºé”™åŸå› æ˜¯å®ä¾‹åŒ–beanå¤±è´¥ï¼Œå› ä¸ºbeanæ—¶æ„é€ æ–¹æ³•å‡ºé”™ï¼Œåœ¨æ„é€ æ–¹æ³•é‡ŒæŠ›å‡ºäº†ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>

<p>è§£å†³åŠæ³•æ˜¯ï¼Œä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œå¦‚ä¸‹ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
<span class="kd">private</span> <span class="nc">String</span> <span class="n">school</span><span class="o">;</span>

<span class="nd">@Autowired</span>
<span class="kd">public</span> <span class="nf">UserAccountServiceImpl</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">user</span> <span class="o">=</span> <span class="n">user</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">school</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="na">getSchool</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å¯ä»¥çœ‹å‡ºï¼Œ<strong>ä½¿ç”¨æ„é€ å™¨æ³¨å…¥çš„æ–¹æ³•ï¼Œå¯ä»¥æ˜ç¡®æˆå‘˜å˜é‡çš„åŠ è½½é¡ºåºã€‚</strong></p>

<p>PSï¼šJavaå˜é‡çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼šé™æ€å˜é‡æˆ–é™æ€è¯­å¥å—â€“&gt;å®ä¾‹å˜é‡æˆ–åˆå§‹åŒ–è¯­å¥å—â€“&gt;æ„é€ æ–¹æ³•â€“&gt;@Autowired</p>

<h5 id="é‚£ä¹ˆæœ€å¼€å§‹springå»ºè®®ä¸ºä½•è¦å°†æˆå‘˜å˜é‡åŠ ä¸Šfinalç±»å‹å‘¢">é‚£ä¹ˆæœ€å¼€å§‹Springå»ºè®®ï¼Œä¸ºä½•è¦å°†æˆå‘˜å˜é‡åŠ ä¸Šfinalç±»å‹å‘¢ï¼Ÿ</h5>

<p>ç½‘ä¸Šæœ‰è§£é‡Šå¦‚ä¸‹ï¼šspringé…ç½®é»˜è®¤çš„beançš„scopeæ˜¯singletonï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨åä¸€ç›´æœ‰ã€‚é€šè¿‡è®¾ç½®beançš„scopeå±æ€§ä¸ºprototypeæ¥å£°æ˜è¯¥å¯¹è±¡ä¸ºåŠ¨æ€åˆ›å»ºã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ çš„serviceæœ¬èº«æ˜¯singletonï¼Œæ³¨å…¥åªæ‰§è¡Œä¸€æ¬¡ã€‚</p>

<p>@Autowiredæœ¬èº«å°±æ˜¯å•ä¾‹æ¨¡å¼ï¼Œåªä¼šåœ¨ç¨‹åºå¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå³ä½¿ä¸å®šä¹‰finalä¹Ÿä¸ä¼šåˆå§‹åŒ–ç¬¬äºŒæ¬¡ï¼Œæ‰€ä»¥è¿™ä¸ªfinalæ˜¯æ²¡æœ‰æ„ä¹‰çš„å§ã€‚</p>

<p>å¯èƒ½æ˜¯ä¸ºäº†é˜²æ­¢ï¼Œåœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œåˆæ‰§è¡Œäº†ä¸€éæ„é€ å‡½æ•°ï¼›</p>

<p>æˆ–è€…æ˜¯æ›´å®¹æ˜“è®©äººç†è§£çš„æ„æ€ï¼ŒåŠ ä¸Šfinalåªä¼šåœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™åˆå§‹åŒ–ä¸€æ¬¡ï¼Œå¹¶ä¸”åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ä¸ä¼šå†æ”¹å˜ã€‚</p>
:ET