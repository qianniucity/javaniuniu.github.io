I"º,<p>é¦–å…ˆè´´ä¸Šä»£ç </p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginVO</span> <span class="o">{</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@IsMobile</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">mobile</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Length</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">32</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IsMobileValidator</span> <span class="kd">implements</span> <span class="nc">ConstraintValidator</span><span class="o">&lt;</span><span class="nc">IsMobile</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">require</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">IsMobile</span> <span class="n">constraintAnnotation</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">require</span> <span class="o">=</span> <span class="n">constraintAnnotation</span><span class="o">.</span><span class="na">required</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span><span class="o">,</span> <span class="nc">ConstraintValidatorContext</span> <span class="n">constraintValidatorContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">require</span><span class="o">){</span>
            <span class="k">return</span> <span class="nc">ValidatorUtils</span><span class="o">.</span><span class="na">isMobile</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span><span class="k">else</span> <span class="o">{</span>
           <span class="k">if</span> <span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">s</span><span class="o">))</span> <span class="o">{</span>
               <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
           <span class="o">}</span><span class="k">else</span> <span class="o">{</span>
               <span class="k">return</span> <span class="nc">ValidatorUtils</span><span class="o">.</span><span class="na">isMobile</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
           <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span>
        <span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{</span><span class="nc">IsMobileValidator</span><span class="o">.</span><span class="na">class</span><span class="o">}</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">IsMobile</span> <span class="o">{</span>

    <span class="kt">boolean</span> <span class="nf">required</span><span class="o">()</span> <span class="k">default</span> <span class="kc">true</span><span class="o">;</span>

    <span class="nc">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">"æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®"</span><span class="o">;</span>

    <span class="nc">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>


<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ValidatorUtils</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Pattern</span> <span class="n">mobile_pattern</span> <span class="o">=</span> <span class="nc">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"1\\d{10}"</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isMobile</span><span class="o">(</span><span class="nc">String</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">src</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nc">Matcher</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mobile_pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">src</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="na">matches</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="mi">1</span><span class="o">.</span> <span class="n">LoginVO</span><span class="err">ç±»ä¸ºä¸€ä¸ªæ™®é€šçš„å®ä½“ç±»ï¼Œå…¶ä¸­çš„</span><span class="n">mobile</span><span class="err">å±æ€§æ·»åŠ äº†è‡ªå®šä¹‰æ³¨è§£ã€‚</span>
<span class="mi">2</span><span class="o">.</span> <span class="n">IsMobile</span><span class="err">ç±»ä¸ºè‡ªå®šä¹‰çš„å­—æ®µæ³¨è§£ï¼Œæœªäº†è§£è¿‡æ³¨è§£çš„åŒå­¦è¯·è‡ªè¡Œç™¾åº¦ï¼Œåœ¨æ­¤ä¸åšåŸºç¡€ä»‹ç»ã€‚è¯¥è‡ªå®šä¹‰æ³¨è§£ç±»ä¸­ç”¨åˆ°äº†å››ç§å…ƒæ³¨è§£ï¼Œæœ€åä¸€ä¸ª</span><span class="nd">@Constraint</span><span class="err">æŒ‡å®šäº†æ ¡éªŒç±»ï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥çš„</span><span class="n">IsMobileValidator</span><span class="err">ç±»ã€‚å€¼å¾—ä¸€æçš„æ˜¯é™¤äº†è‡ªå®šä¹‰çš„</span><span class="n">message</span><span class="err">ã€</span><span class="n">require</span><span class="err">å±æ€§å¤–ï¼Œä¸‹é¢çš„</span><span class="n">groups</span><span class="err">å’Œ</span><span class="n">payload</span><span class="err">ä¹Ÿæ˜¯å¿…é¡»æ·»åŠ çš„ã€‚</span>
<span class="mi">3</span><span class="o">.</span> <span class="n">ValidatorUtils</span><span class="err">ä¸ºä¸€ä¸ªå·¥å…·ç±»ï¼Œç®€å•æ ¡éªŒäº†æ˜¯å¦ä¸ºæ‰‹æœºå·ï¼Œæ²¡æœ‰äº†è§£è¿‡çš„å¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„ä¸€ç¯‡åšæ–‡ï¼š</span><span class="nl">https:</span><span class="c1">//blog.csdn.net/qq_38439885/article/details/80230753</span>
<span class="mi">4</span><span class="o">.</span> <span class="n">IsMobileValidator</span><span class="err">ä¸ºè‡ªå®šä¹‰æ³¨è§£çš„æ ¡éªŒç±»ã€‚</span>
<span class="err">æ ¡éªŒç±»éœ€è¦å®ç°</span><span class="n">ConstraintValidator</span><span class="err">æ¥å£ã€‚</span>
<span class="err">æ¥å£ä½¿ç”¨äº†æ³›å‹ï¼Œéœ€è¦æŒ‡å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ç±»ï¼Œç¬¬äºŒä¸ªä¸ºéœ€è¦æ ¡éªŒçš„æ•°æ®ç±»å‹ã€‚</span>
<span class="err">å®ç°æ¥å£åè¦</span><span class="n">override</span><span class="err">ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä¸º</span><span class="n">initialize</span><span class="err">æ–¹æ³•å’Œ</span><span class="n">isValid</span><span class="err">æ–¹æ³•ã€‚å…¶ä¸­</span><span class="n">initialize</span><span class="err">ä¸ºåˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥åœ¨é‡Œé¢åšä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œ</span><span class="n">isValid</span><span class="err">æ–¹æ³•å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆéœ€è¦çš„æ ¡éªŒæ–¹æ³•äº†ã€‚å¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­å®ç°å…·ä½“çš„æ ¡éªŒæ­¥éª¤ã€‚æœ¬ç¤ºä¾‹ä¸­è¿›è¡Œäº†ç®€å•çš„æ‰‹æœºå·æ ¡éªŒã€‚</span>

<span class="err">å®Œæˆè¿™å‡ éƒ¨åˆ†ä¹‹åï¼Œä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£å°±å®Œæˆå•¦ï¼Œä¸è¦å¿˜è®°åœ¨ä½¿ç”¨çš„æ—¶å€™åŠ ä¸Š</span><span class="nd">@Valid</span><span class="err">æ³¨è§£å¼€å¯</span><span class="n">valid</span><span class="err">æ ¡éªŒã€‚</span>

<span class="err">é‚£ä¹ˆå¦‚ä½•è·å–åœ¨æ³¨è§£ä¸­å®šä¹‰çš„</span><span class="n">message</span><span class="err">ä¿¡æ¯å‘¢ï¼Ÿ</span>

<span class="err">åœ¨</span><span class="n">valid</span><span class="err">æ ¡éªŒä¸­ï¼Œå¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œä¼šäº§ç”Ÿ</span><span class="n">BindException</span><span class="err">å¼‚å¸¸ï¼Œæ•æ‰åˆ°å¼‚å¸¸åå¯ä»¥è·å–åˆ°</span><span class="n">defaultMessage</span><span class="err">ä¹Ÿå°±æ˜¯è‡ªå®šä¹‰æ³¨è§£ä¸­å®šä¹‰çš„å†…å®¹ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š</span>
<span class="err">```</span><span class="n">java</span>
    <span class="nc">BindException</span> <span class="n">ex</span> <span class="o">=</span> <span class="o">(</span><span class="nc">BindException</span><span class="o">)</span><span class="n">e</span><span class="o">;</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ObjectError</span><span class="o">&gt;</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">();</span>
    <span class="nc">ObjectError</span> <span class="n">error</span> <span class="o">=</span> <span class="n">errors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="nc">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="na">getDefaultMessage</span><span class="o">();</span>
</code></pre></div></div>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œhhswayã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_38439885/article/details/81227063</p>
:ET