I"h…<h4 id="ä¸€æ³¨è§£annotationsåˆ—è¡¨">ä¸€ã€æ³¨è§£(annotations)åˆ—è¡¨</h4>

<p>@SpringBootApplicationï¼šåŒ…å«äº†@ComponentScanã€@Configurationå’Œ@EnableAutoConfigurationæ³¨è§£ã€‚å…¶ä¸­@ComponentScanè®©spring Bootæ‰«æåˆ°Configurationç±»å¹¶æŠŠå®ƒåŠ å…¥åˆ°ç¨‹åºä¸Šä¸‹æ–‡ã€‚</p>

<p>@Configuration ç­‰åŒäºspringçš„XMLé…ç½®æ–‡ä»¶ï¼›ä½¿ç”¨Javaä»£ç å¯ä»¥æ£€æŸ¥ç±»å‹å®‰å…¨ã€‚</p>

<p>@EnableAutoConfiguration è‡ªåŠ¨é…ç½®ã€‚</p>

<p>@ComponentScan ç»„ä»¶æ‰«æï¼Œå¯è‡ªåŠ¨å‘ç°å’Œè£…é…ä¸€äº›Beanã€‚</p>

<p>@Componentå¯é…åˆCommandLineRunnerä½¿ç”¨ï¼Œåœ¨ç¨‹åºå¯åŠ¨åæ‰§è¡Œä¸€äº›åŸºç¡€ä»»åŠ¡ã€‚</p>

<p>@RestControlleræ³¨è§£æ˜¯@Controllerå’Œ@ResponseBodyçš„åˆé›†,è¡¨ç¤ºè¿™æ˜¯ä¸ªæ§åˆ¶å™¨bean,å¹¶ä¸”æ˜¯å°†å‡½æ•°çš„è¿”å›å€¼ç›´ æ¥å¡«å…¥HTTPå“åº”ä½“ä¸­,æ˜¯RESTé£æ ¼çš„æ§åˆ¶å™¨ã€‚</p>

<p>@Autowiredè‡ªåŠ¨å¯¼å…¥ã€‚</p>

<p>@PathVariableè·å–å‚æ•°ã€‚</p>

<p>@JsonBackReferenceè§£å†³åµŒå¥—å¤–é“¾é—®é¢˜ã€‚</p>

<p>@RepositoryRestResourcepublicé…åˆspring-boot-starter-data-restä½¿ç”¨ã€‚</p>

<h4 id="äºŒæ³¨è§£annotationsè¯¦è§£">äºŒã€æ³¨è§£(annotations)è¯¦è§£</h4>

<p>@SpringBootApplicationï¼šç”³æ˜è®©spring bootè‡ªåŠ¨ç»™ç¨‹åºè¿›è¡Œå¿…è¦çš„é…ç½®ï¼Œè¿™ä¸ªé…ç½®ç­‰åŒäºï¼š@Configuration ï¼Œ@EnableAutoConfiguration å’Œ @ComponentScan ä¸‰ä¸ªé…ç½®ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">myproject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span> <span class="c1">// same as @Configuration @EnableAutoConfiguration @ComponentScan</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
     <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>@ResponseBodyï¼šè¡¨ç¤ºè¯¥æ–¹æ³•çš„è¿”å›ç»“æœç›´æ¥å†™å…¥HTTP response bodyä¸­ï¼Œä¸€èˆ¬åœ¨å¼‚æ­¥è·å–æ•°æ®æ—¶ä½¿ç”¨ï¼Œç”¨äºæ„å»ºRESTfulçš„apiã€‚åœ¨ä½¿ç”¨@RequestMappingåï¼Œè¿”å›å€¼é€šå¸¸è§£æä¸ºè·³è½¬è·¯å¾„ï¼ŒåŠ ä¸Š@esponsebodyåè¿”å›ç»“æœä¸ä¼šè¢«è§£æä¸ºè·³è½¬è·¯å¾„ï¼Œè€Œæ˜¯ç›´æ¥å†™å…¥HTTP response bodyä¸­ã€‚æ¯”å¦‚å¼‚æ­¥è·å–jsonæ•°æ®ï¼ŒåŠ ä¸Š@Responsebodyåï¼Œä¼šç›´æ¥è¿”å›jsonæ•°æ®ã€‚è¯¥æ³¨è§£ä¸€èˆ¬ä¼šé…åˆ@RequestMappingä¸€èµ·ä½¿ç”¨ã€‚ç¤ºä¾‹ä»£ç ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMapping</span><span class="o">(</span><span class="err">â€œ</span><span class="o">/</span><span class="n">test</span><span class="err">â€</span><span class="o">)</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">test</span><span class="o">(){</span>
  <span class="k">return</span><span class="err">â€</span><span class="n">ok</span><span class="err">â€</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>@Controllerï¼šç”¨äºå®šä¹‰æ§åˆ¶å™¨ç±»ï¼Œåœ¨springé¡¹ç›®ä¸­ç”±æ§åˆ¶å™¨è´Ÿè´£å°†ç”¨æˆ·å‘æ¥çš„URLè¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„æœåŠ¡æ¥å£ï¼ˆserviceå±‚ï¼‰ï¼Œä¸€èˆ¬è¿™ä¸ªæ³¨è§£åœ¨ç±»ä¸­ï¼Œé€šå¸¸æ–¹æ³•éœ€è¦é…åˆæ³¨è§£@RequestMappingã€‚ç¤ºä¾‹ä»£ç ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="err">â€œ</span><span class="o">/</span><span class="n">demoInfo</span><span class="err">â€</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DemoController</span> <span class="o">{</span>
<span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">DemoInfoService</span> <span class="n">demoInfoService</span><span class="o">;</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/hello"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">hello</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">){</span>
   <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"DemoController.hello()"</span><span class="o">);</span>
   <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"hello"</span><span class="o">,</span><span class="s">"from TemplateController.helloHtml"</span><span class="o">);</span>
   <span class="c1">//ä¼šä½¿ç”¨hello.htmlæˆ–è€…hello.ftlæ¨¡æ¿è¿›è¡Œæ¸²æŸ“æ˜¾ç¤º.</span>
   <span class="k">return</span><span class="s">"/hello"</span><span class="o">;</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>@RestControllerï¼šç”¨äºæ ‡æ³¨æ§åˆ¶å±‚ç»„ä»¶(å¦‚strutsä¸­çš„action)ï¼Œ@ResponseBodyå’Œ@Controllerçš„åˆé›†ã€‚ç¤ºä¾‹ä»£ç ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">kfit</span><span class="o">.</span><span class="na">demo</span><span class="o">.</span><span class="na">web</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>


<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="err">â€œ</span><span class="o">/</span><span class="n">demoInfo2</span><span class="err">â€</span><span class="o">)</span>
<span class="n">publicclass</span> <span class="nc">DemoController2</span> <span class="o">{</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/test"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">test</span><span class="o">(){</span>
   <span class="k">return</span> <span class="s">"ok"</span><span class="o">;</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>@RequestMappingï¼šæä¾›è·¯ç”±ä¿¡æ¯ï¼Œè´Ÿè´£URLåˆ°Controllerä¸­çš„å…·ä½“å‡½æ•°çš„æ˜ å°„ã€‚</p>

<p>@EnableAutoConfigurationï¼šSpringBootè‡ªåŠ¨é…ç½®ï¼ˆauto-configurationï¼‰ï¼šå°è¯•æ ¹æ®ä½ æ·»åŠ çš„jarä¾èµ–è‡ªåŠ¨é…ç½®ä½ çš„Springåº”ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„classpathä¸‹å­˜åœ¨HSQLDBï¼Œå¹¶ä¸”ä½ æ²¡æœ‰æ‰‹åŠ¨é…ç½®ä»»ä½•æ•°æ®åº“è¿æ¥beansï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†è‡ªåŠ¨é…ç½®ä¸€ä¸ªå†…å­˜å‹ï¼ˆin-memoryï¼‰æ•°æ®åº“â€ã€‚ä½ å¯ä»¥å°†@EnableAutoConfigurationæˆ–è€…@SpringBootApplicationæ³¨è§£æ·»åŠ åˆ°ä¸€ä¸ª@Configurationç±»ä¸Šæ¥é€‰æ‹©è‡ªåŠ¨é…ç½®ã€‚å¦‚æœå‘ç°åº”ç”¨äº†ä½ ä¸æƒ³è¦çš„ç‰¹å®šè‡ªåŠ¨é…ç½®ç±»ï¼Œä½ å¯ä»¥ä½¿ç”¨@EnableAutoConfigurationæ³¨è§£çš„æ’é™¤å±æ€§æ¥ç¦ç”¨å®ƒä»¬ã€‚</p>

<p>@ComponentScanï¼šå…¶å®å¾ˆç®€å•ï¼Œ@ComponentScanä¸»è¦å°±æ˜¯å®šä¹‰æ‰«æçš„è·¯å¾„ä»ä¸­æ‰¾å‡ºæ ‡è¯†äº†éœ€è¦è£…é…çš„ç±»è‡ªåŠ¨è£…é…åˆ°springçš„beanå®¹å™¨ä¸­,ä½ ä¸€å®šéƒ½æœ‰ç”¨è¿‡@Controllerï¼Œ@Serviceï¼Œ@Repositoryæ³¨è§£ï¼ŒæŸ¥çœ‹å…¶æºç ä½ ä¼šå‘ç°ï¼Œä»–ä»¬ä¸­æœ‰ä¸€ä¸ªå…±åŒçš„æ³¨è§£@Componentï¼Œæ²¡é”™@ComponentScanæ³¨è§£é»˜è®¤å°±ä¼šè£…é…æ ‡è¯†äº†@Controllerï¼Œ@Serviceï¼Œ@Repositoryï¼Œ@Componentæ³¨è§£çš„ç±»åˆ°springå®¹å™¨ä¸­ã€‚å½“ç„¶ï¼Œè¿™ä¸ªçš„å‰æå°±æ˜¯ä½ éœ€è¦åœ¨æ‰€æ‰«æåŒ…ä¸‹çš„ç±»ä¸Šå¼•å…¥æ³¨è§£ã€‚</p>

<p>@Configurationï¼šç›¸å½“äºä¼ ç»Ÿçš„xmlé…ç½®æ–‡ä»¶ï¼Œå¦‚æœæœ‰äº›ç¬¬ä¸‰æ–¹åº“éœ€è¦ç”¨åˆ°xmlæ–‡ä»¶ï¼Œå»ºè®®ä»ç„¶é€šè¿‡@Configurationç±»ä½œä¸ºé¡¹ç›®çš„é…ç½®ä¸»ç±»â€”â€”å¯ä»¥ä½¿ç”¨@ImportResourceæ³¨è§£åŠ è½½xmlé…ç½®æ–‡ä»¶ã€‚</p>

<p>@Importï¼šç”¨æ¥å¯¼å…¥å…¶ä»–é…ç½®ç±»ã€‚</p>

<p>@ImportResourceï¼šç”¨æ¥åŠ è½½xmlé…ç½®æ–‡ä»¶ã€‚</p>

<p>@Autowiredï¼šè‡ªåŠ¨å¯¼å…¥ä¾èµ–çš„bean</p>

<p>@Serviceï¼šä¸€èˆ¬ç”¨äºä¿®é¥°serviceå±‚çš„ç»„ä»¶</p>

<p>@Repositoryï¼šä½¿ç”¨@Repositoryæ³¨è§£å¯ä»¥ç¡®ä¿DAOæˆ–è€…repositoriesæä¾›å¼‚å¸¸è½¬è¯‘ï¼Œè¿™ä¸ªæ³¨è§£ä¿®é¥°çš„DAOæˆ–è€…repositoriesç±»ä¼šè¢«ComponetScanå‘ç°å¹¶é…ç½®ï¼ŒåŒæ—¶ä¹Ÿä¸éœ€è¦ä¸ºå®ƒä»¬æä¾›XMLé…ç½®é¡¹ã€‚</p>

<p>@Beanï¼šç”¨@Beanæ ‡æ³¨æ–¹æ³•ç­‰ä»·äºXMLä¸­é…ç½®çš„beanã€‚</p>

<p>@Valueï¼šæ³¨å…¥Spring boot application.propertiesé…ç½®çš„å±æ€§çš„å€¼ã€‚ç¤ºä¾‹ä»£ç ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Value</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="err">â€œ#</span><span class="o">{</span><span class="n">message</span><span class="o">}</span><span class="err">â€</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
</code></pre></div></div>
<p>@Injectï¼šç­‰ä»·äºé»˜è®¤çš„@Autowiredï¼Œåªæ˜¯æ²¡æœ‰requiredå±æ€§ï¼›</p>

<p>@Componentï¼šæ³›æŒ‡ç»„ä»¶ï¼Œå½“ç»„ä»¶ä¸å¥½å½’ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ³¨è§£è¿›è¡Œæ ‡æ³¨ã€‚</p>

<p>@Bean:ç›¸å½“äºXMLä¸­çš„,æ”¾åœ¨æ–¹æ³•çš„ä¸Šé¢ï¼Œè€Œä¸æ˜¯ç±»ï¼Œæ„æ€æ˜¯äº§ç”Ÿä¸€ä¸ªbean,å¹¶äº¤ç»™springç®¡ç†ã€‚</p>

<p>@AutoWiredï¼šè‡ªåŠ¨å¯¼å…¥ä¾èµ–çš„beanã€‚byTypeæ–¹å¼ã€‚æŠŠé…ç½®å¥½çš„Beanæ‹¿æ¥ç”¨ï¼Œå®Œæˆå±æ€§ã€æ–¹æ³•çš„ç»„è£…ï¼Œå®ƒå¯ä»¥å¯¹ç±»æˆå‘˜å˜é‡ã€æ–¹æ³•åŠæ„é€ å‡½æ•°è¿›è¡Œæ ‡æ³¨ï¼Œå®Œæˆè‡ªåŠ¨è£…é…çš„å·¥ä½œã€‚å½“åŠ ä¸Šï¼ˆrequired=falseï¼‰æ—¶ï¼Œå°±ç®—æ‰¾ä¸åˆ°beanä¹Ÿä¸æŠ¥é”™ã€‚</p>

<p>@Qualifierï¼šå½“æœ‰å¤šä¸ªåŒä¸€ç±»å‹çš„Beanæ—¶ï¼Œå¯ä»¥ç”¨@Qualifier(â€œnameâ€)æ¥æŒ‡å®šã€‚ä¸@Autowiredé…åˆä½¿ç”¨ã€‚@Qualifieré™å®šæè¿°ç¬¦é™¤äº†èƒ½æ ¹æ®åå­—è¿›è¡Œæ³¨å…¥ï¼Œä½†èƒ½è¿›è¡Œæ›´ç»†ç²’åº¦çš„æ§åˆ¶å¦‚ä½•é€‰æ‹©å€™é€‰è€…ï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="nd">@Qualifier</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="err">â€œ</span><span class="n">demoInfoService</span><span class="err">â€</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">DemoInfoService</span> <span class="n">demoInfoService</span><span class="o">;</span>
</code></pre></div></div>
<p>@Resource(name=â€nameâ€,type=â€typeâ€)ï¼šæ²¡æœ‰æ‹¬å·å†…å†…å®¹çš„è¯ï¼Œé»˜è®¤byNameã€‚ä¸@Autowiredå¹²ç±»ä¼¼çš„äº‹ã€‚</p>

<h4 id="ä¸‰jpaæ³¨è§£">ä¸‰ã€JPAæ³¨è§£</h4>

<p>@Entityï¼š@Table(name=â€â€œ)ï¼šè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå®ä½“ç±»ã€‚ä¸€èˆ¬ç”¨äºjpaè¿™ä¸¤ä¸ªæ³¨è§£ä¸€èˆ¬ä¸€å—ä½¿ç”¨ï¼Œä½†æ˜¯å¦‚æœè¡¨åå’Œå®ä½“ç±»åç›¸åŒçš„è¯ï¼Œ@Tableå¯ä»¥çœç•¥</p>

<p>@MappedSuperClass:ç”¨åœ¨ç¡®å®šæ˜¯çˆ¶ç±»çš„entityä¸Šã€‚çˆ¶ç±»çš„å±æ€§å­ç±»å¯ä»¥ç»§æ‰¿ã€‚</p>

<p>@NoRepositoryBean:ä¸€èˆ¬ç”¨ä½œçˆ¶ç±»çš„repositoryï¼Œæœ‰è¿™ä¸ªæ³¨è§£ï¼Œspringä¸ä¼šå»å®ä¾‹åŒ–è¯¥repositoryã€‚</p>

<p>@Columnï¼šå¦‚æœå­—æ®µåä¸åˆ—åç›¸åŒï¼Œåˆ™å¯ä»¥çœç•¥ã€‚</p>

<p>@Idï¼šè¡¨ç¤ºè¯¥å±æ€§ä¸ºä¸»é”®ã€‚</p>

<p>@GeneratedValue(strategy = GenerationType.SEQUENCE,generator = â€œrepair_seqâ€)ï¼šè¡¨ç¤ºä¸»é”®ç”Ÿæˆç­–ç•¥æ˜¯sequenceï¼ˆå¯ä»¥ä¸ºAutoã€IDENTITYã€nativeç­‰ï¼ŒAutoè¡¨ç¤ºå¯åœ¨å¤šä¸ªæ•°æ®åº“é—´åˆ‡æ¢ï¼‰ï¼ŒæŒ‡å®šsequenceçš„åå­—æ˜¯repair_seqã€‚</p>

<p>@SequenceGeneretor(name = â€œrepair_seqâ€, sequenceName = â€œseq_repairâ€, allocationSize = 1)ï¼šnameä¸ºsequenceçš„åç§°ï¼Œä»¥ä¾¿ä½¿ç”¨ï¼ŒsequenceNameä¸ºæ•°æ®åº“çš„sequenceåç§°ï¼Œä¸¤ä¸ªåç§°å¯ä»¥ä¸€è‡´ã€‚</p>

<p>@Transientï¼šè¡¨ç¤ºè¯¥å±æ€§å¹¶éä¸€ä¸ªåˆ°æ•°æ®åº“è¡¨çš„å­—æ®µçš„æ˜ å°„,ORMæ¡†æ¶å°†å¿½ç•¥è¯¥å±æ€§ã€‚å¦‚æœä¸€ä¸ªå±æ€§å¹¶éæ•°æ®åº“è¡¨çš„å­—æ®µæ˜ å°„,å°±åŠ¡å¿…å°†å…¶æ ‡ç¤ºä¸º@Transient,å¦åˆ™,ORMæ¡†æ¶é»˜è®¤å…¶æ³¨è§£ä¸º@Basicã€‚@Basic(fetch=FetchType.LAZY)ï¼šæ ‡è®°å¯ä»¥æŒ‡å®šå®ä½“å±æ€§çš„åŠ è½½æ–¹å¼</p>

<p>@JsonIgnoreï¼šä½œç”¨æ˜¯jsonåºåˆ—åŒ–æ—¶å°†Java beanä¸­çš„ä¸€äº›å±æ€§å¿½ç•¥æ‰,åºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½å—å½±å“ã€‚</p>

<p>@JoinColumnï¼ˆname=â€loginIdâ€ï¼‰:ä¸€å¯¹ä¸€ï¼šæœ¬è¡¨ä¸­æŒ‡å‘å¦ä¸€ä¸ªè¡¨çš„å¤–é”®ã€‚ä¸€å¯¹å¤šï¼šå¦ä¸€ä¸ªè¡¨æŒ‡å‘æœ¬è¡¨çš„å¤–é”®ã€‚</p>

<p>@OneToOneã€@OneToManyã€@ManyToOneï¼šå¯¹åº”hibernateé…ç½®æ–‡ä»¶ä¸­çš„ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€ã€‚</p>

<h4 id="å››springmvcç›¸å…³æ³¨è§£">å››ã€springMVCç›¸å…³æ³¨è§£</h4>

<p>@RequestMappingï¼š@RequestMapping(â€œ/pathâ€)è¡¨ç¤ºè¯¥æ§åˆ¶å™¨å¤„ç†æ‰€æœ‰â€œ/pathâ€çš„UR Lè¯·æ±‚ã€‚RequestMappingæ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†è¯·æ±‚åœ°å€æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚
ç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚è¯¥æ³¨è§£æœ‰å…­ä¸ªå±æ€§ï¼š
params:æŒ‡å®šrequestä¸­å¿…é¡»åŒ…å«æŸäº›å‚æ•°å€¼æ˜¯ï¼Œæ‰è®©è¯¥æ–¹æ³•å¤„ç†ã€‚
headers:æŒ‡å®šrequestä¸­å¿…é¡»åŒ…å«æŸäº›æŒ‡å®šçš„headerå€¼ï¼Œæ‰èƒ½è®©è¯¥æ–¹æ³•å¤„ç†è¯·æ±‚ã€‚
value:æŒ‡å®šè¯·æ±‚çš„å®é™…åœ°å€ï¼ŒæŒ‡å®šçš„åœ°å€å¯ä»¥æ˜¯URI Template æ¨¡å¼
method:æŒ‡å®šè¯·æ±‚çš„methodç±»å‹ï¼Œ GETã€POSTã€PUTã€DELETEç­‰
consumes:æŒ‡å®šå¤„ç†è¯·æ±‚çš„æäº¤å†…å®¹ç±»å‹ï¼ˆContent-Typeï¼‰ï¼Œå¦‚application/json,text/html;
produces:æŒ‡å®šè¿”å›çš„å†…å®¹ç±»å‹ï¼Œä»…å½“requestè¯·æ±‚å¤´ä¸­çš„(Accept)ç±»å‹ä¸­åŒ…å«è¯¥æŒ‡å®šç±»å‹æ‰è¿”å›</p>

<p>@RequestParamï¼šç”¨åœ¨æ–¹æ³•çš„å‚æ•°å‰é¢ã€‚
@RequestParam
String a =request.getParameter(â€œaâ€)ã€‚</p>

<p>@PathVariable:è·¯å¾„å˜é‡ã€‚å¦‚</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RequestMapping</span><span class="o">(</span><span class="err">â€œ</span><span class="n">user</span><span class="o">/</span><span class="n">get</span><span class="o">/</span><span class="n">mac</span><span class="o">/{</span><span class="n">macAddress</span><span class="o">}</span><span class="err">â€</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">getByMacAddress</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">macAddress</span><span class="o">){</span>
   <span class="c1">//do something;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å‚æ•°ä¸å¤§æ‹¬å·é‡Œçš„åå­—ä¸€æ ·è¦ç›¸åŒã€‚</p>

<h4 id="äº”å…¨å±€å¼‚å¸¸å¤„ç†">äº”ã€å…¨å±€å¼‚å¸¸å¤„ç†</h4>

<p>@ControllerAdviceï¼šåŒ…å«@Componentã€‚å¯ä»¥è¢«æ‰«æåˆ°ã€‚ç»Ÿä¸€å¤„ç†å¼‚å¸¸ã€‚</p>

<p>@ExceptionHandlerï¼ˆException.classï¼‰ï¼šç”¨åœ¨æ–¹æ³•ä¸Šé¢è¡¨ç¤ºé‡åˆ°è¿™ä¸ªå¼‚å¸¸å°±æ‰§è¡Œä»¥ä¸‹æ–¹æ³•ã€‚</p>

<h4 id="å…­é¡¹ç›®ä¸­å…·ä½“é…ç½®è§£æå’Œä½¿ç”¨ç¯å¢ƒ">å…­ã€é¡¹ç›®ä¸­å…·ä½“é…ç½®è§£æå’Œä½¿ç”¨ç¯å¢ƒ</h4>

<p>@MappedSuperclassï¼š</p>

<p>1.@MappedSuperclass æ³¨è§£ä½¿ç”¨åœ¨çˆ¶ç±»ä¸Šé¢ï¼Œæ˜¯ç”¨æ¥æ ‡è¯†çˆ¶ç±»çš„</p>

<p>2.@MappedSuperclass æ ‡è¯†çš„ç±»è¡¨ç¤ºå…¶ä¸èƒ½æ˜ å°„åˆ°æ•°æ®åº“è¡¨ï¼Œå› ä¸ºå…¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„å®ä½“ç±»ï¼Œä½†æ˜¯å®ƒæ‰€æ‹¥æœ‰çš„å±æ€§èƒ½å¤Ÿæ˜ å°„åœ¨å…¶å­ç±»å¯¹ç”¨çš„æ•°æ®åº“è¡¨ä¸­</p>

<p>3.@MappedSuperclass æ ‡è¯†çš„ç±»ä¸èƒ½å†æœ‰@Entityæˆ–@Tableæ³¨è§£</p>

<p>@Columnï¼š</p>

<p>1.å½“å®ä½“çš„å±æ€§ä¸å…¶æ˜ å°„çš„æ•°æ®åº“è¡¨çš„åˆ—ä¸åŒåæ—¶éœ€è¦ä½¿ç”¨@Columnæ ‡æ³¨è¯´æ˜ï¼Œè¯¥å±æ€§é€šå¸¸ç½®äºå®ä½“çš„å±æ€§å£°æ˜è¯­å¥ä¹‹å‰ï¼Œè¿˜å¯ä¸ @Id æ ‡æ³¨ä¸€èµ·ä½¿ç”¨ã€‚</p>

<p>2.@Column æ ‡æ³¨çš„å¸¸ç”¨å±æ€§æ˜¯nameï¼Œç”¨äºè®¾ç½®æ˜ å°„æ•°æ®åº“è¡¨çš„åˆ—åã€‚æ­¤å¤–ï¼Œè¯¥æ ‡æ³¨è¿˜åŒ…å«å…¶å®ƒå¤šä¸ªå±æ€§ï¼Œå¦‚ï¼šuniqueã€nullableã€lengthã€precisionç­‰ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nameå±æ€§ï¼šnameå±æ€§å®šä¹‰äº†è¢«æ ‡æ³¨å­—æ®µåœ¨æ•°æ®åº“è¡¨ä¸­æ‰€å¯¹åº”å­—æ®µçš„åç§°
uniqueå±æ€§ï¼šuniqueå±æ€§è¡¨ç¤ºè¯¥å­—æ®µæ˜¯å¦ä¸ºå”¯ä¸€æ ‡è¯†ï¼Œé»˜è®¤ä¸ºfalseï¼Œå¦‚æœè¡¨ä¸­æœ‰ä¸€ä¸ªå­—æ®µéœ€è¦å”¯ä¸€æ ‡è¯†ï¼Œåˆ™æ—¢å¯ä»¥ä½¿ç”¨è¯¥æ ‡è®°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨@Tableæ³¨è§£ä¸­çš„@UniqueConstraint
nullableå±æ€§ï¼šnullableå±æ€§è¡¨ç¤ºè¯¥å­—æ®µæ˜¯å¦å¯ä»¥ä¸ºnullå€¼ï¼Œé»˜è®¤ä¸ºtrue
insertableå±æ€§ï¼šinsertableå±æ€§è¡¨ç¤ºåœ¨ä½¿ç”¨â€INSERTâ€è¯­å¥æ’å…¥æ•°æ®æ—¶ï¼Œæ˜¯å¦éœ€è¦æ’å…¥è¯¥å­—æ®µçš„å€¼
updateableå±æ€§ï¼šupdateableå±æ€§è¡¨ç¤ºåœ¨ä½¿ç”¨â€UPDATEâ€è¯­å¥æ’å…¥æ•°æ®æ—¶ï¼Œæ˜¯å¦éœ€è¦æ›´æ–°è¯¥å­—æ®µçš„å€¼
insertableå’Œupdateableå±æ€§ï¼šä¸€èˆ¬å¤šç”¨äºåªè¯»çš„å±æ€§ï¼Œä¾‹å¦‚ä¸»é”®å’Œå¤–é”®ç­‰ï¼Œè¿™äº›å­—æ®µé€šå¸¸æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„
columnDefinitionå±æ€§ï¼šcolumnDefinitionå±æ€§è¡¨ç¤ºåˆ›å»ºè¡¨æ—¶ï¼Œè¯¥å­—æ®µåˆ›å»ºçš„SQLè¯­å¥ï¼Œä¸€èˆ¬ç”¨äºé€šè¿‡Entityç”Ÿæˆè¡¨å®šä¹‰æ—¶ä½¿ç”¨ï¼Œå¦‚æœæ•°æ®åº“ä¸­è¡¨å·²ç»å»ºå¥½ï¼Œè¯¥å±æ€§æ²¡æœ‰å¿…è¦ä½¿ç”¨
tableå±æ€§ï¼štableå±æ€§å®šä¹‰äº†åŒ…å«å½“å‰å­—æ®µçš„è¡¨å
lengthå±æ€§ï¼šlengthå±æ€§è¡¨ç¤ºå­—æ®µçš„é•¿åº¦ï¼Œå½“å­—æ®µçš„ç±»å‹ä¸ºvarcharæ—¶ï¼Œè¯¥å±æ€§æ‰æœ‰æ•ˆï¼Œé»˜è®¤ä¸º255ä¸ªå­—ç¬¦
precisionå±æ€§å’Œscaleå±æ€§ï¼šprecisionå±æ€§å’Œscaleå±æ€§ä¸€èµ·è¡¨ç¤ºç²¾åº¦ï¼Œå½“å­—æ®µç±»å‹ä¸ºdoubleæ—¶ï¼Œprecisionè¡¨ç¤ºæ•°å€¼çš„æ€»é•¿åº¦ï¼Œscaleè¡¨ç¤ºå°æ•°ç‚¹æ‰€å çš„ä½æ•°
    å…·ä½“å¦‚ä¸‹ï¼š
   1.doubleç±»å‹å°†åœ¨æ•°æ®åº“ä¸­æ˜ å°„ä¸ºdoubleç±»å‹ï¼Œprecisionå’Œscaleå±æ€§æ— æ•ˆ
   2.doubleç±»å‹è‹¥åœ¨columnDefinitionå±æ€§ä¸­æŒ‡å®šæ•°å­—ç±»å‹ä¸ºdecimalå¹¶æŒ‡å®šç²¾åº¦ï¼Œåˆ™æœ€ç»ˆä»¥columnDefinitionä¸ºå‡†
   3.BigDecimalç±»å‹åœ¨æ•°æ®åº“ä¸­æ˜ å°„ä¸ºdecimalç±»å‹ï¼Œprecisionå’Œscaleå±æ€§æœ‰æ•ˆ
   4.precisionå’Œscaleå±æ€§åªåœ¨BigDecimalç±»å‹ä¸­æœ‰æ•ˆ
</code></pre></div></div>
<p>3.@Column æ ‡æ³¨çš„columnDefinitionå±æ€§: è¡¨ç¤ºè¯¥å­—æ®µåœ¨æ•°æ®åº“ä¸­çš„å®é™…ç±»å‹.é€šå¸¸ ORM æ¡†æ¶å¯ä»¥æ ¹æ®å±æ€§ç±»å‹è‡ªåŠ¨åˆ¤æ–­æ•°æ®åº“ä¸­å­—æ®µçš„ç±»å‹,ä½†æ˜¯å¯¹äºDateç±»å‹ä»æ— æ³•ç¡®å®šæ•°æ®åº“ä¸­å­—æ®µç±»å‹ç©¶ç«Ÿæ˜¯DATE,TIMEè¿˜æ˜¯TIMESTAMP.æ­¤å¤–,Stringçš„é»˜è®¤æ˜ å°„ç±»å‹ä¸ºVARCHAR,å¦‚æœè¦å°† String ç±»å‹æ˜ å°„åˆ°ç‰¹å®šæ•°æ®åº“çš„ BLOB æˆ–TEXTå­—æ®µç±»å‹.</p>

<p>4.@Columnæ ‡æ³¨ä¹Ÿå¯ç½®äºå±æ€§çš„getteræ–¹æ³•ä¹‹å‰</p>

<p>@Getterå’Œ@Setterï¼ˆLombokï¼‰</p>

<p>@Setterï¼šæ³¨è§£åœ¨å±æ€§ä¸Šï¼›ä¸ºå±æ€§æä¾› setting æ–¹æ³• @Getterï¼šæ³¨è§£åœ¨å±æ€§ä¸Šï¼›ä¸ºå±æ€§æä¾› getting æ–¹æ³•
æ‰©å±•ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Dataï¼šæ³¨è§£åœ¨ç±»ä¸Šï¼›æä¾›ç±»æ‰€æœ‰å±æ€§çš„ getting å’Œ setting æ–¹æ³•ï¼Œæ­¤å¤–è¿˜æä¾›äº†equalsã€canEqualã€hashCodeã€toString æ–¹æ³•

@Setterï¼šæ³¨è§£åœ¨å±æ€§ä¸Šï¼›ä¸ºå±æ€§æä¾› setting æ–¹æ³•

@Getterï¼šæ³¨è§£åœ¨å±æ€§ä¸Šï¼›ä¸ºå±æ€§æä¾› getting æ–¹æ³•

@Log4j2 ï¼šæ³¨è§£åœ¨ç±»ä¸Šï¼›ä¸ºç±»æä¾›ä¸€ä¸ª å±æ€§åä¸ºlog çš„ log4j æ—¥å¿—å¯¹è±¡ï¼Œå’Œ@Log4jæ³¨è§£ç±»ä¼¼

@NoArgsConstructorï¼šæ³¨è§£åœ¨ç±»ä¸Šï¼›ä¸ºç±»æä¾›ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•

@AllArgsConstructorï¼šæ³¨è§£åœ¨ç±»ä¸Šï¼›ä¸ºç±»æä¾›ä¸€ä¸ªå…¨å‚çš„æ„é€ æ–¹æ³•

@EqualsAndHashCode:é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨æ‰€æœ‰éç¬æ€(non-transient)å’Œéé™æ€(non-static)å­—æ®µæ¥ç”Ÿæˆequalså’Œhascodeæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå…·ä½“ä½¿ç”¨å“ªäº›å±æ€§ã€‚

@toString:ç”ŸæˆtoStringæ–¹æ³•ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šè¾“å‡ºç±»åã€æ‰€æœ‰å±æ€§ï¼Œå±æ€§ä¼šæŒ‰ç…§é¡ºåºè¾“å‡ºï¼Œä»¥é€—å·åˆ†å‰²ã€‚

@NoArgsConstructor, @RequiredArgsConstructor and @AllArgsConstructor
æ— å‚æ„é€ å™¨ã€éƒ¨åˆ†å‚æ•°æ„é€ å™¨ã€å…¨å‚æ„é€ å™¨ï¼Œå½“æˆ‘ä»¬éœ€è¦é‡è½½å¤šä¸ªæ„é€ å™¨çš„æ—¶å€™ï¼Œåªèƒ½è‡ªå·±æ‰‹å†™äº†

@NonNullï¼šæ³¨è§£åœ¨å±æ€§ä¸Šï¼Œå¦‚æœæ³¨è§£äº†ï¼Œå°±å¿…é¡»ä¸èƒ½ä¸ºNull

@val:æ³¨è§£åœ¨å±æ€§ä¸Šï¼Œå¦‚æœæ³¨è§£äº†ï¼Œå°±æ˜¯è®¾ç½®ä¸ºfinalç±»å‹ï¼Œå¯æŸ¥çœ‹æºç çš„æ³¨é‡ŠçŸ¥é“
</code></pre></div></div>
<p>@PreUpdateå’Œ@PrePersist</p>

<p>@PreUpdate
1.ç”¨äºä¸ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æŒ‡å®šå›è°ƒæ–¹æ³•ã€‚
2.è¯¥æ³¨é‡Šå¯ä»¥åº”ç”¨äºå®ä½“ç±»ï¼Œæ˜ å°„è¶…ç±»æˆ–å›è°ƒç›‘å¬å™¨ç±»çš„æ–¹æ³•ã€‚
3.ç”¨äºsetter å¦‚æœè¦æ¯æ¬¡æ›´æ–°å®ä½“æ—¶æ›´æ–°å®ä½“çš„å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨@PreUpdateæ³¨é‡Šã€‚
4.ä½¿ç”¨è¯¥æ³¨é‡Šï¼Œæ‚¨ä¸å¿…åœ¨æ¯æ¬¡æ›´æ–°ç”¨æˆ·å®ä½“æ—¶æ˜¾å¼æ›´æ–°ç›¸åº”çš„å±æ€§ã€‚
5.preUpdateä¸å…è®¸æ‚¨æ›´æ”¹æ‚¨çš„å®ä½“ã€‚ æ‚¨åªèƒ½ä½¿ç”¨ä¼ é€’ç»™äº‹ä»¶çš„è®¡ç®—çš„æ›´æ”¹é›†æ¥ä¿®æ”¹åŸå§‹å­—æ®µå€¼ã€‚
@Prepersist
1.æŸ¥çœ‹@PrePersistæ³¨é‡Šï¼Œå¸®åŠ©æ‚¨åœ¨æŒä¹…åŒ–ä¹‹å‰è‡ªåŠ¨å¡«å……å®ä½“å±æ€§ã€‚
2.å¯ä»¥ç”¨æ¥åœ¨ä½¿ç”¨jpaçš„æ—¶è®°å½•ä¸€äº›ä¸šåŠ¡æ— å…³çš„å­—æ®µï¼Œæ¯”å¦‚æœ€åæ›´æ–°æ—¶é—´ç­‰ç­‰ã€‚ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ³¨è§£ï¼ˆdeleteæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼‰
3.@PrePersist saveä¹‹å‰è¢«è°ƒç”¨ï¼Œå®ƒå¯ä»¥è¿”å›ä¸€ä¸ªDBObjectä»£æ›¿ä¸€ä¸ªç©ºçš„ @PostPersist saveåˆ°datastoreä¹‹åè¢«è°ƒç”¨
4.@PostLoad åœ¨Entityè¢«æ˜ å°„ä¹‹åè¢«è°ƒç”¨ @EntityListeners æŒ‡å®šå¤–éƒ¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å®ç°ç±»
å®ä½“Beanç”Ÿå‘½å‘¨æœŸçš„å›è°ƒäº‹ä»¶</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>æ–¹æ³•çš„æ ‡æ³¨ï¼š @PrePersist @PostPersist @PreRemove @PostRemove @PreUpdate @PostUpdate @PostLoad ã€‚
å®ƒä»¬æ ‡æ³¨åœ¨æŸä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæ²¡æœ‰ä»»ä½•å‚æ•°ã€‚è¿™äº›æ ‡æ³¨ä¸‹çš„æ–¹æ³•åœ¨å®ä½“çš„çŠ¶æ€æ”¹å˜å‰åæ—¶è¿›è¡Œè°ƒç”¨ï¼Œç›¸å½“äºæ‹¦æˆªå™¨;
pre è¡¨ç¤ºåœ¨çŠ¶æ€åˆ‡æ¢å‰è§¦å‘ï¼Œpost åˆ™è¡¨ç¤ºåœ¨åˆ‡æ¢åè§¦å‘ã€‚
@PostLoad äº‹ä»¶åœ¨ä¸‹åˆ—æƒ…å†µè§¦å‘ï¼š
1. æ‰§è¡Œ EntityManager.find()æˆ– getreference()æ–¹æ³•è½½å…¥ä¸€ä¸ªå®ä½“åï¼›
2. æ‰§è¡Œ JPA QL æŸ¥è¯¢è¿‡åï¼›
3. EntityManager.refresh( )æ–¹æ³•è¢«è°ƒç”¨åã€‚
@PrePersist å’Œ @PostPersistäº‹ä»¶åœ¨å®ä½“å¯¹è±¡æ’å…¥åˆ°æ•°æ®åº“çš„è¿‡ç¨‹ä¸­å‘ç”Ÿ;
@PrePersist äº‹ä»¶åœ¨è°ƒç”¨ EntityManager.persist()æ–¹æ³•åç«‹åˆ»å‘ç”Ÿï¼Œçº§è”ä¿å­˜ä¹Ÿä¼šå‘ç”Ÿæ­¤äº‹ä»¶ï¼Œæ­¤æ—¶çš„æ•°æ®è¿˜æ²¡æœ‰çœŸå®æ’å…¥è¿›æ•°æ®åº“ã€‚
@PostPersist äº‹ä»¶åœ¨æ•°æ®å·²ç»æ’å…¥è¿›æ•°æ®åº“åå‘ç”Ÿã€‚
@PreUpdate å’Œ @PostUpdate äº‹ä»¶çš„è§¦å‘ç”±æ›´æ–°å®ä½“å¼•èµ·, @PreUpdate äº‹ä»¶åœ¨å®ä½“çš„çŠ¶æ€åŒæ­¥åˆ°æ•°æ®åº“ä¹‹å‰è§¦å‘ï¼Œæ­¤æ—¶çš„æ•°æ®è¿˜æ²¡æœ‰çœŸå®æ›´æ–°åˆ°æ•°æ®åº“ã€‚
@PostUpdate äº‹ä»¶åœ¨å®ä½“çš„çŠ¶æ€åŒæ­¥åˆ°æ•°æ®åº“åè§¦å‘ï¼ŒåŒæ­¥åœ¨äº‹åŠ¡æäº¤æ—¶å‘ç”Ÿã€‚
@PreRemove å’Œ @PostRemove äº‹ä»¶çš„è§¦å‘ç”±åˆ é™¤å®ä½“å¼•èµ·ï¼Œ@ PreRemove äº‹ä»¶åœ¨å®ä½“ä»æ•°æ®åº“åˆ é™¤ä¹‹å‰è§¦å‘ï¼Œå³è°ƒç”¨äº† EntityManager.remove()æ–¹æ³•æˆ–è€…çº§è”åˆ é™¤

å½“ä½ åœ¨æ‰§è¡Œå„ç§æŒä¹…åŒ–æ–¹æ³•çš„æ—¶å€™ï¼Œå®ä½“çš„çŠ¶æ€ä¼šéšä¹‹æ”¹å˜ï¼ŒçŠ¶æ€çš„æ”¹å˜ä¼šå¼•å‘ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚è¿™äº›äº‹ä»¶å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ³¨é‡Šç¬¦æ¥æŒ‡ç¤ºå‘ç”Ÿæ—¶çš„å›è°ƒå‡½æ•°ã€‚
@javax.persistence.PostLoadï¼šåŠ è½½åã€‚
@javax.persistence.PrePersistï¼šæŒä¹…åŒ–å‰ã€‚
@javax.persistence.PostPersistï¼šæŒä¹…åŒ–åã€‚
@javax.persistence.PreUpdateï¼šæ›´æ–°å‰ã€‚
@javax.persistence.PostUpdateï¼šæ›´æ–°åã€‚
@javax.persistence.PreRemoveï¼šåˆ é™¤å‰ã€‚
@javax.persistence.PostRemoveï¼šåˆ é™¤åã€‚
</code></pre></div></div>

<h5 id="1æ•°æ®åº“æŸ¥è¯¢">1ï¼‰æ•°æ®åº“æŸ¥è¯¢</h5>

<p>@PostLoadäº‹ä»¶åœ¨ä¸‹åˆ—æƒ…å†µä¸‹è§¦å‘ï¼š</p>

<p>æ‰§è¡ŒEntityManager.find()æˆ–getreference()æ–¹æ³•è½½å…¥ä¸€ä¸ªå®ä½“åã€‚</p>

<p>æ‰§è¡ŒJPQLæŸ¥è¯¢åã€‚</p>

<p>EntityManager.refresh()æ–¹æ³•è¢«è°ƒç”¨åã€‚</p>

<h5 id="2æ•°æ®åº“æ’å…¥">2ï¼‰æ•°æ®åº“æ’å…¥</h5>

<p>@PrePersistå’Œ@PostPersistäº‹ä»¶åœ¨å®ä½“å¯¹è±¡æ’å…¥åˆ°æ•°æ®åº“çš„è¿‡ç¨‹ä¸­å‘ç”Ÿï¼š</p>

<p>@PrePersistäº‹ä»¶åœ¨è°ƒç”¨persist()æ–¹æ³•åç«‹åˆ»å‘ç”Ÿï¼Œæ­¤æ—¶çš„æ•°æ®è¿˜æ²¡æœ‰çœŸæ­£æ’å…¥è¿›æ•°æ®åº“ã€‚</p>

<p>@PostPersistäº‹ä»¶åœ¨æ•°æ®å·²ç»æ’å…¥è¿›æ•°æ®åº“åå‘ç”Ÿã€‚</p>

<h5 id="3æ•°æ®åº“æ›´æ–°">3ï¼‰æ•°æ®åº“æ›´æ–°</h5>

<p>@PreUpdateå’Œ@PostUpdateäº‹ä»¶çš„è§¦å‘ç”±æ›´æ–°å®ä½“å¼•èµ·ï¼š</p>

<p>@PreUpdateäº‹ä»¶åœ¨å®ä½“çš„çŠ¶æ€åŒæ­¥åˆ°æ•°æ®åº“ä¹‹å‰è§¦å‘ï¼Œæ­¤æ—¶çš„æ•°æ®è¿˜æ²¡æœ‰çœŸæ­£æ›´æ–°åˆ°æ•°æ®åº“ã€‚</p>

<p>@PostUpdateäº‹ä»¶åœ¨å®ä½“çš„çŠ¶æ€åŒæ­¥åˆ°æ•°æ®åº“ä¹‹åè§¦å‘ï¼ŒåŒæ­¥åœ¨äº‹åŠ¡æäº¤æ—¶å‘ç”Ÿã€‚</p>

<h5 id="4æ•°æ®åº“åˆ é™¤">4ï¼‰æ•°æ®åº“åˆ é™¤</h5>

<p>@PreRemoveå’Œ@PostRemoveäº‹ä»¶çš„è§¦å‘ç”±åˆ é™¤å®ä½“å¼•èµ·ï¼š</p>

<p>@PreRemoveäº‹ä»¶åœ¨å®ä½“ä»æ•°æ®åº“åˆ é™¤ä¹‹å‰è§¦å‘ï¼Œå³åœ¨è°ƒç”¨remove()æ–¹æ³•åˆ é™¤æ—¶å‘ç”Ÿï¼Œæ­¤æ—¶çš„æ•°æ®è¿˜æ²¡æœ‰çœŸæ­£ä»æ•°æ®åº“ä¸­åˆ é™¤ã€‚</p>

<p>@PostRemoveäº‹ä»¶åœ¨å®ä½“ä»æ•°æ®åº“ä¸­åˆ é™¤åè§¦å‘ã€‚</p>

<p>@NoArgsConstructor &amp; @AllArgsConstructorï¼ˆlombokï¼‰</p>

<p>@NoArgsConstructorï¼Œæä¾›ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ã€‚</p>

<p>@AllArgsConstructorï¼Œæä¾›ä¸€ä¸ªå…¨å‚çš„æ„é€ æ–¹æ³•ã€‚</p>

<p>@Configuration &amp; @bean1.@Configurationæ ‡æ³¨åœ¨ç±»ä¸Šï¼Œç›¸å½“äºæŠŠè¯¥ç±»ä½œä¸ºspringçš„xmlé…ç½®æ–‡ä»¶ä¸­çš„<beans>ï¼Œä½œç”¨ä¸ºï¼šé…ç½®springå®¹å™¨(åº”ç”¨ä¸Šä¸‹æ–‡)</beans></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">spring</span><span class="o">.</span><span class="na">support</span><span class="o">.</span><span class="na">configuration</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestConfiguration</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">TestConfiguration</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"springå®¹å™¨å¯åŠ¨åˆå§‹åŒ–ã€‚ã€‚ã€‚"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ç›¸å½“äºï¼š
å¤åˆ¶ä»£ç 
  1 <?xml version="1.0" encoding="UTF-8"?>
  2 &lt;beans xmlns=â€http://www.springframework.org/schema/beansâ€ xmlns:xsi=â€http://www.w3.org/2001/XMLSchema-instanceâ€
  3     xmlns:context=â€http://www.springframework.org/schema/contextâ€ xmlns:jdbc=â€http://www.springframework.org/schema/jdbcâ€
  4     xmlns:jee=â€http://www.springframework.org/schema/jeeâ€ xmlns:tx=â€http://www.springframework.org/schema/txâ€
  5     xmlns:util=â€http://www.springframework.org/schema/utilâ€ xmlns:task=â€http://www.springframework.org/schema/taskâ€ xsi:schemaLocation=â€
  6         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
  7         http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd
  8         http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-4.0.xsd
  9         http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-4.0.xsd
 10         http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd
 11         http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.0.xsd
 12         http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-4.0.xsdâ€ default-lazy-init=â€falseâ€&gt;
 13
 14
 15 &lt;/beans&gt;
å¤åˆ¶ä»£ç 
ä¸»æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼š
å¤åˆ¶ä»£ç 
  1 package com.test.spring.support.configuration;
  2
  3 public class TestMain {
  4     public static void main(String[] args) {
  5
  6         //@Configurationæ³¨è§£çš„springå®¹å™¨åŠ è½½æ–¹å¼ï¼Œç”¨AnnotationConfigApplicationContextæ›¿æ¢ClassPathXmlApplicationContext
  7         ApplicationContext context = new AnnotationConfigApplicationContext(TestConfiguration.class);
  8
  9         //å¦‚æœåŠ è½½spring-context.xmlæ–‡ä»¶ï¼š
 10         //ApplicationContext context = new ClassPathXmlApplicationContext(â€œspring-context.xmlâ€);
 11     }
 12 }
å¤åˆ¶ä»£ç 
ä»è¿è¡Œä¸»æ–¹æ³•ç»“æœå¯ä»¥çœ‹å‡ºï¼Œspringå®¹å™¨å·²ç»å¯åŠ¨äº†ï¼š</p>

<p>1 å…«æœˆ 11, 2016 12:04:11 ä¸‹åˆ org.springframework.context.annotation.AnnotationConfigApplicationContext prepareRefresh
  2 ä¿¡æ¯: Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@203e25d3: startup date [Thu Aug 11 12:04:11 CST 2016]; root of context hierarchy
  3 springå®¹å™¨å¯åŠ¨åˆå§‹åŒ–ã€‚ã€‚ã€‚
2.@Beanæ ‡æ³¨åœ¨æ–¹æ³•ä¸Š(è¿”å›æŸä¸ªå®ä¾‹çš„æ–¹æ³•)ï¼Œç­‰ä»·äºspringçš„xmlé…ç½®æ–‡ä»¶ä¸­çš„<bean>ï¼Œä½œç”¨ä¸ºï¼šæ³¨å†Œbeanå¯¹è±¡</bean></p>

<p>beanç±»ï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1 package com.test.spring.support.configuration;
  2
  3 public class TestBean {
  4
  5     public void sayHello(){
  6         System.out.println(â€œTestBean sayHelloâ€¦â€);
  7     }
  8
  9     public String toString(){
 10         return â€œusername:â€+this.username+â€,url:â€+this.url+â€,password:â€+this.password;
 11     }
 12
 13     public void start(){
 14         System.out.println(â€œTestBean åˆå§‹åŒ–ã€‚ã€‚ã€‚â€);
 15     }
 16
 17     public void cleanUp(){
 18         System.out.println(â€œTestBean é”€æ¯ã€‚ã€‚ã€‚â€);
 19     }
 20 }
å¤åˆ¶ä»£ç 
é…ç½®ç±»ï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1 package com.test.spring.support.configuration;
  2
  3 @Configuration
  4 public class TestConfiguration {
  5         public TestConfiguration(){
  6             System.out.println(â€œspringå®¹å™¨å¯åŠ¨åˆå§‹åŒ–ã€‚ã€‚ã€‚â€);
  7         }
  8
  9     //@Beanæ³¨è§£æ³¨å†Œbean,åŒæ—¶å¯ä»¥æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•
 10     //@Bean(name=â€testNeanâ€,initMethod=â€startâ€,destroyMethod=â€cleanUpâ€)
 11     @Bean
 12     @Scope(â€œprototypeâ€)
 13     public TestBean testBean() {
 14         return new TestBean();
 15     }
 16 }
å¤åˆ¶ä»£ç 
ä¸»æ–¹æ³•æµ‹è¯•ç±»ï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1 package com.test.spring.support.configuration;
  2
  3 public class TestMain {
  4     public static void main(String[] args) {
  5         ApplicationContext context = new AnnotationConfigApplicationContext(TestConfiguration.class);
  6         //è·å–bean
  7         TestBean tb = context.getBean(â€œtestBeanâ€);
  8         tb.sayHello();
  9     }
 10 }
å¤åˆ¶ä»£ç 
æ³¨ï¼š
(1)ã€@Beanæ³¨è§£åœ¨è¿”å›å®ä¾‹çš„æ–¹æ³•ä¸Šï¼Œå¦‚æœæœªé€šè¿‡@BeanæŒ‡å®šbeançš„åç§°ï¼Œåˆ™é»˜è®¤ä¸æ ‡æ³¨çš„æ–¹æ³•åç›¸åŒï¼›
(2)ã€@Beanæ³¨è§£é»˜è®¤ä½œç”¨åŸŸä¸ºå•ä¾‹singletonä½œç”¨åŸŸï¼Œå¯é€šè¿‡@Scope(â€œprototypeâ€)è®¾ç½®ä¸ºåŸå‹ä½œç”¨åŸŸï¼›
(3)ã€æ—¢ç„¶@Beançš„ä½œç”¨æ˜¯æ³¨å†Œbeanå¯¹è±¡ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥ä½¿ç”¨@Componentã€@Controllerã€@Serviceã€@Ripositoryç­‰æ³¨è§£æ³¨å†Œbeanï¼Œå½“ç„¶éœ€è¦é…ç½®@ComponentScanæ³¨è§£è¿›è¡Œè‡ªåŠ¨æ‰«æã€‚</p>

<p>beanç±»ï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1 package com.test.spring.support.configuration;
  2
  3 //æ·»åŠ æ³¨å†Œbeançš„æ³¨è§£
  4 @Component
  5 public class TestBean {
  6
  7     public void sayHello(){
  8         System.out.println(â€œTestBean sayHelloâ€¦â€);
  9     }
 10
 11     public String toString(){
 12         return â€œusername:â€+this.username+â€,url:â€+this.url+â€,password:â€+this.password;
 13     }
 14 }
å¤åˆ¶ä»£ç 
é…ç½®ç±»ï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1
//å¼€å¯æ³¨è§£é…ç½®
  2 @Configuration
  3 //æ·»åŠ è‡ªåŠ¨æ‰«ææ³¨è§£ï¼ŒbasePackagesä¸ºTestBeanåŒ…è·¯å¾„
  4 @ComponentScan(basePackages = â€œcom.test.spring.support.configurationâ€)
  5 public class TestConfiguration {
  6     public TestConfiguration(){
  7         System.out.println(â€œspringå®¹å™¨å¯åŠ¨åˆå§‹åŒ–ã€‚ã€‚ã€‚â€);
  8     }
  9
 10     //å–æ¶ˆ@Beanæ³¨è§£æ³¨å†Œbeançš„æ–¹å¼
 11     //@Bean
 12     //@Scope(â€œprototypeâ€)
 13     //public TestBean testBean() {
 14     //  return new TestBean();
 15     //}
 16 }
å¤åˆ¶ä»£ç 
ä¸»æ–¹æ³•æµ‹è¯•è·å–beanå¯¹è±¡ï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1 public class TestMain {
  2     public static void main(String[] args) {
  3         ApplicationContext context = new AnnotationConfigApplicationContext(TestConfiguration.class);
  4         //è·å–bean
  5         TestBean tb = context.getBean(â€œtestBeanâ€);
  6         tb.sayHello();
  7     }
  8 }
å¤åˆ¶ä»£ç 
sayHello()æ–¹æ³•éƒ½è¢«æ­£å¸¸è°ƒç”¨ã€‚</p>

<p>ä½¿ç”¨@Configurationæ³¨è§£æ¥ä»£æ›¿Springçš„beané…ç½®</p>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„Springé…ç½®æ–‡ä»¶ï¼ˆapplication-config.xmlï¼‰ï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1 <beans>
  2         <bean id="orderService" class="com.acme.OrderService"></bean>
  3                 <constructor-arg ref="orderRepository"></constructor-arg>
  4         &lt;/bean&gt;
  5         <bean id="orderRepository" class="com.acme.OrderRepository"></bean>
  6                 <constructor-arg ref="dataSource"></constructor-arg>
  7         &lt;/bean&gt;
  8 </beans>
å¤åˆ¶ä»£ç 
ç„¶åä½ å°±å¯ä»¥åƒè¿™æ ·æ¥ä½¿ç”¨æ˜¯beanäº†ï¼š</p>

<p>1 ApplicationContext ctx = new ClassPathXmlApplicationContext(â€œapplication-config.xmlâ€);
  2 OrderService orderService = (OrderService) ctx.getBean(â€œorderServiceâ€);
ç°åœ¨Spring Java Configurationè¿™ä¸ªé¡¹ç›®æä¾›äº†ä¸€ç§é€šè¿‡javaä»£ç æ¥è£…é…beançš„æ–¹æ¡ˆï¼š</p>

<p>å¤åˆ¶ä»£ç 
  1 @Configuration
  2 public class ApplicationConfig {
  3
  4         public @Bean OrderService orderService() {
  5                 return new OrderService(orderRepository());
  6         }
  7
  8         public @Bean OrderRepository orderRepository() {
  9                 return new OrderRepository(dataSource());
 10         }
 11
 12         public @Bean DataSource dataSource() {
 13                 // instantiate and return an new DataSource â€¦
 14         }
 15 }
å¤åˆ¶ä»£ç 
ç„¶åä½ å°±å¯ä»¥åƒè¿™æ ·æ¥ä½¿ç”¨æ˜¯beanäº†ï¼š</p>

<p>1 JavaConfigApplicationContext ctx = new JavaConfigApplicationContext(ApplicationConfig.class);
  2 OrderService orderService = ctx.getBean(OrderService.class);
è¿™ä¹ˆåšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢?</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1.ä½¿ç”¨çº¯javaä»£ç ï¼Œä¸åœ¨éœ€è¦xml

 2.åœ¨é…ç½®ä¸­ä¹Ÿå¯äº«å—OOå¸¦æ¥çš„å¥½å¤„(é¢å‘å¯¹è±¡)

 3.ç±»å‹å®‰å…¨å¯¹é‡æ„ä¹Ÿèƒ½æä¾›è‰¯å¥½çš„æ”¯æŒ

 4.å‡å°‘å¤æ‚é…ç½®æ–‡ä»¶çš„åŒæ—¶ä¾æ—§èƒ½äº«å—åˆ°æ‰€æœ‰springIoCå®¹å™¨æä¾›çš„åŠŸèƒ½
</code></pre></div></div>
:ET