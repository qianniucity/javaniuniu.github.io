I"ç<h4 id="joinpoint-å¯¹è±¡">JoinPoint å¯¹è±¡</h4>
<p>JoinPointå¯¹è±¡<code class="highlighter-rouge">å°è£…äº†SpringAopä¸­åˆ‡é¢æ–¹æ³•çš„ä¿¡æ¯</code>,åœ¨åˆ‡é¢æ–¹æ³•ä¸­æ·»åŠ <code class="highlighter-rouge">JoinPointå‚æ•°</code>,å°±å¯ä»¥è·å–åˆ°å°è£…äº†è¯¥æ–¹æ³•ä¿¡æ¯çš„<code class="highlighter-rouge">JoinPointå¯¹è±¡</code>.
å¸¸ç”¨api:</p>

<p>æ–¹æ³•å	åŠŸèƒ½
Signature getSignature();	è·å–å°è£…äº†ç½²åä¿¡æ¯çš„å¯¹è±¡,åœ¨è¯¥å¯¹è±¡ä¸­å¯ä»¥è·å–åˆ°ç›®æ ‡æ–¹æ³•å,æ‰€å±ç±»çš„Classç­‰ä¿¡æ¯
Object[] getArgs();	è·å–ä¼ å…¥ç›®æ ‡æ–¹æ³•çš„å‚æ•°å¯¹è±¡
Object getTarget();	è·å–è¢«ä»£ç†çš„å¯¹è±¡
Object getThis();	è·å–ä»£ç†å¯¹è±¡
ProceedingJoinPointå¯¹è±¡</p>

<p>ProceedingJoinPointå¯¹è±¡æ˜¯JoinPointçš„å­æ¥å£,è¯¥å¯¹è±¡åªç”¨åœ¨@Aroundçš„åˆ‡é¢æ–¹æ³•ä¸­,
æ·»åŠ äº†
Object proceed() throws Throwable //æ‰§è¡Œç›®æ ‡æ–¹æ³•
Object proceed(Object[] var1) throws Throwable //ä¼ å…¥çš„æ–°çš„å‚æ•°å»æ‰§è¡Œç›®æ ‡æ–¹æ³•
ä¸¤ä¸ªæ–¹æ³•.</p>

<p>Demo</p>

<p>åˆ‡é¢ç±»</p>

<p>@Aspect
@Component
public class aopAspect {
    /**
     * å®šä¹‰ä¸€ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼,ç”¨æ¥ç¡®å®šå“ªäº›ç±»éœ€è¦ä»£ç†
     * execution(* aopdemo.<em>.</em>(..))ä»£è¡¨aopdemoåŒ…ä¸‹æ‰€æœ‰ç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šè¢«ä»£ç†
     <em>/
    @Pointcut(â€œexecution(</em> aopdemo.<em>.</em>(..))â€)
    public void declareJoinPointerExpression() {}</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/**
 * å‰ç½®æ–¹æ³•,åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œ
 * @param joinPoint å°è£…äº†ä»£ç†æ–¹æ³•ä¿¡æ¯çš„å¯¹è±¡,è‹¥ç”¨ä¸åˆ°åˆ™å¯ä»¥å¿½ç•¥ä¸å†™
 */
@Before("declareJoinPointerExpression()")
public void beforeMethod(JoinPoint joinPoint){
    System.out.println("ç›®æ ‡æ–¹æ³•åä¸º:" + joinPoint.getSignature().getName());
    System.out.println("ç›®æ ‡æ–¹æ³•æ‰€å±ç±»çš„ç®€å•ç±»å:" +        joinPoint.getSignature().getDeclaringType().getSimpleName());
    System.out.println("ç›®æ ‡æ–¹æ³•æ‰€å±ç±»çš„ç±»å:" + joinPoint.getSignature().getDeclaringTypeName());
    System.out.println("ç›®æ ‡æ–¹æ³•å£°æ˜ç±»å‹:" + Modifier.toString(joinPoint.getSignature().getModifiers()));
    //è·å–ä¼ å…¥ç›®æ ‡æ–¹æ³•çš„å‚æ•°
    Object[] args = joinPoint.getArgs();
    for (int i = 0; i &lt; args.length; i++) {
        System.out.println("ç¬¬" + (i+1) + "ä¸ªå‚æ•°ä¸º:" + args[i]);
    }
    System.out.println("è¢«ä»£ç†çš„å¯¹è±¡:" + joinPoint.getTarget());
    System.out.println("ä»£ç†å¯¹è±¡è‡ªå·±:" + joinPoint.getThis());
}

/**
 * ç¯ç»•æ–¹æ³•,å¯è‡ªå®šä¹‰ç›®æ ‡æ–¹æ³•æ‰§è¡Œçš„æ—¶æœº
 * @param pjd JoinPointçš„å­æ¥å£,æ·»åŠ äº†
 *            Object proceed() throws Throwable æ‰§è¡Œç›®æ ‡æ–¹æ³•
 *            Object proceed(Object[] var1) throws Throwable ä¼ å…¥çš„æ–°çš„å‚æ•°å»æ‰§è¡Œç›®æ ‡æ–¹æ³•
 *            ä¸¤ä¸ªæ–¹æ³•
 * @return æ­¤æ–¹æ³•éœ€è¦è¿”å›å€¼,è¿”å›å€¼è§†ä¸ºç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼
 */
@Around("declareJoinPointerExpression()")
public Object aroundMethod(ProceedingJoinPoint pjd){
    Object result = null;

    try {
        //å‰ç½®é€šçŸ¥
        System.out.println("ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰...");
        //æ‰§è¡Œç›®æ ‡æ–¹æ³•
        //result = pjd.proeed();
        //ç”¨æ–°çš„å‚æ•°å€¼æ‰§è¡Œç›®æ ‡æ–¹æ³•
        result = pjd.proceed(new Object[]{"newSpring","newAop"});
        //è¿”å›é€šçŸ¥
        System.out.println("ç›®æ ‡æ–¹æ³•è¿”å›ç»“æœå...");
    } catch (Throwable e) {
        //å¼‚å¸¸é€šçŸ¥
        System.out.println("æ‰§è¡Œç›®æ ‡æ–¹æ³•å¼‚å¸¸å...");
        throw new RuntimeException(e);
    }
    //åç½®é€šçŸ¥
    System.out.println("ç›®æ ‡æ–¹æ³•æ‰§è¡Œå...");

    return result;
} }
</code></pre></div></div>

<p>è¢«ä»£ç†ç±»</p>

<p>/**</p>
<ul>
  <li>è¢«ä»£ç†å¯¹è±¡
 */
@Component
public class TargetClass {
 /**
    <ul>
      <li>æ‹¼æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²
  */
 public String joint(String str1, String str2) {
 return str1 + â€œ+â€ + str2;
 }
}
æµ‹è¯•ç±»</li>
    </ul>
  </li>
</ul>

<p>public class TestAop {
    @Test
    public void testAOP() {
        //1ã€åˆ›å»ºSpringçš„IOCçš„å®¹å™¨
        ApplicationContext ctx = new ClassPathXmlApplicationContext(â€œclasspath:bean.xmlâ€);</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    //2ã€ä»IOCå®¹å™¨ä¸­è·å–beançš„å®ä¾‹
    TargetClass targetClass = (TargetClass) ctx.getBean("targetClass");

    //3ã€ä½¿ç”¨bean
    String result = targetClass.joint("spring","aop");
    System.out.println("result:" + result);
} } è¾“å‡ºç»“æœ
</code></pre></div></div>

<p>ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰â€¦
ç›®æ ‡æ–¹æ³•åä¸º:joint
ç›®æ ‡æ–¹æ³•æ‰€å±ç±»çš„ç®€å•ç±»å:TargetClass
ç›®æ ‡æ–¹æ³•æ‰€å±ç±»çš„ç±»å:aopdemo.TargetClass
ç›®æ ‡æ–¹æ³•å£°æ˜ç±»å‹:public
ç¬¬1ä¸ªå‚æ•°ä¸º:newSpring
ç¬¬2ä¸ªå‚æ•°ä¸º:newAop
è¢«ä»£ç†çš„å¯¹è±¡:aopdemo.TargetClass@4efc180e
ä»£ç†å¯¹è±¡è‡ªå·±:aopdemo.TargetClass@4efc180e
ç›®æ ‡æ–¹æ³•è¿”å›ç»“æœåâ€¦
ç›®æ ‡æ–¹æ³•æ‰§è¡Œåâ€¦
result:newSpring+newAop</p>
:ET